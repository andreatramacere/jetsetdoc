<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Temporal evolution, two zones, cooling+acc+adb exp &#8212; jetset  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/my_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Validation of the pp equilibrium against the Fokker-Plank equation solution" href="../hadronic_pp_jet/hadornic_validate_temp_ev.html" />
    <link rel="prev" title="Temporal evolution, two zones, cooling+acc" href="Temp_Ev_two_zones_acc_and_cooling.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js "></script>

  </head><body>
  
  <a href=" https://github.com/andreatramacere/jetset"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><span><img src="../../../_static/logo_small_color_neg_transparent.png"></span>
          JetSeT doc</a>
        <span class="navbar-text navbar-version pull-left"><b>1.2.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">JetSeT <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#windows-10-prerequisites">Windows 10 prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-jetset-from-anaconda">Install  JetSeT from Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-jetset-from-pip">Install  JetSeT from pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-the-jetset-from-source">Install the JetSeT from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#introduction-of-depending-pars">Introduction of depending pars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#temporal-evolution">Temporal Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#hadronic-pp-emission">Hadronic pp emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#theoretical-background-for-ssc-model">Theoretical background for SSC model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#emitters-distributions">Emitters distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#ebl-absorption">EBL absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#plugins">Plugins</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user_guide.html">user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../model_basic.html">model basic features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_advanced.html">model advanced features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_fitting.html">model fitting</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html">plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/analytical_model.html">analytical_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/base_model.html">base_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/convert_qdp.html">convert_qdp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/cosmo_tools.html">cosmo_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/data_loader.html">data_loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/frame_converter.html">frame_converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/gammapy_plugin.html">gammapy_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters.html">jet_emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters_factory.html">jet_emitters_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_model.html">jet_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_paramters.html">jet_paramters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_spectral_components.html">jet_spectral_components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_timedep.html">jet_timedep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_tools.html">jet_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jetkernel_models_dic.html">jetkernel_models_dic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/loglog_poly_model.html">loglog_poly_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mathkernel_helper.html">mathkernel_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mcmc.html">mcmc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/minimizer.html">minimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mock.html">mock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_manager.html">model_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_parameters.html">model_parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/obs_constrain.html">obs_constrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/output.html">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/plot_sedfit.html">plot_sedfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit.html">poly_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit_tools.html">poly_fit_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sed_shaper.html">sed_shaper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sherpa_plugin.html">sherpa_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/spectral_shapes.html">spectral_shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_2Dmodel.html">template_2Dmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_model.html">template_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/test_data_helper.html">test_data_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-linked-paramters-for-ebl">Example: linked paramters for EBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-pars-for-bkn-power-law-emitters">Example: depending pars for bkn power-law emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-building-a-jet-model-with-b-function-of-r-h-and-r-0">Example depending par: Building a Jet model with B function of R_H and R_0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-fitting-with-a-jet-model-with-depending-pars">Example depending par: fitting with a Jet model with depending pars</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#combine-a-jet-model-with-the-ebl-model-multiplicative-case">Combine a Jet model with the EBL model (Multiplicative case)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#setting-parameters">Setting parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#sum-of-two-jets-steady-and-flaring-and-application-of-the-ebl-absorption-to-both-multiplicative-and-additive">Sum of two jets (steady and flaring) and application of the EBL absorption to both (Multiplicative and additive)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#passing-the-custom-distribution-to-the-jet-class">Passing the custom distribution to the Jet class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#building-a-distribution-from-an-external-array">Building a distribution from an external array</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#basic-setup">Basic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-parameters">Setting the parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#investigating-the-electron-distribution">Investigating the electron distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#evaluate-and-plot-the-model">Evaluate and plot the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#comparing-models-on-the-same-plot">Comparing models on the same plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-a-plot">Saving a plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-and-loading-a-model">Saving and loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switching-on-off-the-particle-distribution-normalization">Switching on/off the particle distribution normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-particle-density-from-observed-fluxes-or-luminosities">Setting the particle density from observed Fluxes or Luminosities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-beaming-factor-and-expression">Setting the beaming factor and expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switch-on-off-synchrotron-sefl-absorption-and-ic-emission">Switch ON/OFF Synchrotron sefl-absorption and IC emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#accessing-individual-spectral-components">Accessing individual spectral components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#energetic-report">Energetic report</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Hadronic pp jet model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html#jet-pp-consistency-with-kelner-2006">Jet pp Consistency with Kelner 2006</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Temp_Ev_one_zone_only_cooling.html">Temporal evolution, one zone, only cooling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Temp_Ev_one_zone_only_cooling.html#cooling-only-the-newly-injecting-electrons">Cooling only the newly injecting electrons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Temp_Ev_two_zones_acc_and_cooling.html">Temporal evolution, two zones, cooling+acc</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Temporal evolution, two zones, cooling+acc+adb exp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expanding-the-radiative-region">Expanding the radiative region</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#synchrotron-trends-full-computation-and-delta-approx-comparison">Synchrotron trends: full computation and <span class="math notranslate nohighlight">\(\delta\)</span>-approx comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#trends-for-the-inverse-compton-and-synchrotron-emission">Trends for the inverse Compton and synchrotron emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the Sherpa plugin with the sherpa interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#model-fitting-with-using-a-sherpa-model">Model fitting with using a Sherpa model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the Sherpa minimizer plugin with a JeSeT model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#model-fitting-with-sherpa">Model fitting with Sherpa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html">Example to use the Gamma-py plugin with the JeSeT interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html#importing-a-jetset-model-into-gammapy">Importing a jetset model into gammapy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html#model-fitting-with-gammapy">Model fitting with gammapy</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Temporal evolution, two zones, cooling+acc+adb exp</a><ul>
<li><a class="reference internal" href="#expanding-the-radiative-region">Expanding the radiative region</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="Temp_Ev_two_zones_acc_and_cooling.html" title="Previous Chapter: Temporal evolution, two zones, cooling+acc"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Temporal evol...</span>
    </a>
  </li>
  <li>
    <a href="../hadronic_pp_jet/hadornic_validate_temp_ev.html" title="Next Chapter: Validation of the pp equilibrium against the Fokker-Plank equation solution"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Validation of... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../../_sources/user_guide/documentation_notebooks/temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><!--
<ul class="globaltoc"
><p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#windows-10-prerequisites">Windows 10 prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-jetset-from-anaconda">Install  JetSeT from Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-jetset-from-pip">Install  JetSeT from pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-the-jetset-from-source">Install the JetSeT from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#introduction-of-depending-pars">Introduction of depending pars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#temporal-evolution">Temporal Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#hadronic-pp-emission">Hadronic pp emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#theoretical-background-for-ssc-model">Theoretical background for SSC model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#emitters-distributions">Emitters distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#ebl-absorption">EBL absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#plugins">Plugins</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user_guide.html">user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../model_basic.html">model basic features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_advanced.html">model advanced features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_fitting.html">model fitting</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html">plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/analytical_model.html">analytical_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/base_model.html">base_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/convert_qdp.html">convert_qdp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/cosmo_tools.html">cosmo_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/data_loader.html">data_loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/frame_converter.html">frame_converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/gammapy_plugin.html">gammapy_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters.html">jet_emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters_factory.html">jet_emitters_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_model.html">jet_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_paramters.html">jet_paramters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_spectral_components.html">jet_spectral_components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_timedep.html">jet_timedep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_tools.html">jet_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jetkernel_models_dic.html">jetkernel_models_dic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/loglog_poly_model.html">loglog_poly_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mathkernel_helper.html">mathkernel_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mcmc.html">mcmc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/minimizer.html">minimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mock.html">mock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_manager.html">model_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_parameters.html">model_parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/obs_constrain.html">obs_constrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/output.html">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/plot_sedfit.html">plot_sedfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit.html">poly_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit_tools.html">poly_fit_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sed_shaper.html">sed_shaper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sherpa_plugin.html">sherpa_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/spectral_shapes.html">spectral_shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_2Dmodel.html">template_2Dmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_model.html">template_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/test_data_helper.html">test_data_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-linked-paramters-for-ebl">Example: linked paramters for EBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-pars-for-bkn-power-law-emitters">Example: depending pars for bkn power-law emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-building-a-jet-model-with-b-function-of-r-h-and-r-0">Example depending par: Building a Jet model with B function of R_H and R_0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-fitting-with-a-jet-model-with-depending-pars">Example depending par: fitting with a Jet model with depending pars</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#combine-a-jet-model-with-the-ebl-model-multiplicative-case">Combine a Jet model with the EBL model (Multiplicative case)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#setting-parameters">Setting parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#sum-of-two-jets-steady-and-flaring-and-application-of-the-ebl-absorption-to-both-multiplicative-and-additive">Sum of two jets (steady and flaring) and application of the EBL absorption to both (Multiplicative and additive)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#passing-the-custom-distribution-to-the-jet-class">Passing the custom distribution to the Jet class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#building-a-distribution-from-an-external-array">Building a distribution from an external array</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#basic-setup">Basic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-parameters">Setting the parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#investigating-the-electron-distribution">Investigating the electron distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#evaluate-and-plot-the-model">Evaluate and plot the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#comparing-models-on-the-same-plot">Comparing models on the same plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-a-plot">Saving a plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-and-loading-a-model">Saving and loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switching-on-off-the-particle-distribution-normalization">Switching on/off the particle distribution normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-particle-density-from-observed-fluxes-or-luminosities">Setting the particle density from observed Fluxes or Luminosities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-beaming-factor-and-expression">Setting the beaming factor and expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switch-on-off-synchrotron-sefl-absorption-and-ic-emission">Switch ON/OFF Synchrotron sefl-absorption and IC emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#accessing-individual-spectral-components">Accessing individual spectral components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#energetic-report">Energetic report</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Hadronic pp jet model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html#jet-pp-consistency-with-kelner-2006">Jet pp Consistency with Kelner 2006</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Temp_Ev_one_zone_only_cooling.html">Temporal evolution, one zone, only cooling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Temp_Ev_one_zone_only_cooling.html#cooling-only-the-newly-injecting-electrons">Cooling only the newly injecting electrons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Temp_Ev_two_zones_acc_and_cooling.html">Temporal evolution, two zones, cooling+acc</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Temporal evolution, two zones, cooling+acc+adb exp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expanding-the-radiative-region">Expanding the radiative region</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#synchrotron-trends-full-computation-and-delta-approx-comparison">Synchrotron trends: full computation and <span class="math notranslate nohighlight">\(\delta\)</span>-approx comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#trends-for-the-inverse-compton-and-synchrotron-emission">Trends for the inverse Compton and synchrotron emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the Sherpa plugin with the sherpa interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#model-fitting-with-using-a-sherpa-model">Model fitting with using a Sherpa model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the Sherpa minimizer plugin with a JeSeT model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#model-fitting-with-sherpa">Model fitting with Sherpa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html">Example to use the Gamma-py plugin with the JeSeT interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html#importing-a-jetset-model-into-gammapy">Importing a jetset model into gammapy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html#model-fitting-with-gammapy">Model fitting with gammapy</a></li>
</ul>
</li>
</ul>
</ul>
//-->


<html style="height:100%">
    <body style="height:100%">
      <div class="sidebar-block">
        <div class="sidebar-wrapper">
          <h2></h2>
        </div>
        <div class="sidebar-toc">

          
          
            <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide.html">user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Hadronic pp jet model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Temp_Ev_one_zone_only_cooling.html">Temporal evolution, one zone, only cooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Temp_Ev_two_zones_acc_and_cooling.html">Temporal evolution, two zones, cooling+acc</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Temporal evolution, two zones, cooling+acc+adb exp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expanding-the-radiative-region">Expanding the radiative region</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the Sherpa plugin with the sherpa interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the Sherpa minimizer plugin with a JeSeT model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html">Example to use the Gamma-py plugin with the JeSeT interface</a></li>
</ul>

          

        </div>

      </div>
    </body>
</html>
<div id="sourcelink">
  <a href="../../../_sources/user_guide/documentation_notebooks/temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.rst.txt"
     rel="nofollow">Source</a>
</div>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <section id="temporal-evolution-two-zones-cooling-acc-adb-exp">
<span id="temp-ev-two-zone-cooling-acc"></span><h1>Temporal evolution, two zones, cooling+acc+adb exp<a class="headerlink" href="#temporal-evolution-two-zones-cooling-acc-adb-exp" title="Permalink to this headline">¶</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jetset</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tested on jetset&#39;</span><span class="p">,</span><span class="n">jetset</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tested</span> <span class="n">on</span> <span class="n">jetset</span> <span class="mf">1.2.0</span>
</pre></div>
</div>
<p>In this tutorial I show how to perform a full acc+radiative+adiabatic expansion simulation. To have full understanding of the analysis presented in this tutorial, it is advised to read the paper Tramacere et al (2022) <a class="reference internal" href="../../../references.html#tramacere2022" id="id1"><span>[Tramacere2022]</span></a>.</p>
<p>We load the model of the flare simulated in
:ref:<code class="docutils literal notranslate"><span class="pre">temp_ev_two_zone_cooling_acc</span></code>. And the we evolve the radiative
region under the effect of radiative plus adiabatic cooling</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.jet_timedep</span> <span class="kn">import</span> <span class="n">JetTimeEvol</span>

<span class="n">temp_ev_acc</span><span class="o">=</span><span class="n">JetTimeEvol</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;two_zone_rad_acc.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="n">JetTimeEvol</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>

<span class="n">physical</span> <span class="n">setup</span><span class="p">:</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=29</i>
<table id="table140554507096464-201602" class="table-striped table-bordered table-condensed">
<thead><tr><th>name</th><th>par type</th><th>val</th><th>units</th><th>val*</th><th>units*</th><th>log</th></tr></thead>
<tr><td>delta t</td><td>time</td><td>5.000000e+01</td><td>s</td><td>0.00029979245799999996</td><td>R/c</td><td>False</td></tr>
<tr><td>log. sampling</td><td>time</td><td>0.000000e+00</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>R/c</td><td>time</td><td>1.667820e+05</td><td>s</td><td>1.0</td><td>R/c</td><td>False</td></tr>
<tr><td>IC cooling</td><td></td><td>off</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Sync cooling</td><td></td><td>on</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Adiab. cooling</td><td></td><td>on</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Reg. expansion</td><td></td><td>off</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Diff coeff</td><td></td><td>6.666667e-06</td><td>s-1</td><td>None</td><td></td><td>False</td></tr>
<tr><td>Acc coeff</td><td></td><td>4.000000e-05</td><td>s-1</td><td>None</td><td></td><td>False</td></tr>
<tr><td>Diff index</td><td></td><td>2.000000e+00</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Acc index</td><td></td><td>1.000000e+00</td><td>s-1</td><td>None</td><td></td><td>False</td></tr>
<tr><td>Tesc acc</td><td>time</td><td>5.003461e+04</td><td>s</td><td>3.0</td><td>R_acc/c</td><td>False</td></tr>
<tr><td>Eacc max</td><td>energy</td><td>4.000000e+60</td><td>erg</td><td>None</td><td></td><td>False</td></tr>
<tr><td>Tesc rad</td><td>time</td><td>1.667820e+65</td><td>s</td><td>1e+60</td><td>R/c</td><td>False</td></tr>
<tr><td>Delta R acc</td><td>accelerator_width</td><td>5.000000e+14</td><td>cm</td><td>None</td><td></td><td>False</td></tr>
<tr><td>B acc</td><td>magnetic field</td><td>2.000000e-01</td><td>cm</td><td>None</td><td></td><td>False</td></tr>
<tr><td>R_rad rad start</td><td>region_position</td><td>5.000000e+15</td><td>cm</td><td>None</td><td></td><td>False</td></tr>
<tr><td>R_H rad start</td><td>region_position</td><td>1.000000e+17</td><td>cm</td><td>None</td><td></td><td>False</td></tr>
<tr><td>T_A0=1/ACC_COEFF</td><td>time</td><td>2.500000e+04</td><td>s</td><td>0.149896229</td><td>R/c</td><td>False</td></tr>
<tr><td>T_D0=1/DIFF_COEFF</td><td>time</td><td>1.500000e+05</td><td>s</td><td>0.899377374</td><td>R/c</td><td>False</td></tr>
<tr><td>T_DA0=1/(2*DIFF_COEFF)</td><td>time</td><td>7.500000e+04</td><td>s</td><td>0.449688687</td><td>R/c</td><td>False</td></tr>
<tr><td>gamma Lambda Turb.  max</td><td></td><td>1.173358e+11</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>gamma Lambda Coher. max</td><td></td><td>1.173358e+10</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>gamma eq Syst. Acc (synch. cool)</td><td></td><td>7.832383e+05</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>gamma eq Diff. Acc (synch. cool)</td><td></td><td>1.309535e+05</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>T cooling(gamma_eq=gamma_eq_Diff)</td><td></td><td>1.477242e+05</td><td>s</td><td>None</td><td></td><td>False</td></tr>
<tr><td>T cooling(gamma_eq=gamma_eq_Sys)</td><td></td><td>2.469874e+04</td><td>s</td><td>None</td><td></td><td>False</td></tr>
<tr><td>T min. synch. cooling</td><td></td><td>1.934500e+02</td><td>s</td><td>None</td><td></td><td>False</td></tr>
<tr><td>L inj (electrons)</td><td>injected lum.</td><td>5.000000e+39</td><td>erg/s</td><td>None</td><td></td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140554507096464-201602').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140554507096464-201602').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="n">parameters</span><span class="p">:</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=30</i>
<table id="table140554507054864-710953" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_time_ev</td><td>duration</td><td>time_grid</td><td>s</td><td>1.000000e+06</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>gmin_grid</td><td>gamma_grid</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>gmax_grid</td><td>gamma_grid</td><td></td><td>1.000000e+08</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>gamma_grid_size</td><td>gamma_grid</td><td></td><td>1.500000e+03</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>TStart_Acc</td><td>time_grid</td><td>s</td><td>0.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>TStop_Acc</td><td>time_grid</td><td>s</td><td>1.000000e+05</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>TStart_Inj</td><td>time_grid</td><td>s</td><td>0.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>TStop_Inj</td><td>time_grid</td><td>s</td><td>1.000000e+05</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>T_esc_acc</td><td>escape_time</td><td>(R_acc/c)*</td><td>3.000000e+00</td><td>--</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>Esc_Index_acc</td><td>fp_coeff_index</td><td></td><td>0.000000e+00</td><td>--</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>t_D0</td><td>acceleration_time</td><td>s</td><td>1.500000e+05</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>t_A0</td><td>acceleration_time</td><td>s</td><td>2.500000e+04</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>Diff_Index</td><td>fp_coeff_index</td><td>s</td><td>2.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>Acc_Index</td><td>fp_coeff_index</td><td></td><td>1.000000e+00</td><td>--</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>Delta_R_acc</td><td>accelerator_width</td><td>cm</td><td>5.000000e+14</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>B_acc</td><td>magnetic_field</td><td>G</td><td>2.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>E_acc_max</td><td>acc_energy</td><td>erg</td><td>4.000000e+60</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>Lambda_max_Turb</td><td>turbulence_scale</td><td>cm</td><td>1.000000e+15</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>Lambda_choer_Turb_factor</td><td>turbulence_scale</td><td>cm</td><td>1.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>T_esc_rad</td><td>escape_time</td><td>(R/c)*</td><td>1.000000e+60</td><td>--</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>Esc_Index_rad</td><td>fp_coeff_index</td><td></td><td>0.000000e+00</td><td>--</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>R_rad_start</td><td>region_size</td><td>cm</td><td>5.000000e+15</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>R_H_rad_start</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>m_B</td><td>magnetic_field_index</td><td></td><td>1.000000e+00</td><td>1.000000e+00</td><td>2.000000e+00</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>t_jet_exp</td><td>exp_start_time</td><td>s</td><td>1.000000e+05</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>beta_exp_R</td><td>beta_expansion</td><td>v/c*</td><td>1.000000e+00</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>B_rad</td><td>magnetic_field</td><td>G</td><td>2.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>t_size</td><td>time_grid</td><td></td><td>2.000000e+04</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>num_samples</td><td>time_ev_output</td><td></td><td>5.000000e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>L_inj</td><td>inj_luminosity</td><td>erg / s</td><td>5.000000e+39</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140554507054864-710953').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140554507054864-710953').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><p>here we set some relevant parameters that will be described in detail in
the next version of the documentation</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">plot_time_profile</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">jetset</span><span class="o">.</span><span class="n">plot_sedfit</span><span class="o">.</span><span class="n">PlotTempEvDiagram</span> <span class="n">at</span> <span class="mh">0x7fd565768df0</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_10_1.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_10_1.png" />
<p>Particle spectrum in the radiative region</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">plot_tempev_emitters</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;rad&#39;</span><span class="p">,</span><span class="n">loglog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">energy_unit</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">pow</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">temp_ev</span><span class="o">.</span><span class="n">gamma_eq_t_A</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">temp_ev</span><span class="o">.</span><span class="n">gamma_eq_t_DA</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">x_max</span><span class="o">=</span><span class="mf">1E7</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-18</span><span class="p">,</span><span class="n">y_max</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_12_0.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_12_0.png" />
<p>SEDs in the radiation region</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">plot_tempev_model</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;rad&#39;</span><span class="p">,</span><span class="n">sed_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_cached</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-18</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E7</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_14_0.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_14_0.png" />
<p>We generate a lightcurve in the range nu1=2.4E22 Hz, nu2=7.2E25 Hz,
without the effect of the light crossing time, in the observer frame</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lg</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">2.4E22</span><span class="p">,</span><span class="n">nu2</span><span class="o">=</span><span class="mf">7.2E25</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">lg</span>[&#39;time&#39;].unit)
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;flux (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">lg</span>[&#39;flux&#39;].unit)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;flux (erg / (cm2 s))&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_17_1.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_17_1.png" />
<p>We generate a lightcurve in the range nu1=2.4E22 Hz, nu2=7.2E25 Hz, with
the effect of the light crossing time, in the observer frame</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lg_cross</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">2.4E22</span><span class="p">,</span><span class="n">nu2</span><span class="o">=</span><span class="mf">7.2E25</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span><span class="n">cross_time_slices</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lg_cross</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lg_cross</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">lg</span>[&#39;time&#39;].unit)
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;flux (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">lg</span>[&#39;flux&#39;].unit)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;flux (erg / (cm2 s))&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_20_1.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_20_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr_1</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">1E10</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;1E10 Hz&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
<span class="n">lr_2</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">5E9</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;1E9 Hz&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lr_1</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lr_1</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lr_1</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lr_2</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lr_2</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lr_2</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">lr_1</span>[&#39;time&#39;].unit)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_22_1.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_22_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr_1_cross</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">1E10</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span><span class="n">cross_time_slices</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">lr_2_cross</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">5E9</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span><span class="n">cross_time_slices</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lr_1_cross</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lr_1_cross</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lr_1_cross</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lr_2_cross</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lr_2_cross</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lr_2_cross</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">lr_1_cross</span>[&#39;time&#39;].unit)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_24_1.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_24_1.png" />
<section id="expanding-the-radiative-region">
<h2>Expanding the radiative region<a class="headerlink" href="#expanding-the-radiative-region" title="Permalink to this headline">¶</a></h2>
<p>We now plug the radiative region from <code class="docutils literal notranslate"><span class="pre">temp_ev_acc</span></code> to new model with
adiabatic expansion</p>
<p>the following two functions define an estimate of the total extent of
the simulation to follow the expansion</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delta_t_est</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span><span class="n">R0</span><span class="p">,</span><span class="n">beta_exp</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t_exp</span><span class="o">+</span><span class="n">R0</span><span class="o">/</span><span class="p">(</span><span class="n">beta_exp</span><span class="o">*</span><span class="mf">3E10</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">t_dec_est</span><span class="p">(</span><span class="n">R0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">beta_exp</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">R0</span><span class="o">+</span><span class="n">beta_exp</span><span class="o">*</span><span class="mf">3E10</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">beta_exp</span><span class="o">*</span><span class="mf">3E10</span><span class="p">,</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
<p>we set the initial radius equal to the radius of the radiative region of
the <code class="docutils literal notranslate"><span class="pre">temp_ev_acc</span></code> model</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_exp</span><span class="o">=</span><span class="mf">1E7</span>
<span class="n">beta_exp</span><span class="o">=</span><span class="mf">0.3</span>
<span class="n">R0</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">val</span>
<span class="n">duration</span><span class="o">=</span><span class="n">delta_t_est</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span><span class="n">R0</span><span class="p">,</span><span class="n">beta_exp</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">t_dec_est</span><span class="p">(</span><span class="n">R0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">beta_exp</span><span class="p">)</span>
</pre></div>
</div>
<p>we build the <code class="docutils literal notranslate"><span class="pre">temp_ev_expansion</span></code> expansion model</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.jet_timedep</span> <span class="kn">import</span> <span class="n">JetTimeEvol</span>
<span class="n">temp_ev_expansion</span><span class="o">=</span><span class="n">JetTimeEvol</span><span class="p">(</span><span class="n">jet_rad</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">only_radiation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Q_inj</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">nu_min</span><span class="o">=</span><span class="mf">1E8</span>
<span class="n">T_SIZE</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">NUM_SET</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">T_SIZE</span><span class="p">)</span>
<span class="n">NUM_SET</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span><span class="n">NUM_SET</span><span class="p">)</span>


<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">TStart_Inj</span><span class="o">.</span><span class="n">val</span><span class="o">=-</span><span class="mi">0</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">TStop_Inj</span><span class="o">.</span><span class="n">val</span><span class="o">=-</span><span class="mi">0</span>

<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">duration</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">T_esc_rad</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="mf">1E60</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Esc_Index_rad</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="mi">0</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">t_size</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">T_SIZE</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">num_samples</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">NUM_SET</span>


<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmin_grid</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="mf">1.0</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmax_grid</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="mf">1E8</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gamma_grid_size</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="mi">1500</span>
</pre></div>
</div>
<p>we set to <code class="docutils literal notranslate"><span class="pre">'on'</span></code> the region expansion, and we set the relevant
paramters</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">region_expansion</span><span class="o">=</span><span class="s1">&#39;on&#39;</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">t_jet_exp</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">t_exp</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">beta_exp_R</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">beta_exp</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R_rad_start</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">R0</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">init_TempEv</span><span class="p">()</span>
<span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="n">JetTimeEvol</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>

<span class="n">physical</span> <span class="n">setup</span><span class="p">:</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=12</i>
<table id="table140554180947776-821342" class="table-striped table-bordered table-condensed">
<thead><tr><th>name</th><th>par type</th><th>val</th><th>units</th><th>val*</th><th>units*</th><th>log</th></tr></thead>
<tr><td>delta t</td><td>time</td><td>1.000008e+03</td><td>s</td><td>0.005995894232556255</td><td>R/c</td><td>False</td></tr>
<tr><td>log. sampling</td><td>time</td><td>0.000000e+00</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>R/c</td><td>time</td><td>1.667820e+05</td><td>s</td><td>1.0</td><td>R/c</td><td>False</td></tr>
<tr><td>IC cooling</td><td></td><td>off</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Sync cooling</td><td></td><td>on</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Adiab. cooling</td><td></td><td>on</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Reg. expansion</td><td></td><td>on</td><td></td><td>None</td><td></td><td>False</td></tr>
<tr><td>Tesc rad</td><td>time</td><td>1.667820e+65</td><td>s</td><td>1e+60</td><td>R/c</td><td>False</td></tr>
<tr><td>R_rad rad start</td><td>region_position</td><td>5.000000e+15</td><td>cm</td><td>None</td><td></td><td>False</td></tr>
<tr><td>R_H rad start</td><td>region_position</td><td>1.000000e+17</td><td>cm</td><td>None</td><td></td><td>False</td></tr>
<tr><td>beta exp.</td><td>region_position</td><td>3.000000e-01</td><td>v/c</td><td>8993773740.0 cm / s</td><td>cm/s</td><td>False</td></tr>
<tr><td>T min. synch. cooling</td><td></td><td>1.934500e+02</td><td>s</td><td>None</td><td></td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140554180947776-821342').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140554180947776-821342').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="n">parameters</span><span class="p">:</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=17</i>
<table id="table140554373347360-555877" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_time_ev</td><td>duration</td><td>time_grid</td><td>s</td><td>1.611112e+07</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>gmin_grid</td><td>gamma_grid</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>gmax_grid</td><td>gamma_grid</td><td></td><td>1.000000e+08</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>gamma_grid_size</td><td>gamma_grid</td><td></td><td>1.500000e+03</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>TStart_Inj</td><td>time_grid</td><td>s</td><td>0.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>TStop_Inj</td><td>time_grid</td><td>s</td><td>0.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>T_esc_rad</td><td>escape_time</td><td>(R/c)*</td><td>1.000000e+60</td><td>--</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>Esc_Index_rad</td><td>fp_coeff_index</td><td></td><td>0.000000e+00</td><td>--</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>R_rad_start</td><td>region_size</td><td>cm</td><td>5.000000e+15</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>R_H_rad_start</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>m_B</td><td>magnetic_field_index</td><td></td><td>1.000000e+00</td><td>1.000000e+00</td><td>2.000000e+00</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>t_jet_exp</td><td>exp_start_time</td><td>s</td><td>1.000000e+07</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>beta_exp_R</td><td>beta_expansion</td><td>v/c*</td><td>3.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>B_rad</td><td>magnetic_field</td><td>G</td><td>2.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>t_size</td><td>time_grid</td><td></td><td>1.611100e+04</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>num_samples</td><td>time_ev_output</td><td></td><td>5.000000e+03</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_time_ev</td><td>L_inj</td><td>inj_luminosity</td><td>erg / s</td><td>1.000000e+39</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140554373347360-555877').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140554373347360-555877').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">plot_time_profile</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">jetset</span><span class="o">.</span><span class="n">plot_sedfit</span><span class="o">.</span><span class="n">PlotTempEvDiagram</span> <span class="n">at</span> <span class="mh">0x7fd5528b1220</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_36_1.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_36_1.png" />
<p><strong>we set ``do_injection=False`` because we want only to evolve the
particle already injected and evolved in the radiative region of the
``temp_ev_acc`` model</strong></p>
<p>setting <code class="docutils literal notranslate"><span class="pre">cache_SEDs_rad=True</span></code> will generate and cache all the SED at
any time of the <code class="docutils literal notranslate"><span class="pre">NUM_SET</span></code>. <strong>This will increase the computational time
during the run. Anyhow, will speed up the computation of SEDs and light
curves. Moreover, these SEDs will be saved in the model, and read if you
will reload the model in the future</strong>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cache_SEDs_rad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">do_injection</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">temporal</span> <span class="n">evolution</span> <span class="n">running</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0%|          | 0/16111 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">temporal</span> <span class="n">evolution</span> <span class="n">completed</span>
<span class="n">caching</span> <span class="n">SED</span> <span class="k">for</span> <span class="n">each</span> <span class="n">saved</span> <span class="n">distribution</span><span class="p">:</span> <span class="n">start</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0%|          | 0/5000 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">caching</span> <span class="n">SED</span> <span class="k">for</span> <span class="n">each</span> <span class="n">saved</span> <span class="n">distribution</span><span class="p">:</span> <span class="n">done</span>
</pre></div>
</div>
<p>we now evaluate light curves, and plot the combination of the flare and
adiabatic expansion simulations, for both the radio and gamma</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr_1_exp</span><span class="o">=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">1E10</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;1E10 Hz&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
<span class="n">lr_2_exp</span><span class="o">=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">5E9</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;1E9 Hz&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
<span class="n">lr_1_exp</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">lr_1</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">lr_2_exp</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">lr_2</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lg_exp</span><span class="o">=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">2.4E22</span><span class="p">,</span><span class="n">nu2</span><span class="o">=</span><span class="mf">7.2E25</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
<span class="n">lg</span><span class="o">=</span><span class="n">temp_ev_acc</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">make_lc</span><span class="p">(</span><span class="n">nu1</span><span class="o">=</span><span class="mf">2.4E22</span><span class="p">,</span><span class="n">nu2</span><span class="o">=</span><span class="mf">7.2E25</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="n">eval_cross_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">delta_t_out</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
<span class="n">lg_exp</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">+=</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lr_1</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lr_1</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lr_1_exp</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lr_2</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lr_2</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lr_2_exp</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lr_1_exp</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lr_1_exp</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lr_1_exp</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;10 GHz&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lr_2_exp</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lr_2_exp</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lr_2_exp</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;1 GHz&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lg_exp</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span><span class="n">lg_exp</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">lg</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">lr_1</span>[&#39;time&#39;].unit)
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7fd52a6a4c40</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_43_1.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_43_1.png" />
<p>we notice the two peaks in the radio lightcurves, due to transition of the SSA frequency generated by the expansion (see <a class="reference internal" href="../../../references.html#tramacere2022" id="id2"><span>[Tramacere2022]</span></a> for more details)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">plot_tempev_model</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;rad&#39;</span><span class="p">,</span><span class="n">sed_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_cached</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">time_slice_bin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-18</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E7</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_45_0.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_45_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="kn">import</span> <span class="n">PlotSED</span>

<span class="n">p</span><span class="o">=</span><span class="n">PlotSED</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">resplot</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">skip_label</span><span class="o">=</span><span class="kc">False</span>

<span class="n">step</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">num_samples</span><span class="o">.</span><span class="n">val</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NUM_SET</span><span class="p">,</span><span class="n">step</span><span class="p">):</span>
    <span class="n">t</span><span class="o">=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">time_sampled_emitters</span><span class="o">.</span><span class="n">_get_time_samples</span><span class="p">(</span><span class="n">time_slice</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">s</span><span class="o">=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">get_SED</span><span class="p">(</span><span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">time_slice</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">s_sync</span><span class="o">=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">get_SED</span><span class="p">(</span><span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Sync&#39;</span><span class="p">,</span><span class="n">time_slice</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">s_IC</span><span class="o">=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">rad_region</span><span class="o">.</span><span class="n">get_SED</span><span class="p">(</span><span class="n">comp</span><span class="o">=</span><span class="s1">&#39;SSC&#39;</span><span class="p">,</span><span class="n">time_slice</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span><span class="n">use_cached</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">t_jet_exp</span><span class="o">.</span><span class="n">val</span><span class="p">:</span>
        <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span>
    <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pre expansion&#39;</span>
    <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">temp_ev_expansion</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">t_jet_exp</span><span class="o">.</span><span class="n">val</span> <span class="ow">and</span> <span class="n">skip_label</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;expansion&#39;</span>
        <span class="n">skip_label</span><span class="o">=</span><span class="kc">True</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">s</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">auto_label</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-18</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E7</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_46_0.png" src="../../../_images/Temp_Ev_two_zones_acc_and_cooling_adb_exp_46_0.png" />
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, andrea tramacere.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>