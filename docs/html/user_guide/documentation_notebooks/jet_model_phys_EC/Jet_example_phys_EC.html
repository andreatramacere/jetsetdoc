<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>External Compton &#8212; jetset  documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/my_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Numerical setup" href="../jet_model_num/Jet_example_num.html" />
    <link rel="prev" title="Physical setup" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js "></script>

  </head><body>
  
  <a href=" https://github.com/andreatramacere/jetset"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><span><img src="../../../_static/logo_small_color_neg_transparent.png"></span>
          JetSeT doc</a>
        <span class="navbar-text navbar-version pull-left"><b>1.2.0rc8</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">JetSeT <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install_pre.html">installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../install_pre.html#windows-10-prerequisites">Windows 10 prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install_pre.html#install-jetset-from-anaconda">Install  JetSeT from Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install_pre.html#install-jetset-from-pip">Install  JetSeT from pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install_pre.html#install-the-jetset-from-source">Install the JetSeT from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#introduction-of-depending-pars">Introduction of depending pars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#temporal-evolution">Temporal Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#hadronic-pp-emission">Hadronic pp emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#theoretical-background-for-ssc-model">Theoretical background for SSC model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#emitters-distributions">Emitters distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#ebl-absorption">EBL absorption</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user_guide.html">user guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../model_basic.html">model basic features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_advanced.html">model advanced features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_fitting.html">model fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/analytical_model.html">analytical_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/base_model.html">base_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/convert_qdp.html">convert_qdp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/cosmo_tools.html">cosmo_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/data_loader.html">data_loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/frame_converter.html">frame_converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters.html">jet_emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters_factory.html">jet_emitters_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_model.html">jet_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_paramters.html">jet_paramters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_spectral_components.html">jet_spectral_components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_timedep.html">jet_timedep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_tools.html">jet_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jetkernel_models_dic.html">jetkernel_models_dic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/loglog_poly_model.html">loglog_poly_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mathkernel_helper.html">mathkernel_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mcmc.html">mcmc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/minimizer.html">minimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mock.html">mock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_manager.html">model_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_parameters.html">model_parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/obs_constrain.html">obs_constrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/output.html">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/plot_sedfit.html">plot_sedfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit.html">poly_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit_tools.html">poly_fit_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sed_shaper.html">sed_shaper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sherpa_plugin.html">sherpa_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/spectral_shapes.html">spectral_shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_2Dmodel.html">template_2Dmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_model.html">template_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/test_data_helper.html">test_data_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/utils.html">utils</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-linked-paramters-for-ebl">Example: linked paramters for EBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-pars-for-bkn-power-law-emitters">Example: depending pars for bkn power-law emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-building-a-jet-model-with-b-function-of-r-h-and-r-0">Example depending par: Building a Jet model with B function of R_H and R_0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-fitting-with-a-jet-model-with-depending-pars">Example depending par: fitting with a Jet model with depending pars</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#combine-a-jet-model-with-the-ebl-model-multiplicative-case">Combine a Jet model with the EBL model (Multiplicative case)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#setting-parameters">Setting parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#sum-of-two-jets-steady-and-flaring-and-application-of-the-ebl-absorption-to-both-multiplicative-and-additive">Sum of two jets (steady and flaring) and application of the EBL absorption to both (Multiplicative and additive)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#passing-the-custom-distribution-to-the-jet-class">Passing the custom distribution to the Jet class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#building-a-distribution-from-an-external-array">Building a distribution from an external array</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#basic-setup">Basic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-parameters">Setting the parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#investigating-the-electron-distribution">Investigating the electron distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#evaluate-and-plot-the-model">Evaluate and plot the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#comparing-models-on-the-same-plot">Comparing models on the same plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-a-plot">Saving a plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-and-loading-a-model">Saving and loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switching-on-off-the-particle-distribution-normalization">Switching on/off the particle distribution normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-particle-density-from-observed-fluxes-or-luminosities">Setting the particle density from observed Fluxes or Luminosities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-beaming-factor-and-expression">Setting the beaming factor and expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switch-on-off-synchrotron-sefl-absorption-and-ic-emission">Switch ON/OFF Synchrotron sefl-absorption and IC emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#accessing-individual-spectral-components">Accessing individual spectral components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#energetic-report">Energetic report</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Jet pp Consistency with Kelner 2006</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html">Temporal evolution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html#setting-the-injection-distribution">setting the injection distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html#running-cooling-and-acc-using-only-injection">running cooling and acc using only injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html#running-cooling-and-acc-on-injetcion-plus-input-jet">running cooling and acc on injetcion plus input jet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html#running-only-cooling-input-jet">running only cooling input jet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#synchrotron-trends-full-computation-and-delta-approx-comparison">Synchrotron trends: full computation and <span class="math notranslate nohighlight">\(\delta\)</span>-approx comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#trends-for-the-inverse-compton-and-synchrotron-emission">Trends for the inverse Compton and synchrotron emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the sherpa plugin with the sherpa interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#model-fitting-with-sherpa">Model fitting with Sherpa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the sherpa plugin with the JeSeT interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#model-fitting-with-sherpa">Model fitting with Sherpa</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">External Compton</a><ul>
<li><a class="reference internal" href="#broad-line-region">Broad Line Region</a></li>
<li><a class="reference internal" href="#change-disk-type">change Disk type</a></li>
<li><a class="reference internal" href="#dusty-torus">Dusty Torus</a></li>
<li><a class="reference internal" href="#changing-the-external-field-transformation">Changing the external field transformation</a></li>
<li><a class="reference internal" href="#external-photon-field-energy-density-along-the-jet">External photon field energy density along the jet</a></li>
<li><a class="reference internal" href="#ic-against-the-cmb">IC against the CMB</a></li>
</ul>
</li>
<li><a class="reference internal" href="#equipartition">Equipartition</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../jet_model_phys_SSC/Jet_example_phys_SSC.html" title="Previous Chapter: Physical setup"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Physical setup</span>
    </a>
  </li>
  <li>
    <a href="../jet_model_num/Jet_example_num.html" title="Next Chapter: Numerical setup"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Numerical setup &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../../_sources/user_guide/documentation_notebooks/jet_model_phys_EC/Jet_example_phys_EC.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><!--
<ul class="globaltoc"
><p class="caption"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install_pre.html">installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../install_pre.html#windows-10-prerequisites">Windows 10 prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install_pre.html#install-jetset-from-anaconda">Install  JetSeT from Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install_pre.html#install-jetset-from-pip">Install  JetSeT from pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install_pre.html#install-the-jetset-from-source">Install the JetSeT from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#introduction-of-depending-pars">Introduction of depending pars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#temporal-evolution">Temporal Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#hadronic-pp-emission">Hadronic pp emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#theoretical-background-for-ssc-model">Theoretical background for SSC model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#emitters-distributions">Emitters distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#ebl-absorption">EBL absorption</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user_guide.html">user guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../model_basic.html">model basic features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_advanced.html">model advanced features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_fitting.html">model fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/analytical_model.html">analytical_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/base_model.html">base_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/convert_qdp.html">convert_qdp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/cosmo_tools.html">cosmo_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/data_loader.html">data_loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/frame_converter.html">frame_converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters.html">jet_emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters_factory.html">jet_emitters_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_model.html">jet_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_paramters.html">jet_paramters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_spectral_components.html">jet_spectral_components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_timedep.html">jet_timedep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_tools.html">jet_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jetkernel_models_dic.html">jetkernel_models_dic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/loglog_poly_model.html">loglog_poly_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mathkernel_helper.html">mathkernel_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mcmc.html">mcmc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/minimizer.html">minimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mock.html">mock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_manager.html">model_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_parameters.html">model_parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/obs_constrain.html">obs_constrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/output.html">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/plot_sedfit.html">plot_sedfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit.html">poly_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit_tools.html">poly_fit_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sed_shaper.html">sed_shaper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sherpa_plugin.html">sherpa_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/spectral_shapes.html">spectral_shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_2Dmodel.html">template_2Dmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_model.html">template_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/test_data_helper.html">test_data_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/utils.html">utils</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-linked-paramters-for-ebl">Example: linked paramters for EBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-pars-for-bkn-power-law-emitters">Example: depending pars for bkn power-law emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-building-a-jet-model-with-b-function-of-r-h-and-r-0">Example depending par: Building a Jet model with B function of R_H and R_0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-fitting-with-a-jet-model-with-depending-pars">Example depending par: fitting with a Jet model with depending pars</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#combine-a-jet-model-with-the-ebl-model-multiplicative-case">Combine a Jet model with the EBL model (Multiplicative case)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#setting-parameters">Setting parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#sum-of-two-jets-steady-and-flaring-and-application-of-the-ebl-absorption-to-both-multiplicative-and-additive">Sum of two jets (steady and flaring) and application of the EBL absorption to both (Multiplicative and additive)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#passing-the-custom-distribution-to-the-jet-class">Passing the custom distribution to the Jet class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#building-a-distribution-from-an-external-array">Building a distribution from an external array</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#basic-setup">Basic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-parameters">Setting the parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#investigating-the-electron-distribution">Investigating the electron distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#evaluate-and-plot-the-model">Evaluate and plot the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#comparing-models-on-the-same-plot">Comparing models on the same plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-a-plot">Saving a plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-and-loading-a-model">Saving and loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switching-on-off-the-particle-distribution-normalization">Switching on/off the particle distribution normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-particle-density-from-observed-fluxes-or-luminosities">Setting the particle density from observed Fluxes or Luminosities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-beaming-factor-and-expression">Setting the beaming factor and expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switch-on-off-synchrotron-sefl-absorption-and-ic-emission">Switch ON/OFF Synchrotron sefl-absorption and IC emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#accessing-individual-spectral-components">Accessing individual spectral components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#energetic-report">Energetic report</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Jet pp Consistency with Kelner 2006</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html">Temporal evolution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html#setting-the-injection-distribution">setting the injection distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html#running-cooling-and-acc-using-only-injection">running cooling and acc using only injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html#running-cooling-and-acc-on-injetcion-plus-input-jet">running cooling and acc on injetcion plus input jet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html#running-only-cooling-input-jet">running only cooling input jet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#synchrotron-trends-full-computation-and-delta-approx-comparison">Synchrotron trends: full computation and <span class="math notranslate nohighlight">\(\delta\)</span>-approx comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#trends-for-the-inverse-compton-and-synchrotron-emission">Trends for the inverse Compton and synchrotron emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the sherpa plugin with the sherpa interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#model-fitting-with-sherpa">Model fitting with Sherpa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the sherpa plugin with the JeSeT interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#model-fitting-with-sherpa">Model fitting with Sherpa</a></li>
</ul>
</li>
</ul>
</ul>
//-->


<html style="height:100%">
    <body style="height:100%">
      <div class="sidebar-block">
        <div class="sidebar-wrapper">
          <h2></h2>
        </div>
        <div class="sidebar-toc">

          
          
            <p class="caption"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install_pre.html">installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user_guide.html">user guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../model_basic.html">model basic features</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html"> jet model physical setup  *New (v1.2.0)* (basic features and SSC)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">External Compton</a></li>
<li class="toctree-l3"><a class="reference internal" href="#equipartition">Equipartition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../jet_model_num/Jet_example_num.html"> jet model numerical setup   *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html"> jet hadronic pp model *New (v1.2.0)*</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../model_advanced.html">model advanced features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_fitting.html">model fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a></li>
</ul>
<p class="caption"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Jet pp Consistency with Kelner 2006</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev.html">Temporal evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the sherpa plugin with the sherpa interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the sherpa plugin with the JeSeT interface</a></li>
</ul>

          

        </div>

      </div>
    </body>
</html>
<div id="sourcelink">
  <a href="../../../_sources/user_guide/documentation_notebooks/jet_model_phys_EC/Jet_example_phys_EC.rst.txt"
     rel="nofollow">Source</a>
</div>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="external-compton">
<span id="jet-physical-guide-ec"></span><h1>External Compton<a class="headerlink" href="#external-compton" title="Permalink to this headline">¶</a></h1>
<p>The external Compton implementation  gives you the possibility to use a double approach</p>
<ul class="simple">
<li><p>transformation of the external  fields to the blob rest frame Dermer and Schlickeiser (2002) <a class="reference internal" href="../../../references.html#dermer2002" id="id1"><span>[Dermer2002]</span></a></p></li>
<li><p>transformation of the electron emitting distribution from the blob restframe to
disk/BH restframe Dermer(1995)[Dermer95]_ and Georganopoulos, Kirk, and Mastichiadis (2001) <a class="reference internal" href="../../../references.html#gkm01" id="id2"><span>[GKM01]</span></a></p></li>
</ul>
<p>The implemented external radiative fields are</p>
<ul class="simple">
<li><p>Broad Line Region radiative field using the approach of Donea &amp; Protheroe (2003)[Donea2003]_</p></li>
<li><p>Dusty torus implemented as a uniform BB field within <cite>R_DT</cite></p></li>
<li><p>accretion disk (mono-energetic, single-temperature BB or a multi-temperature BB)</p></li>
<li><p>Cosmic Microwave Background (CMB)</p></li>
</ul>
<p>Please read <span class="xref std std-ref">jet_physical_guide_SSC</span> if you skipped it.</p>
<div class="figure align-default" id="id3">
<img alt="EC scheme" src="../../../_images/jetset_EC_scheme.png" />
<p class="caption"><span class="caption-text">EC scheme</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="broad-line-region">
<h2>Broad Line Region<a class="headerlink" href="#broad-line-region" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jetset</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tested on jetset&#39;</span><span class="p">,</span><span class="n">jetset</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tested</span> <span class="n">on</span> <span class="n">jetset</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">0</span><span class="n">rc4</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.jet_model</span> <span class="kn">import</span> <span class="n">Jet</span>
<span class="n">my_jet</span><span class="o">=</span><span class="n">Jet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;EC_example&#39;</span><span class="p">,</span><span class="n">electron_distribution</span><span class="o">=</span><span class="s1">&#39;bkn&#39;</span><span class="p">,</span><span class="n">beaming_expr</span><span class="o">=</span><span class="s1">&#39;bulk_theta&#39;</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">add_EC_component</span><span class="p">([</span><span class="s1">&#39;EC_BLR&#39;</span><span class="p">,</span><span class="s1">&#39;EC_Disk&#39;</span><span class="p">],</span><span class="n">disk_type</span><span class="o">=</span><span class="s1">&#39;BB&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">show_model</span></code> method provides, among other information, information
concerning the accretion disk, in this case we use a mono temperature
black body <code class="docutils literal notranslate"><span class="pre">BB</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="n">jet</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">EC_example</span>

<span class="n">electrons</span> <span class="n">distribution</span><span class="p">:</span>
 <span class="nb">type</span><span class="p">:</span> <span class="n">bkn</span>
 <span class="n">gamma</span> <span class="n">energy</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">201</span>
 <span class="n">gmin</span> <span class="n">grid</span> <span class="p">:</span> <span class="mf">2.000000e+00</span>
 <span class="n">gmax</span> <span class="n">grid</span> <span class="p">:</span> <span class="mf">1.000000e+06</span>
 <span class="n">normalization</span>  <span class="kc">True</span>
 <span class="n">log</span><span class="o">-</span><span class="n">values</span>  <span class="kc">False</span>

<span class="n">accretion</span> <span class="n">disk</span><span class="p">:</span>
 <span class="n">disk</span> <span class="n">Type</span><span class="p">:</span> <span class="n">BB</span>
 <span class="n">L</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">1.000000e+45</span> <span class="p">(</span><span class="n">erg</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
 <span class="n">T</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">1.000000e+05</span> <span class="p">(</span><span class="n">K</span><span class="p">)</span>
 <span class="n">nu</span> <span class="n">peak</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">8.171810e+15</span> <span class="p">(</span><span class="n">Hz</span><span class="p">)</span>

<span class="n">radiative</span> <span class="n">fields</span><span class="p">:</span>
 <span class="n">seed</span> <span class="n">photons</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">100</span>
 <span class="n">IC</span> <span class="n">emission</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">100</span>
 <span class="n">source</span> <span class="n">emissivity</span> <span class="n">lower</span> <span class="n">bound</span> <span class="p">:</span>  <span class="mf">1.000000e-120</span>
 <span class="n">spectral</span> <span class="n">components</span><span class="p">:</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sum</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sync</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="nb">abs</span>
   <span class="n">name</span><span class="p">:</span><span class="n">SSC</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">EC_BLR</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Disk</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">EC_Disk</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
<span class="n">external</span> <span class="n">fields</span> <span class="n">transformation</span> <span class="n">method</span><span class="p">:</span> <span class="n">blob</span>

<span class="n">SED</span> <span class="n">info</span><span class="p">:</span>
 <span class="n">nu</span> <span class="n">grid</span> <span class="n">size</span> <span class="n">jetkernel</span><span class="p">:</span> <span class="mi">1000</span>
 <span class="n">nu</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span> <span class="mi">500</span>
 <span class="n">nu</span> <span class="n">mix</span> <span class="p">(</span><span class="n">Hz</span><span class="p">):</span> <span class="mf">1.000000e+06</span>
 <span class="n">nu</span> <span class="nb">max</span> <span class="p">(</span><span class="n">Hz</span><span class="p">):</span> <span class="mf">1.000000e+30</span>

<span class="n">flux</span> <span class="n">plot</span> <span class="n">lower</span> <span class="n">bound</span>   <span class="p">:</span>  <span class="mf">1.000000e-120</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=17</i>
<table id="table140702458564672-466115" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>EC_example</td><td>R</td><td>region_size</td><td>cm</td><td>5.000000e+15</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>theta</td><td>jet-viewing-angle</td><td>deg</td><td>1.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>BulkFactor</td><td>jet-bulk-factor</td><td>lorentz-factor*</td><td>1.000000e+01</td><td>1.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>z_cosm</td><td>redshift</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>2.000000e+00</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>1.000000e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>1.000000e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>1.000000e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>p</td><td>LE_spectral_slope</td><td></td><td>2.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>tau_BLR</td><td>BLR</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_BLR_in</td><td>BLR</td><td>cm</td><td>1.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>R_BLR_out</td><td>BLR</td><td>cm</td><td>2.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>L_Disk</td><td>Disk</td><td>erg / s</td><td>1.000000e+45</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>T_Disk</td><td>Disk</td><td>K</td><td>1.000000e+05</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140702458564672-466115').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140702458564672-466115').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="change-disk-type">
<h2>change Disk type<a class="headerlink" href="#change-disk-type" title="Permalink to this headline">¶</a></h2>
<p>the disk type can be set as a more realistic multi temperature black
body (MultiBB). In this case the <code class="docutils literal notranslate"><span class="pre">show_model</span></code> method provides physical
parameters regarding the multi temperature black body accretion disk:</p>
<ul class="simple">
<li><p>the Schwarzschild (Sw radius)</p></li>
<li><p>the Eddington luminosity (L Edd.)</p></li>
<li><p>the accretion rate (accr_rate)</p></li>
<li><p>the Eddington accretion rate (accr_rate Edd.)</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">add_EC_component</span><span class="p">([</span><span class="s1">&#39;EC_BLR&#39;</span><span class="p">,</span><span class="s1">&#39;EC_Disk&#39;</span><span class="p">],</span><span class="n">disk_type</span><span class="o">=</span><span class="s1">&#39;MultiBB&#39;</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">1E46</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;gmax&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">5E4</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;gmin&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">3E17</span><span class="p">)</span>

<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;p_1&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">3.2</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">3E15</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;BulkFactor&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;gamma_break&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">5E2</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_N_from_nuLnu</span><span class="p">(</span><span class="n">nu_src</span><span class="o">=</span><span class="mf">3E13</span><span class="p">,</span><span class="n">nuLnu_src</span><span class="o">=</span><span class="mf">5E45</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_IC_nu_size</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="n">jet</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">EC_example</span>

<span class="n">electrons</span> <span class="n">distribution</span><span class="p">:</span>
 <span class="nb">type</span><span class="p">:</span> <span class="n">bkn</span>
 <span class="n">gamma</span> <span class="n">energy</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">201</span>
 <span class="n">gmin</span> <span class="n">grid</span> <span class="p">:</span> <span class="mf">2.000000e+00</span>
 <span class="n">gmax</span> <span class="n">grid</span> <span class="p">:</span> <span class="mf">5.000000e+04</span>
 <span class="n">normalization</span>  <span class="kc">True</span>
 <span class="n">log</span><span class="o">-</span><span class="n">values</span>  <span class="kc">False</span>

<span class="n">accretion</span> <span class="n">disk</span><span class="p">:</span>
 <span class="n">disk</span> <span class="n">Type</span><span class="p">:</span> <span class="n">MultiBB</span>
 <span class="n">L</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">1.000000e+46</span> <span class="p">(</span><span class="n">erg</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
 <span class="n">T</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">5.015768e+04</span> <span class="p">(</span><span class="n">K</span><span class="p">)</span>
 <span class="n">nu</span> <span class="n">peak</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">4.098790e+15</span> <span class="p">(</span><span class="n">Hz</span><span class="p">)</span>
 <span class="n">Sw</span> <span class="n">radius</span> <span class="mf">2.953539e+14</span> <span class="p">(</span><span class="n">cm</span><span class="p">)</span>
 <span class="n">L</span> <span class="n">Edd</span><span class="o">.</span> <span class="mf">1.666723e+47</span> <span class="p">(</span><span class="n">erg</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
 <span class="n">accr_rate</span><span class="p">:</span> <span class="mf">2.205171e+00</span> <span class="p">(</span><span class="n">M_sun</span><span class="o">/</span><span class="n">yr</span><span class="p">)</span>
 <span class="n">accr_rate</span> <span class="n">Edd</span><span class="o">.</span><span class="p">:</span> <span class="mf">3.675409e+01</span> <span class="p">(</span><span class="n">M_sun</span><span class="o">/</span><span class="n">yr</span><span class="p">)</span>

<span class="n">radiative</span> <span class="n">fields</span><span class="p">:</span>
 <span class="n">seed</span> <span class="n">photons</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">100</span>
 <span class="n">IC</span> <span class="n">emission</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">100</span>
 <span class="n">source</span> <span class="n">emissivity</span> <span class="n">lower</span> <span class="n">bound</span> <span class="p">:</span>  <span class="mf">1.000000e-120</span>
 <span class="n">spectral</span> <span class="n">components</span><span class="p">:</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sum</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sync</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="nb">abs</span>
   <span class="n">name</span><span class="p">:</span><span class="n">SSC</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">EC_BLR</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Disk</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">EC_Disk</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
<span class="n">external</span> <span class="n">fields</span> <span class="n">transformation</span> <span class="n">method</span><span class="p">:</span> <span class="n">blob</span>

<span class="n">SED</span> <span class="n">info</span><span class="p">:</span>
 <span class="n">nu</span> <span class="n">grid</span> <span class="n">size</span> <span class="n">jetkernel</span><span class="p">:</span> <span class="mi">1000</span>
 <span class="n">nu</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span> <span class="mi">500</span>
 <span class="n">nu</span> <span class="n">mix</span> <span class="p">(</span><span class="n">Hz</span><span class="p">):</span> <span class="mf">1.000000e+06</span>
 <span class="n">nu</span> <span class="nb">max</span> <span class="p">(</span><span class="n">Hz</span><span class="p">):</span> <span class="mf">1.000000e+30</span>

<span class="n">flux</span> <span class="n">plot</span> <span class="n">lower</span> <span class="n">bound</span>   <span class="p">:</span>  <span class="mf">1.000000e-120</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=20</i>
<table id="table140702465461072-681397" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>EC_example</td><td>R</td><td>region_size</td><td>cm</td><td>3.000000e+15</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_H</td><td>region_position</td><td>cm</td><td>3.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.500000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>theta</td><td>jet-viewing-angle</td><td>deg</td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>BulkFactor</td><td>jet-bulk-factor</td><td>lorentz-factor*</td><td>2.000000e+01</td><td>1.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>z_cosm</td><td>redshift</td><td></td><td>6.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>2.000000e+00</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>5.000000e+04</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>4.171189e+03</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>5.000000e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>p</td><td>LE_spectral_slope</td><td></td><td>1.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.200000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>tau_BLR</td><td>BLR</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_BLR_in</td><td>BLR</td><td>cm</td><td>1.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>R_BLR_out</td><td>BLR</td><td>cm</td><td>2.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>R_inner_Sw</td><td>Disk</td><td>Sw. radii*</td><td>3.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_ext_Sw</td><td>Disk</td><td>Sw. radii*</td><td>5.000000e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>accr_eff</td><td>Disk</td><td></td><td>8.000000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>M_BH</td><td>Disk</td><td>M_sun*</td><td>1.000000e+09</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>L_Disk</td><td>Disk</td><td>erg / s</td><td>1.000000e+46</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140702465461072-681397').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140702465461072-681397').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<p>now we set some parameter for the model</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mf">13.5</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mf">9.5</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_phys_EC_15_0.png" src="../../../_images/Jet_example_phys_EC_15_0.png" />
</div>
<div class="section" id="dusty-torus">
<h2>Dusty Torus<a class="headerlink" href="#dusty-torus" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">add_EC_component</span><span class="p">(</span><span class="s1">&#39;DT&#39;</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="n">jet</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">EC_example</span>

<span class="n">electrons</span> <span class="n">distribution</span><span class="p">:</span>
 <span class="nb">type</span><span class="p">:</span> <span class="n">bkn</span>
 <span class="n">gamma</span> <span class="n">energy</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">201</span>
 <span class="n">gmin</span> <span class="n">grid</span> <span class="p">:</span> <span class="mf">2.000000e+00</span>
 <span class="n">gmax</span> <span class="n">grid</span> <span class="p">:</span> <span class="mf">5.000000e+04</span>
 <span class="n">normalization</span>  <span class="kc">True</span>
 <span class="n">log</span><span class="o">-</span><span class="n">values</span>  <span class="kc">False</span>

<span class="n">accretion</span> <span class="n">disk</span><span class="p">:</span>
 <span class="n">disk</span> <span class="n">Type</span><span class="p">:</span> <span class="n">BB</span>
 <span class="n">L</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">1.000000e+46</span> <span class="p">(</span><span class="n">erg</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
 <span class="n">T</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">5.015768e+04</span> <span class="p">(</span><span class="n">K</span><span class="p">)</span>
 <span class="n">nu</span> <span class="n">peak</span> <span class="n">disk</span><span class="p">:</span> <span class="mf">4.098790e+15</span> <span class="p">(</span><span class="n">Hz</span><span class="p">)</span>

<span class="n">radiative</span> <span class="n">fields</span><span class="p">:</span>
 <span class="n">seed</span> <span class="n">photons</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">100</span>
 <span class="n">IC</span> <span class="n">emission</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">100</span>
 <span class="n">source</span> <span class="n">emissivity</span> <span class="n">lower</span> <span class="n">bound</span> <span class="p">:</span>  <span class="mf">1.000000e-120</span>
 <span class="n">spectral</span> <span class="n">components</span><span class="p">:</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sum</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sync</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="nb">abs</span>
   <span class="n">name</span><span class="p">:</span><span class="n">SSC</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">EC_BLR</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Disk</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">EC_Disk</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">DT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
<span class="n">external</span> <span class="n">fields</span> <span class="n">transformation</span> <span class="n">method</span><span class="p">:</span> <span class="n">blob</span>

<span class="n">SED</span> <span class="n">info</span><span class="p">:</span>
 <span class="n">nu</span> <span class="n">grid</span> <span class="n">size</span> <span class="n">jetkernel</span><span class="p">:</span> <span class="mi">1000</span>
 <span class="n">nu</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span> <span class="mi">500</span>
 <span class="n">nu</span> <span class="n">mix</span> <span class="p">(</span><span class="n">Hz</span><span class="p">):</span> <span class="mf">1.000000e+06</span>
 <span class="n">nu</span> <span class="nb">max</span> <span class="p">(</span><span class="n">Hz</span><span class="p">):</span> <span class="mf">1.000000e+30</span>

<span class="n">flux</span> <span class="n">plot</span> <span class="n">lower</span> <span class="n">bound</span>   <span class="p">:</span>  <span class="mf">1.000000e-120</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=20</i>
<table id="table140702467160096-855512" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>EC_example</td><td>R</td><td>region_size</td><td>cm</td><td>3.000000e+15</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_H</td><td>region_position</td><td>cm</td><td>3.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.500000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>theta</td><td>jet-viewing-angle</td><td>deg</td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>BulkFactor</td><td>jet-bulk-factor</td><td>lorentz-factor*</td><td>2.000000e+01</td><td>1.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>z_cosm</td><td>redshift</td><td></td><td>6.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>2.000000e+00</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>5.000000e+04</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>4.171189e+03</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>5.000000e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>p</td><td>LE_spectral_slope</td><td></td><td>1.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.200000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>tau_BLR</td><td>BLR</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_BLR_in</td><td>BLR</td><td>cm</td><td>1.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>R_BLR_out</td><td>BLR</td><td>cm</td><td>2.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>T_Disk</td><td>Disk</td><td>K</td><td>5.015768e+04</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>T_DT</td><td>DT</td><td>K</td><td>1.000000e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_DT</td><td>DT</td><td>cm</td><td>5.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>tau_DT</td><td>DT</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>L_Disk</td><td>Disk</td><td>erg / s</td><td>1.000000e+46</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140702467160096-855512').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140702467160096-855512').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mf">13.5</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mf">9.5</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_phys_EC_19_0.png" src="../../../_images/Jet_example_phys_EC_19_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">add_EC_component</span><span class="p">(</span><span class="s1">&#39;EC_DT&#39;</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mf">13.5</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mf">9.5</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_phys_EC_21_0.png" src="../../../_images/Jet_example_phys_EC_21_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;test_EC_model.pkl&#39;</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">=</span><span class="n">Jet</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;test_EC_model.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<i>Table length=23</i>
<table id="table140702477679776-353033" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>EC_example</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>2.000000e+00</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>1.000000e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>1.000000e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>1.000000e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>p</td><td>LE_spectral_slope</td><td></td><td>2.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>tau_BLR</td><td>BLR</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_BLR_in</td><td>BLR</td><td>cm</td><td>1.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>R_BLR_out</td><td>BLR</td><td>cm</td><td>2.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>R_inner_Sw</td><td>Disk</td><td>Sw. radii*</td><td>3.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_ext_Sw</td><td>Disk</td><td>Sw. radii*</td><td>5.000000e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>accr_eff</td><td>Disk</td><td></td><td>8.000000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>M_BH</td><td>Disk</td><td>M_sun*</td><td>1.000000e+09</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>T_DT</td><td>DT</td><td>K</td><td>1.000000e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_DT</td><td>DT</td><td>cm</td><td>5.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>tau_DT</td><td>DT</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>L_Disk</td><td>Disk</td><td>erg / s</td><td>1.000000e+45</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R</td><td>region_size</td><td>cm</td><td>5.000000e+15</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>EC_example</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>theta</td><td>jet-viewing-angle</td><td>deg</td><td>1.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>BulkFactor</td><td>jet-bulk-factor</td><td>lorentz-factor*</td><td>1.000000e+01</td><td>1.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>EC_example</td><td>z_cosm</td><td>redshift</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140702477679776-353033').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140702477679776-353033').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script></div>
<div class="section" id="changing-the-external-field-transformation">
<h2>Changing the external field transformation<a class="headerlink" href="#changing-the-external-field-transformation" title="Permalink to this headline">¶</a></h2>
<p>Default method, is the transformation of the external photon field from
the disk/BH frame to the relativistic blob</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">set_external_field_transf</span><span class="p">(</span><span class="s1">&#39;blob&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, in the case of istropric fields as the CMB or the BLR and
DT within the BLR radius, and DT radius, respectively, the it is
possible to transform the the electron distribution, moving the blob to
the disk/BH frame.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">set_external_field_transf</span><span class="p">(</span><span class="s1">&#39;disk&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="external-photon-field-energy-density-along-the-jet">
<h2>External photon field energy density along the jet<a class="headerlink" href="#external-photon-field-energy-density-along-the-jet" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">iso_field_transf</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">BulckFactor</span><span class="p">):</span>
    <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">BulckFactor</span><span class="o">*</span><span class="n">BulckFactor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="mf">3E10</span><span class="p">)</span><span class="o">*</span><span class="n">BulckFactor</span><span class="o">*</span><span class="n">BulckFactor</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">((</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">external_iso_behind_transf</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">BulckFactor</span><span class="p">):</span>
    <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">BulckFactor</span><span class="o">*</span><span class="n">BulckFactor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">L</span><span class="o">/</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="mf">3E10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">BulckFactor</span><span class="o">*</span><span class="n">BulckFactor</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">beta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>EC seed photon fields, in the Disk rest frame</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">N</span><span class="o">=</span><span class="mi">50</span>
<span class="n">G</span><span class="o">=</span><span class="mi">1</span>
<span class="n">R_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_verbosity</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R_BLR_in&#39;</span><span class="p">,</span><span class="mf">1E17</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R_BLR_out&#39;</span><span class="p">,</span><span class="mf">1.1E17</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ID</span><span class="p">,</span><span class="n">R</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R_range</span><span class="p">):</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">R</span><span class="p">)</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">set_external_fields</span><span class="p">()</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">energetic_report</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">ID</span><span class="p">]</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">energetic_dict</span><span class="p">[</span><span class="s1">&#39;U_BLR_DRF&#39;</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ID</span><span class="p">]</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">energetic_dict</span><span class="p">[</span><span class="s1">&#39;U_Disk_DRF&#39;</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">ID</span><span class="p">]</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">energetic_dict</span><span class="p">[</span><span class="s1">&#39;U_DT_DRF&#39;</span><span class="p">]</span>

<span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">,:]</span><span class="o">=</span><span class="n">iso_field_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="o">*</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">tau_DT</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R_DT</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">,:]</span><span class="o">=</span><span class="n">iso_field_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="o">*</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">tau_BLR</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R_BLR_in</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">,:]</span><span class="o">=</span><span class="n">external_iso_behind_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="o">*</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">tau_BLR</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">R_range</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">,:]</span><span class="o">=</span><span class="n">external_iso_behind_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="o">*</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">tau_DT</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">R_range</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">7</span><span class="p">,:]</span><span class="o">=</span><span class="n">external_iso_behind_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="p">,</span><span class="n">R_range</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Disk&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;BLR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DT&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;BLR uniform&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DT uniform&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;BLR 1/R2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DT 1/R2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">7</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Disk 1/R2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;log(R_H) cm&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;log(Uph) erg cm-3 s-1&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7ff7d890c730</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_phys_EC_31_1.png" src="../../../_images/Jet_example_phys_EC_31_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">L_Disk</span><span class="o">=</span><span class="mf">1E45</span>
<span class="n">N</span><span class="o">=</span><span class="mi">50</span>
<span class="n">G</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">BulkFactor</span><span class="o">.</span><span class="n">val</span>
<span class="n">R_range</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">L_Disk</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">theta_n_int</span><span class="o">=</span><span class="mi">100</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">l_n_int</span><span class="o">=</span><span class="mi">100</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">theta_n_int</span><span class="o">=</span><span class="mi">100</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">l_n_int</span><span class="o">=</span><span class="mi">100</span>
<span class="k">for</span> <span class="n">ID</span><span class="p">,</span><span class="n">R</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R_range</span><span class="p">):</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">R</span><span class="p">)</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R_BLR_in&#39;</span><span class="p">,</span><span class="mf">1E17</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E45</span><span class="p">)</span><span class="o">**.</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R_BLR_out&#39;</span><span class="p">,</span><span class="mf">1.1E17</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E45</span><span class="p">)</span><span class="o">**.</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R_DT&#39;</span><span class="p">,</span><span class="mf">2.5E18</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E45</span><span class="p">)</span><span class="o">**.</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">set_external_fields</span><span class="p">()</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">energetic_report</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">ID</span><span class="p">]</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">energetic_dict</span><span class="p">[</span><span class="s1">&#39;U_BLR&#39;</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ID</span><span class="p">]</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">energetic_dict</span><span class="p">[</span><span class="s1">&#39;U_Disk&#39;</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">ID</span><span class="p">]</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">energetic_dict</span><span class="p">[</span><span class="s1">&#39;U_DT&#39;</span><span class="p">]</span>



<span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">,:]</span><span class="o">=</span><span class="n">iso_field_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="o">*</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">tau_DT</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R_DT</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">,:]</span><span class="o">=</span><span class="n">iso_field_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="o">*</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">tau_BLR</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R_BLR_in</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">,:]</span><span class="o">=</span><span class="n">external_iso_behind_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="o">*</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">tau_BLR</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">R_range</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">,:]</span><span class="o">=</span><span class="n">external_iso_behind_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="o">*</span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">tau_DT</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">R_range</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">7</span><span class="p">,:]</span><span class="o">=</span><span class="n">external_iso_behind_transf</span><span class="p">(</span><span class="n">my_jet</span><span class="o">.</span><span class="n">_blob</span><span class="o">.</span><span class="n">L_Disk_radiative</span><span class="p">,</span><span class="n">R_range</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Disk&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;BLR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DT&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;BLR uniform&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DT uniform&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;BLR 1/R2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DT 1/R2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">R_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">7</span><span class="p">,:]),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Disk 1/R2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R_DT</span><span class="o">.</span><span class="n">val</span> <span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R_BLR_out</span><span class="o">.</span><span class="n">val</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;log(R_H) cm&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;log(Uph`) erg cm-3 s-1&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7ff7d8d21790</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_phys_EC_32_1.png" src="../../../_images/Jet_example_phys_EC_32_1.png" />
</div>
<div class="section" id="ic-against-the-cmb">
<h2>IC against the CMB<a class="headerlink" href="#ic-against-the-cmb" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">=</span><span class="n">Jet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;test_equipartition&#39;</span><span class="p">,</span><span class="n">electron_distribution</span><span class="o">=</span><span class="s1">&#39;lppl&#39;</span><span class="p">,</span><span class="n">beaming_expr</span><span class="o">=</span><span class="s1">&#39;bulk_theta&#39;</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">1E21</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span> <span class="mf">0.651</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">2E-5</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;gmin&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;gamma0_log_parab&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">35.0E3</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;gmax&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">30E5</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;BulkFactor&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">2.58</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_par</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="mf">0.42</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">set_N_from_nuFnu</span><span class="p">(</span><span class="mf">5E-15</span><span class="p">,</span><span class="mf">1E12</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">add_EC_component</span><span class="p">(</span><span class="s1">&#39;EC_CMB&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now compare the different beaming pattern for the EC emission if
the CMB, and realize that the beaming pattern is different. This is very
important in the case of radio galaxies. The <code class="docutils literal notranslate"><span class="pre">src</span></code> transformation is
the one to use in the case of radio galaies or misaligned AGNs, and
gives a more accurate results. Anyhow, be careful that this works only
for isotropic external fields, suchs as the CMB, or the BLR seed photons
whitin the Dusty torus radius, and BLR radius, respectively</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="kn">import</span> <span class="n">PlotSED</span>
<span class="n">p</span><span class="o">=</span><span class="n">PlotSED</span><span class="p">()</span>

<span class="n">my_jet</span><span class="o">.</span><span class="n">set_external_field_transf</span><span class="p">(</span><span class="s1">&#39;blob&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ID</span><span class="p">,</span><span class="n">theta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">theta</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">plot_obj</span><span class="o">=</span><span class="n">p</span><span class="p">,</span><span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;blob, theta=</span><span class="si">%2.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">theta</span>,line_style=&#39;--&#39;,color=c[ID])

<span class="n">my_jet</span><span class="o">.</span><span class="n">set_external_field_transf</span><span class="p">(</span><span class="s1">&#39;disk&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ID</span><span class="p">,</span><span class="n">theta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">4</span><span class="p">)):</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="n">theta</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">my_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">plot_obj</span><span class="o">=</span><span class="n">p</span><span class="p">,</span><span class="n">comp</span><span class="o">=</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;disk, theta=</span><span class="si">%2.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">theta</span>,line_style=&#39;&#39;,color=c[ID])

<span class="n">p</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mf">17.5</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mf">12.5</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_phys_EC_36_0.png" src="../../../_images/Jet_example_phys_EC_36_0.png" />
</div>
</div>
<div class="section" id="equipartition">
<h1>Equipartition<a class="headerlink" href="#equipartition" title="Permalink to this headline">¶</a></h1>
<p>It is also possible to set our jet at the equipartition, that is
achieved not using analytical approximation, but by numerically finding
the equipartition value over a grid. We have to provide the value of the
observed flux (<code class="docutils literal notranslate"><span class="pre">nuFnu_obs</span></code>) at a given observed frequency
(<code class="docutils literal notranslate"><span class="pre">nu_obs</span></code>), the minimum value of B (<code class="docutils literal notranslate"><span class="pre">B_min</span></code>), and the number of grid
points (<code class="docutils literal notranslate"><span class="pre">N_pts</span></code>)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_jet</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">val</span><span class="o">=</span><span class="mi">12</span>
<span class="n">B_min</span><span class="p">,</span><span class="n">b_grid</span><span class="p">,</span><span class="n">U_B</span><span class="p">,</span><span class="n">U_e</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">set_B_eq</span><span class="p">(</span><span class="n">nuFnu_obs</span><span class="o">=</span><span class="mf">5E-15</span><span class="p">,</span><span class="n">nu_obs</span><span class="o">=</span><span class="mf">1E12</span><span class="p">,</span><span class="n">B_min</span><span class="o">=</span><span class="mf">1E-9</span><span class="p">,</span><span class="n">N_pts</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">my_jet</span><span class="o">.</span><span class="n">show_pars</span><span class="p">()</span>

<span class="n">my_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="n">grid</span> <span class="nb">min</span>  <span class="mf">1e-09</span>
<span class="n">B</span> <span class="n">grid</span> <span class="nb">max</span>  <span class="mf">1.0</span>
<span class="n">grid</span> <span class="n">points</span> <span class="mi">50</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_phys_EC_39_1.png" src="../../../_images/Jet_example_phys_EC_39_1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setting</span> <span class="n">B</span> <span class="n">to</span>  <span class="mf">0.0001389495494373139</span>
<span class="n">setting</span> <span class="n">N</span> <span class="n">to</span>  <span class="mf">9.160733610838076e-06</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table140702479999520-710298" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>test_equipartition</td><td>R</td><td>region_size</td><td>cm</td><td>1.000000e+21</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>test_equipartition</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.389495e-04</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>theta</td><td>jet-viewing-angle</td><td>deg</td><td>1.200000e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>BulkFactor</td><td>jet-bulk-factor</td><td>lorentz-factor*</td><td>3.500000e+00</td><td>1.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>z_cosm</td><td>redshift</td><td></td><td>6.510000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>5.000000e+01</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>3.000000e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>9.160734e-06</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>3.500000e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.580000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>r</td><td>spectral_curvature</td><td></td><td>4.200000e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>L_Disk</td><td>Disk</td><td>erg / s</td><td>1.000000e+45</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>test_equipartition</td><td>T_Disk</td><td>Disk</td><td>K</td><td>1.000000e+05</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140702479999520-710298').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140702479999520-710298').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">my_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mf">16.5</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mf">13.5</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_phys_EC_40_0.png" src="../../../_images/Jet_example_phys_EC_40_0.png" />
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, andrea tramacere.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>