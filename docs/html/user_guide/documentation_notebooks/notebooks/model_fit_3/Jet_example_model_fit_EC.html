
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Model fitting 3: External Compton &#8212; jetset  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=4d2e84a3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/documentation_notebooks/notebooks/model_fit_3/Jet_example_model_fit_EC';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Model fitting 4: Only Synchrotron" href="../model_fit_4/Jet_example_only_synchrotron.html" />
    <link rel="prev" title="Model fitting 2: SSC + galaxy template" href="../model_fit_2/Jet_example_model_fit_wiht_gal_template.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/logo_book_sphinx.svg" class="logo__image only-light" alt="JetSeT "/>
    <script>document.write(`<img src="../../../../_static/logo_book_sphinx.svg" class="logo__image only-dark" alt="JetSeT "/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/andreatramacere/jetset" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../change_log_specs/v1.3.0.html">what's new in JetSeT v1.3.0?</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../changelog.html">changelog</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../change_log_specs/v1.3.0.html"> Version 1.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../change_log_specs/v1.2.2.html"> Version 1.2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../change_log_specs/v1.2.1.html"> Version 1.2.1</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../user_guide.html">user guide</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../model_basic.html">model basic features  *New (v1.3.0)*</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html"> jet model physical setup 1 (basic features and SSC) -  *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../jet_model_phys_EC/Jet_example_phys_EC.html"> jet model physical setup 2 (EC and Equipartition) -  *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synchrotron_polarization/Jet_example_synch_pol.html"> jet leptonic synchrotron polarization -  *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../jet_model_num/Jet_example_num.html"> jet model numerical setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hadronic_pp_jet/hadronic.html"> jet hadronic pp model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../galactic/galactic.html"> galactic beamed/unbeamed objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cosmology/Jet_example_cosmo.html"> change cosmology model - *New (v1.3.0)*</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../model_advanced.html">model advanced features   *New (v1.3.0)*</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../composite_model/Composite_model.html"> composite models  *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../composite_model/Composite_model_two_zone.html"> composite models: a two-zone jet  *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../depending_pars/depending_pars.html"> depending parameters  *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a></li>

<li class="toctree-l3"><a class="reference internal" href="../EBL/EBL.html"> EBL models *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../galactic/galactic_nova.html"> example of galactic nova - *New (v1.3.0)*</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../data_and_phenomenology.html">data and phenomenology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../load_data/Jet_example_load_data.html"> data format</a></li>
<li class="toctree-l3"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html"> phenomenological model constraining: theoretical background on SSC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../phen_constr/Jet_example_phenom_constr.html"> phenomenological model constraining: application</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../../model_fitting.html">model fitting  *New (v1.3.0)*</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../model_fitting_intro.html"> caveats and introduction on model fitting and minimizers  *New (v1.3.0)*</a></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../../../model_fitting_examples.html"> model fitting examples  *New (v1.3.0)*</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../model_fit_1/Jet_example_model_fit.html"> 1: SSC model fit, minuit contours, and MCMC for Mrk 421 *New (v1.3.0)*</a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_fit_2/Jet_example_model_fit_wiht_gal_template.html"> 2: SSC (jet+galaxy template) model fit and MCMC for Mrk 501 *New (v1.3.0)*</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#"> 3: SSC and EC fit for 3C 454.3 *New (v1.3.0)*</a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_fit_4/Jet_example_only_synchrotron.html"> 4: Only Synchroton for Mrk 421 fit, minuit contours, and MCMC *New (v1.3.0)*</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html"> 5: Mrk 521 SSC+EBL with Sherpa minimizer and jetset model  *New (v1.3.0)*</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../temp_ev.html">temporal evolution</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html"> Temporal evolution, one zone, only cooling *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling.html"> Temporal evolution, two zones,  cooling+acc *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html"> Temporal evolution, two zones,  cooling+acc+adiabatic expansion *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hadronic_pp_jet/hadronic_validate_temp_ev.html"> Temporal evolution, validation of the hadronic pp secondaries evolution *New (v1.2.0)*</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../plugins.html">plugins  *New (v1.3.0)*</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html"> Example to use the sherpa plugin with the Sherpa interface *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html"> Example to use the Gamma-py plugin with the JeSeT interface *New (v1.3.0)*</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../api/modules.html">code documentation (API)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/analytical_model.html">analytical_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.analytical_model.AnalyticalParameter.html">AnalyticalParameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.analytical_model.Disk.html">Disk</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/base_model.html">base_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.base_model.Model.html">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.base_model.MultiplicativeModel.html">MultiplicativeModel</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/convert_qdp.html">convert_qdp</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.convert_qdp.check_is_number.html">check_is_number</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.convert_qdp.do_convert.html">do_convert</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/cosmo_tools.html">cosmo_tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.cosmo_tools.Cosmo.html">Cosmo</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/data_loader.html">data_loader</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.data_loader.get_data_set_msk.html">get_data_set_msk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.data_loader.get_freq_range_msk.html">get_freq_range_msk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.data_loader.lin_to_log.html">lin_to_log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.data_loader.log_to_lin.html">log_to_lin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.data_loader.ObsData.html">ObsData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.data_loader.Data.html">Data</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/frame_converter.html">frame_converter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.frame_converter.convert_nu_to_blob.html">convert_nu_to_blob</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.frame_converter.convert_nu_to_src.html">convert_nu_to_src</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.frame_converter.convert_nuFnu_to_nuLnu_src.html">convert_nuFnu_to_nuLnu_src</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/gammapy_plugin.html">gammapy_plugin</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.gammapy_plugin.GammapyJetsetModelFactory.html">GammapyJetsetModelFactory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.gammapy_plugin.GammapyJetsetModel.html">GammapyJetsetModel</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/jet_emitters.html">jet_emitters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_emitters.EmittersDistribution.html">EmittersDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_emitters.BaseEmittersDistribution.html">BaseEmittersDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_emitters.ArrayDistribution.html">ArrayDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_emitters.EmittersArrayDistribution.html">EmittersArrayDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_emitters.InjEmittersDistribution.html">InjEmittersDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_emitters.JetkernelEmittersDistribution.html">JetkernelEmittersDistribution</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/jet_emitters_factory.html">jet_emitters_factory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_emitters_factory.EmittersFactory.html">EmittersFactory</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/jet_kernel_tools.html">jet_kernel_tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_kernel_tools.get_spectral_c_array.html">get_spectral_c_array</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/jet_model.html">jet_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_model.Jet.html">Jet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_model.JetBase.html">JetBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_model.GalacticBeamed.html">GalacticBeamed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_model.GalacticUnbeamed.html">GalacticUnbeamed</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/jet_paramters.html">jet_paramters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_paramters.JetParameter.html">JetParameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_paramters.JetModelDictionaryPar.html">JetModelDictionaryPar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_paramters.JetModelParameterArray.html">JetModelParameterArray</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/jet_spectral_components.html">jet_spectral_components</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_spectral_components.JetSeedPhotons.html">JetSeedPhotons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_spectral_components.JetSpecComponent.html">JetSpecComponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_spectral_components.SpecCompList.html">SpecCompList</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/jet_timedep.html">jet_timedep</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_timedep.merge_lcs.html">merge_lcs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_timedep.JetTimeEvol.html">JetTimeEvol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_timedep.TimeEmittersDistribution.html">TimeEmittersDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_timedep.TimeEvolvingRegion.html">TimeEvolvingRegion</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/jet_tools.html">jet_tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_tools.build_emitting_region_dict.html">build_emitting_region_dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_tools.build_ExtFields_dic.html">build_ExtFields_dic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_tools.BLR_constraints.html">BLR_constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_tools.DT_constraints.html">DT_constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.jet_tools.clean_numba.html">clean_numba</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/jetkernel_models_dic.html">jetkernel_models_dic</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/loglog_poly_model.html">loglog_poly_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.loglog_poly_model.find_max_cubic.html">find_max_cubic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.loglog_poly_model.LogCubic.html">LogCubic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.loglog_poly_model.LogLinear.html">LogLinear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.loglog_poly_model.LogLogModel.html">LogLogModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.loglog_poly_model.LogParabolaEp.html">LogParabolaEp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.loglog_poly_model.LogParabolaPL.html">LogParabolaPL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.loglog_poly_model.PolyParameter.html">PolyParameter</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/mathkernel_helper.html">mathkernel_helper</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/mcmc.html">mcmc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.mcmc.McmcSampler.html">McmcSampler</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/minimizer.html">minimizer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.minimizer.fit_SED.html">fit_SED</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.minimizer.FitResults.html">FitResults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.minimizer.Minimizer.html">Minimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.minimizer.LSBMinimizerScipy.html">LSBMinimizerScipy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.minimizer.MinuitMinimizer.html">MinuitMinimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.minimizer.ModelMinimizer.html">ModelMinimizer</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/model_manager.html">model_manager</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.model_manager.FitModel.html">FitModel</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/model_parameters.html">model_parameters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.model_parameters.ModelParameter.html">ModelParameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.model_parameters.ModelParameterArray.html">ModelParameterArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.model_parameters.Value.html">Value</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/obs_constrain.html">obs_constrain</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.check_boundaries.html">check_boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.check_t_var.html">check_t_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.constr_B_from_nu_peaks.html">constr_B_from_nu_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.constr_R_from_CD.html">constr_R_from_CD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.find_B_from_nu_p_S.html">find_B_from_nu_p_S</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.find_gamma0.html">find_gamma0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.find_gamma_3p_SSC.html">find_gamma_3p_SSC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.find_gamma_Synch.html">find_gamma_Synch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.find_HE_cut_off.html">find_HE_cut_off</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.find_s.html">find_s</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.find_s1.html">find_s1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.find_turn_over.html">find_turn_over</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.get_Comp_factor.html">get_Comp_factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.get_R_tvar.html">get_R_tvar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.get_U_Sync_from_Ph.html">get_U_Sync_from_Ph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.rescale_Ne.html">rescale_Ne</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.set_gmin_from_nu_cut_IR.html">set_gmin_from_nu_cut_IR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.obs_constrain.ObsConstrain.html">ObsConstrain</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/output.html">output</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.output.clean_dir.html">clean_dir</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.output.makedir.html">makedir</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.output.WorkPlace.html">WorkPlace</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/plot_sedfit.html">plot_sedfit</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.plot_sedfit.PlotSED.html">PlotSED</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.plot_sedfit.BasePlot.html">BasePlot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.plot_sedfit.PlotPdistr.html">PlotPdistr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.plot_sedfit.PlotSpecComp.html">PlotSpecComp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.plot_sedfit.PlotSeedPhotons.html">PlotSeedPhotons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.plot_sedfit.PlotSpectralMultipl.html">PlotSpectralMultipl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.plot_sedfit.PlotTempEvDiagram.html">PlotTempEvDiagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.plot_sedfit.PlotTempEvEmitters.html">PlotTempEvEmitters</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/poly_fit.html">poly_fit</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.check_maxima.html">check_maxima</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.cubic_peaks.html">cubic_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.do_cubic_fit.html">do_cubic_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.do_cubic_fit_peaks.html">do_cubic_fit_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.do_linear_fit.html">do_linear_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.do_log_Parab_FIT.html">do_log_Parab_FIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.filter_interval.html">filter_interval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.find_max_cubic.html">find_max_cubic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.lin.html">lin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.parab.html">parab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.residuals_cubic_peaks.html">residuals_cubic_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.residuals_linfit.html">residuals_linfit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit.residuals_parab.html">residuals_parab</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/poly_fit_tools.html">poly_fit_tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit_tools.get_SED_log_par_fit.html">get_SED_log_par_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit_tools.get_SED_pl_fit.html">get_SED_pl_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit_tools.get_n_gamma_log_par_fit.html">get_n_gamma_log_par_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.poly_fit_tools.get_nu_p_S_delta_approx.html">get_nu_p_S_delta_approx</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/sed_shaper.html">sed_shaper</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.filter_interval.html">filter_interval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.find_E0.html">find_E0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.IC_fit_range.html">IC_fit_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.spectral_index_range.html">spectral_index_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.sync_fit_range.html">sync_fit_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.index.html">index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.index_array.html">index_array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.index_typecasting.html">index_typecasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.peak_values.html">peak_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sed_shaper.SEDShape.html">SEDShape</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/sherpa_plugin.html">sherpa_plugin</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sherpa_plugin.plot_sherpa_model.html">plot_sherpa_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.sherpa_plugin.JetsetSherpaModel.html">JetsetSherpaModel</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/spectral_shapes.html">spectral_shapes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.spectral_shapes.SED.html">SED</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/template_2Dmodel.html">template_2Dmodel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.template_2Dmodel.TemplateTable2D.html">TemplateTable2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.template_2Dmodel.EBLAbsorptionTemplate.html">EBLAbsorptionTemplate</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/template_model.html">template_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.template_model.SpectralTemplateLogLog.html">SpectralTemplateLogLog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.template_model.TemplateParameter.html">TemplateParameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.template_model.BigBlueBumpTemplateLogLog.html">BigBlueBumpTemplateLogLog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.template_model.HostGalaxyTemplateLogLog.html">HostGalaxyTemplateLogLog</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/test_data_helper.html">test_data_helper</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/utils.html">utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.utils.check_frame.html">check_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.utils.unexpected_behaviour.html">unexpected_behaviour</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../api/version_notifier.html">version_notifier</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.version_notifier.check_version.html">check_version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.version_notifier.run_version_checking.html">run_version_checking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/jetset.version_notifier.capture.html">capture</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../references.html">bibliography</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">New/updated in v 1.2.0-1.3.0:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a></li>

<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadronic.html">Hadronic pp jet model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html">Temporal evolution, one zone, only cooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling.html">Temporal evolution, two zones, cooling+acc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html">Temporal evolution, two zones, cooling+acc+adb exp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the Sherpa plugin with the sherpa interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the Sherpa minimizer plugin with a JeSeT model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html">Example to use the Gamma-py plugin with the JeSeT interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../galactic/galactic.html">Galactic object models</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/user_guide/documentation_notebooks/notebooks/model_fit_3/Jet_example_model_fit_EC.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Model fitting 3: External Compton</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-data">Loading data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phenomenological-model-constraining">Phenomenological model constraining</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ec-model-fit">EC model fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcmc">MCMC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-reuse-mcmc">Save and reuse MCMC</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="highlight-ipython3 notranslate" id="model-fitting-ec"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="model-fitting-3-external-compton">
<h1>Model fitting 3: External Compton<a class="headerlink" href="#model-fitting-3-external-compton" title="Link to this heading">#</a></h1>
<section id="loading-data">
<h2>Loading data<a class="headerlink" href="#loading-data" title="Link to this heading">#</a></h2>
<p>see the <a class="reference internal" href="../load_data/Jet_example_load_data.html#data-format"><span class="std std-ref">Data format and SED data</span></a> user guide for further information about loading data and <a class="reference internal" href="../jet_model_phys_EC/Jet_example_phys_EC.html#jet-physical-guide-ec"><span class="std std-ref">External Compton</span></a> for the information regarding the implementation of the external Conpton model</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.jet_model</span> <span class="kn">import</span> <span class="n">Jet</span>
<span class="kn">from</span> <span class="nn">jetset.data_loader</span> <span class="kn">import</span> <span class="n">Data</span><span class="p">,</span><span class="n">ObsData</span>
<span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="kn">import</span>  <span class="n">test_SEDs</span>
<span class="n">test_SEDs</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;/Users/orion/miniforge3/envs/jetset/lib/python3.10/site-packages/jetset/test_data/SEDs_data/SED_3C345.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/miniforge3/envs/jetset/lib/python3.10/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk421_EBL_DEABS.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/miniforge3/envs/jetset/lib/python3.10/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk501_EBL_ABS.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/miniforge3/envs/jetset/lib/python3.10/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk501_EBL_DEABS.ecsv&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">test_SEDs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sed_data</span><span class="o">=</span><span class="n">ObsData</span><span class="p">(</span><span class="n">data_table</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">p</span><span class="o">=</span><span class="n">sed_data</span><span class="o">.</span><span class="n">plot_sed</span><span class="p">(</span><span class="n">show_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_8_0.png" src="../../../../_images/Jet_example_model_fit_EC_8_0.png" />
<p>we filter out the data set <code class="docutils literal notranslate"><span class="pre">-1</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sed_data</span><span class="o">.</span><span class="n">show_data_sets</span><span class="p">()</span>
<span class="n">sed_data</span><span class="o">.</span><span class="n">filter_data_set</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sed_data</span><span class="o">.</span><span class="n">filter_data_set</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sed_data</span><span class="o">.</span><span class="n">show_data_sets</span><span class="p">()</span>
<span class="n">p</span><span class="o">=</span><span class="n">sed_data</span><span class="o">.</span><span class="n">plot_sed</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">current</span> <span class="n">datasets</span>
<span class="n">dataset</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">dataset</span> <span class="mi">0</span>
<span class="n">dataset</span> <span class="mi">1</span>
<span class="n">dataset</span> <span class="mi">2</span>
<span class="o">---&gt;</span> <span class="n">excluding</span>  <span class="n">data_set</span><span class="o">/</span><span class="n">s</span> <span class="p">[</span><span class="s1">&#39;-1&#39;</span><span class="p">]</span>
<span class="nb">filter</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">192</span>
<span class="n">current</span> <span class="n">datasets</span>
<span class="n">dataset</span> <span class="mi">0</span>
<span class="n">dataset</span> <span class="mi">1</span>
<span class="n">dataset</span> <span class="mi">2</span>
<span class="o">---&gt;</span> <span class="n">data</span> <span class="n">sets</span> <span class="n">left</span> <span class="n">after</span> <span class="n">filtering</span> <span class="kc">None</span>
<span class="o">---&gt;</span> <span class="n">data</span> <span class="nb">len</span> <span class="n">after</span> <span class="n">filtering</span><span class="o">=</span><span class="mi">192</span>
<span class="o">---&gt;</span> <span class="n">excluding</span>  <span class="n">data_set</span><span class="o">/</span><span class="n">s</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>
<span class="nb">filter</span> <span class="mi">2</span> <span class="mi">191</span>
<span class="n">current</span> <span class="n">datasets</span>
<span class="n">dataset</span> <span class="mi">0</span>
<span class="n">dataset</span> <span class="mi">1</span>
<span class="o">---&gt;</span> <span class="n">data</span> <span class="n">sets</span> <span class="n">left</span> <span class="n">after</span> <span class="n">filtering</span> <span class="kc">None</span>
<span class="o">---&gt;</span> <span class="n">data</span> <span class="nb">len</span> <span class="n">after</span> <span class="n">filtering</span><span class="o">=</span><span class="mi">191</span>
<span class="n">current</span> <span class="n">datasets</span>
<span class="n">dataset</span> <span class="mi">0</span>
<span class="n">dataset</span> <span class="mi">1</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_10_1.png" src="../../../../_images/Jet_example_model_fit_EC_10_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sed_data</span><span class="o">.</span><span class="n">group_data</span><span class="p">(</span><span class="n">bin_width</span><span class="o">=</span><span class="mf">.15</span><span class="p">)</span>
<span class="n">sed_data</span><span class="o">.</span><span class="n">add_systematics</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,[</span><span class="mf">10.</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mf">10.</span><span class="o">**</span><span class="mi">29</span><span class="p">])</span>
<span class="c1">#sed_data.add_systematics(0.05,[10.**19,10.**30])</span>

<span class="n">p</span><span class="o">=</span><span class="n">sed_data</span><span class="o">.</span><span class="n">plot_sed</span><span class="p">()</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>*  binning data  *</strong>
---&gt; N bins= 100
---&gt; bin_widht= 0.15
msk [False  True False  True  True  True  True False  True  True  True  True
  True False  True  True  True False  True False False False False False
 False False False False False False False False False False False False
  True  True  True  True False False False False False False False False
 False False False  True  True  True  True  True  True  True  True False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False  True False False  True False False False  True
 False False  True False]
================================================================================</pre>
<img alt="../../../../_images/Jet_example_model_fit_EC_11_1.png" src="../../../../_images/Jet_example_model_fit_EC_11_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sed_data</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;3C454_data.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="phenomenological-model-constraining">
<h2>Phenomenological model constraining<a class="headerlink" href="#phenomenological-model-constraining" title="Link to this heading">#</a></h2>
<p>see the <a class="reference internal" href="../phen_constr/Jet_example_phenom_constr.html#phenom-constr"><span class="std std-ref">Phenomenological model constraining: application</span></a> user guide for further information about phenomenological model constraining</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.sed_shaper</span> <span class="kn">import</span>  <span class="n">SEDShape</span>
<span class="n">my_shape</span><span class="o">=</span><span class="n">SEDShape</span><span class="p">(</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">my_shape</span><span class="o">.</span><span class="n">eval_indices</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">plot_indices</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">,</span><span class="n">y_max</span><span class="o">=</span><span class="mf">1E-9</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* evaluating spectral indices for data *</strong>
================================================================================</pre>
<img alt="../../../../_images/Jet_example_model_fit_EC_15_1.png" src="../../../../_images/Jet_example_model_fit_EC_15_1.png" />
<p>for the synchrotron sed_shaping we include the check for Big Blue Bump
(BBB) component. Moreover, we force the model to use a pure
log-parabolic function and not a log-cubic one in order to get a better
estimation of the BBB component. The fit values of the BBB component
will be used in the <code class="docutils literal notranslate"><span class="pre">ObsConstrain</span></code> to guess the accretion disk
luminosity and temperature</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mm</span><span class="p">,</span><span class="n">best_fit</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">sync_fit</span><span class="p">(</span><span class="n">check_BBB_template</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">check_host_gal_template</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">use_log_par</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">Ep_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">minimizer</span><span class="o">=</span><span class="s1">&#39;lsb&#39;</span><span class="p">,</span>
                              <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">16</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* Log-Polynomial fitting of the synchrotron component *</strong>
---&gt; first blind fit run,  fit range: [9, 16]
--&gt; class:  LSP

--&gt; class:  LSP</pre>
<i>Table length=5</i>
<table id="table5573765936-845517" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>LogParabolaEp</td><td>b</td><td>-3.083929e-01</td><td>-3.083929e-01</td><td>2.309292e-02</td><td>--</td><td>-1.560623e-01</td><td>-1.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
<tr><td>LogParabolaEp</td><td>Ep</td><td>1.168757e+01</td><td>1.168757e+01</td><td>9.352232e-02</td><td>--</td><td>1.281229e+01</td><td>0.000000e+00</td><td>3.000000e+01</td><td>False</td></tr>
<tr><td>LogParabolaEp</td><td>Sp</td><td>-1.122282e+01</td><td>-1.122282e+01</td><td>3.377790e-02</td><td>--</td><td>-1.089599e+01</td><td>-3.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
<tr><td>BBB</td><td>nuFnu_p_BBB</td><td>-1.155675e+01</td><td>-1.155675e+01</td><td>1.991849e-02</td><td>--</td><td>-1.089599e+01</td><td>-1.289599e+01</td><td>-8.895992e+00</td><td>False</td></tr>
<tr><td>BBB</td><td>nu_scale</td><td>9.430361e-03</td><td>9.430361e-03</td><td>4.189487e-04</td><td>--</td><td>0.000000e+00</td><td>-5.000000e-01</td><td>5.000000e-01</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5573765936-845517').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5573765936-845517').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---&gt;</span> <span class="n">sync</span>       <span class="n">nu_p</span><span class="o">=+</span><span class="mf">1.168757e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">9.352232e-02</span><span class="p">)</span>  <span class="n">nuFnu_p</span><span class="o">=-</span><span class="mf">1.122282e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">3.377790e-02</span><span class="p">)</span> <span class="n">curv</span><span class="o">.=-</span><span class="mf">3.083929e-01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">2.309292e-02</span><span class="p">)</span>
<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_shape</span><span class="o">.</span><span class="n">IC_fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">26</span><span class="p">],</span><span class="n">minimizer</span><span class="o">=</span><span class="s1">&#39;minuit&#39;</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">plot_shape_fit</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* Log-Polynomial fitting of the IC component *</strong>
---&gt; fit range: [16, 26]
---&gt; LogCubic fit
====&gt; simplex
====&gt; migrad
====&gt; simplex
====&gt; migrad
====&gt; simplex
====&gt; migrad</pre>
<i>Table length=4</i>
<table id="table5577467664-595076" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>LogCubic</td><td>b</td><td>-1.239523e-01</td><td>-1.239523e-01</td><td>1.307983e-02</td><td>--</td><td>-1.000000e+00</td><td>-1.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
<tr><td>LogCubic</td><td>c</td><td>-1.215669e-02</td><td>-1.215669e-02</td><td>2.221392e-03</td><td>--</td><td>-1.000000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Ep</td><td>2.238469e+01</td><td>2.238469e+01</td><td>1.156381e-01</td><td>--</td><td>2.235747e+01</td><td>0.000000e+00</td><td>3.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Sp</td><td>-1.038704e+01</td><td>-1.038704e+01</td><td>4.359969e-02</td><td>--</td><td>-1.000000e+01</td><td>-3.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5577467664-595076').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5577467664-595076').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---&gt;</span> <span class="n">IC</span>         <span class="n">nu_p</span><span class="o">=+</span><span class="mf">2.238469e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">1.156381e-01</span><span class="p">)</span>  <span class="n">nuFnu_p</span><span class="o">=-</span><span class="mf">1.038704e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">4.359969e-02</span><span class="p">)</span> <span class="n">curv</span><span class="o">.=-</span><span class="mf">1.239523e-01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">1.307983e-02</span><span class="p">)</span>
<span class="o">================================================================================</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_18_3.png" src="../../../../_images/Jet_example_model_fit_EC_18_3.png" />
<p>In this case we use the <code class="docutils literal notranslate"><span class="pre">constrain_SSC_EC_model</span></code>, and we ask to use a
dusty torus and BLR component external component</p>
<p>read the section <a class="reference internal" href="../jet_model_phys_EC/Jet_example_phys_EC.html#jet-physical-guide-ec"><span class="std std-ref">External Compton</span></a>  for more information regarding the EC model</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.obs_constrain</span> <span class="kn">import</span> <span class="n">ObsConstrain</span>
<span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">fit_SED</span>
<span class="n">sed_obspar</span><span class="o">=</span><span class="n">ObsConstrain</span><span class="p">(</span><span class="n">B_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span>
                        <span class="n">distr_e</span><span class="o">=</span><span class="s1">&#39;bkn&#39;</span><span class="p">,</span>
                        <span class="n">t_var_sec</span><span class="o">=</span><span class="mi">15</span><span class="o">*</span><span class="mi">86400</span><span class="p">,</span>
                        <span class="n">nu_cut_IR</span><span class="o">=</span><span class="mf">1E9</span><span class="p">,</span>
                        <span class="n">theta</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">bulk_factor</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                        <span class="n">SEDShape</span><span class="o">=</span><span class="n">my_shape</span><span class="p">)</span>


<span class="n">prefit_jet</span><span class="o">=</span><span class="n">sed_obspar</span><span class="o">.</span><span class="n">constrain_SSC_EC_model</span><span class="p">(</span><span class="n">electron_distribution_log_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">EC_components_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC_DT&#39;</span><span class="p">,</span><span class="s1">&#39;EC_BLR&#39;</span><span class="p">],</span><span class="n">R_H</span><span class="o">=</span><span class="mf">2E18</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>*  constrains parameters from observable *</strong>

===&gt; setting C threads to 12
adding par: L_Disk to  R_BLR_in
==&gt; par R_BLR_in is depending on ['L_Disk'] according to expr:   R_BLR_in =
3E17*(L_Disk/1E46)**0.5
adding par: R_BLR_in to  R_BLR_out
==&gt; par R_BLR_out is depending on ['R_BLR_in'] according to expr:   R_BLR_out =
R_BLR_in*1.1
adding par: L_Disk to  R_DT
==&gt; par R_DT is depending on ['L_Disk'] according to expr:   R_DT =
2E19*(L_Disk/1E46)**0.5</pre>
<i>Table length=21</i>
<table id="table5554635872-657504" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>7.607512e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>2.000000e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.500000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta</td><td>jet-viewing-angle</td><td>deg</td><td>2.000000e+00</td><td>0.000000e+00</td><td>9.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>BulkFactor</td><td>jet-bulk-factor</td><td>lorentz-factor*</td><td>2.000000e+01</td><td>1.000000e+00</td><td>1.000000e+05</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>5.930000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>1.033091e+01</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>1.311585e+04</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>8.405479e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>2.279937e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>LE_spectral_slope</td><td></td><td>2.309926e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>T_DT</td><td>DT</td><td>K</td><td>1.000000e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R_DT(D,L_Disk)</td><td>DT</td><td>cm</td><td>1.305539e+19</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_DT</td><td>DT</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>tau_BLR</td><td>BLR</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_in(D,L_Disk)</td><td>BLR</td><td>cm</td><td>1.958309e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_out(D,R_BLR_in)</td><td>BLR</td><td>cm</td><td>2.154140e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>L_Disk(M)</td><td>Disk</td><td>erg / s</td><td>4.261082e+45</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>T_Disk</td><td>Disk</td><td>K</td><td>3.018434e+04</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5554635872-657504').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5554635872-657504').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p</span><span class="o">=</span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_22_0.png" src="../../../../_images/Jet_example_model_fit_EC_22_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">make_conical_jet</span><span class="p">(</span><span class="n">theta_open</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_H</span> <span class="n">to</span>  <span class="n">R</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">theta_open</span> <span class="n">to</span>  <span class="n">R</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span> <span class="s1">&#39;theta_open&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span>
<span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_open</span><span class="p">))</span><span class="o">*</span><span class="n">R_H</span>
<span class="n">setting</span> <span class="n">R_H</span> <span class="n">to</span> <span class="mf">8.695425919436543e+17</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">set_EC_dependencies</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_in</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_in</span> <span class="o">=</span>
<span class="mf">3E17</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_out</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_BLR_in&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_out</span> <span class="o">=</span>
<span class="n">R_BLR_in</span><span class="o">*</span><span class="mf">1.1</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_DT</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_DT</span> <span class="o">=</span>
<span class="mf">2E19</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">set_external_field_transf</span><span class="p">(</span><span class="s1">&#39;disk&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p</span><span class="o">=</span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">prefit_jet</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet_EC.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_26_0.png" src="../../../../_images/Jet_example_model_fit_EC_26_0.png" />
<p>The prefit model should works well for the synchrotron component, but
the EC one is a bit problematic. We can set as starting values a
slightly harder value of <code class="docutils literal notranslate"><span class="pre">p</span></code>, and a larger value of <code class="docutils literal notranslate"><span class="pre">gamma_break</span></code>
and <code class="docutils literal notranslate"><span class="pre">gmax</span></code>. We freeze some parameters, and we also set some
<code class="docutils literal notranslate"><span class="pre">fit_range</span></code> values. Setting fit_range can speed-up the fit convergence
but should be judged by the user each time according to the physics of
the particular source</p>
</section>
<section id="ec-model-fit">
<h2>EC model fit<a class="headerlink" href="#ec-model-fit" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please, read the introduction and the caveat <a class="reference internal" href="../../../model_fitting_intro.html#id1"><span class="std std-ref">for the frequentist model fitting</span></a> to understand the frequentist fitting workflow
see the <a class="reference internal" href="../composite_model/Composite_model.html#composite-models"><span class="std std-ref">Composite Models and depending pars</span></a> user guide for further information about the implementation of <a class="reference internal" href="../../../../api/jetset.model_manager.FitModel.html#jetset.model_manager.FitModel" title="jetset.model_manager.FitModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FitModel</span></code></a>, in particular for parameter setting</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.data_loader</span> <span class="kn">import</span> <span class="n">ObsData</span>
<span class="n">sed_data</span><span class="o">=</span><span class="n">ObsData</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;3C454_data.pkl&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">jetset.jet_model</span> <span class="kn">import</span> <span class="n">Jet</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.model_manager</span> <span class="kn">import</span>  <span class="n">FitModel</span>
<span class="n">jet</span><span class="o">=</span><span class="n">Jet</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet_EC.pkl&#39;</span><span class="p">)</span>
<span class="n">jet</span><span class="o">.</span><span class="n">set_gamma_grid_size</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">=</span><span class="n">FitModel</span><span class="p">(</span> <span class="n">jet</span><span class="o">=</span><span class="n">jet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;EC-best-fit-lsb&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">show_model_components</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_DT</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_DT</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_DT</span> <span class="o">=</span>
<span class="mf">2E19</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_BLR_in</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_in</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_in</span> <span class="o">=</span>
<span class="mf">3E17</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_BLR_in</span> <span class="n">to</span>  <span class="n">R_BLR_out</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_out</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_BLR_in&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_out</span> <span class="o">=</span>
<span class="n">R_BLR_in</span><span class="o">*</span><span class="mf">1.1</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_H</span> <span class="n">to</span>  <span class="n">R</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">theta_open</span> <span class="n">to</span>  <span class="n">R</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span> <span class="s1">&#39;theta_open&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span>
<span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_open</span><span class="p">))</span><span class="o">*</span><span class="n">R_H</span>

<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">Composite</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">EC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">lsb</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">composite_model</span>
<span class="n">components</span> <span class="n">models</span><span class="p">:</span>
 <span class="o">-</span><span class="n">model</span> <span class="n">name</span><span class="p">:</span> <span class="n">jet_leptonic</span> <span class="n">model</span> <span class="nb">type</span><span class="p">:</span> <span class="n">jet</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>

<span class="n">fit_model</span><span class="o">.</span><span class="n">free</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;R_H&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;tau_DT&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;tau_BLR&#39;</span><span class="p">)</span>

<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R_H</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">8E17</span><span class="p">,</span><span class="mf">5E19</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">T_Disk</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E4</span><span class="p">,</span><span class="mf">1E5</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">T_DT</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gamma_break</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmin</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmax</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E4</span><span class="p">,</span><span class="mf">1E5</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E-2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">2.5</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">p_1</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">theta_open</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">BulkFactor</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">ModelMinimizer</span>
<span class="n">model_minimizer_lsb</span><span class="o">=</span><span class="n">ModelMinimizer</span><span class="p">(</span><span class="s1">&#39;lsb&#39;</span><span class="p">)</span>
<span class="n">best_fit_lsb</span><span class="o">=</span><span class="n">model_minimizer_lsb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_model</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="mf">3E10</span><span class="p">,</span><span class="mf">1E29</span><span class="p">,</span><span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;EC-best-fit-lsb&#39;</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">filtering data in fit range = [3.000000e+10,1.000000e+29]
data length 24
================================================================================

<strong>* start fit process *</strong>
-----</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.71336e+02</span>

<span class="o">-------------------------------------------------------------------------</span>
<span class="n">Fit</span> <span class="n">report</span>

<span class="n">Model</span><span class="p">:</span> <span class="n">EC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">lsb</span>
</pre></div>
</div>
<i>Table length=22</i>
<table id="table5584434080-65376" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>6.675472e+00</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>1.581028e+04</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>5.485583e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>1.894755e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>LE_spectral_slope</td><td></td><td>1.588509e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.466529e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>T_DT</td><td>DT</td><td>K</td><td>4.502140e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R_DT(D,L_Disk)</td><td>DT</td><td>cm</td><td>1.305539e+19</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_DT</td><td>DT</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_BLR</td><td>BLR</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_in(D,L_Disk)</td><td>BLR</td><td>cm</td><td>1.958309e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_out(D,R_BLR_in)</td><td>BLR</td><td>cm</td><td>2.154140e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>L_Disk(M)</td><td>Disk</td><td>erg / s</td><td>4.261082e+45</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>T_Disk</td><td>Disk</td><td>K</td><td>2.991580e+04</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R(D,theta_open)</td><td>region_size</td><td>cm</td><td>9.134742e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>R_H(M)</td><td>region_position</td><td>cm</td><td>8.694991e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>9.141046e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta</td><td>jet-viewing-angle</td><td>deg</td><td>2.000000e+00</td><td>0.000000e+00</td><td>9.000000e+01</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>BulkFactor</td><td>jet-bulk-factor</td><td>lorentz-factor*</td><td>1.842049e+01</td><td>1.000000e+00</td><td>1.000000e+05</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>5.930000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta_open(M)</td><td>user_defined</td><td>deg</td><td>5.997353e+00</td><td>1.000000e+00</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5584434080-65376').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5584434080-65376').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="o">=</span><span class="kc">True</span>
<span class="n">calls</span><span class="o">=</span><span class="mi">633</span>
<span class="n">mesg</span><span class="o">=</span>
</pre></div>
</div>
<pre class="literal-block">'<cite>ftol</cite> termination condition is satisfied.'</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">12</span>
<span class="n">chisq</span><span class="o">=</span><span class="mf">171.335707</span><span class="p">,</span> <span class="n">chisq</span><span class="o">/</span><span class="n">red</span><span class="o">=</span><span class="mf">14.277976</span> <span class="n">null</span> <span class="n">hypothesis</span> <span class="n">sig</span><span class="o">=</span><span class="mf">0.000000</span>

<span class="n">best</span> <span class="n">fit</span> <span class="n">pars</span>
</pre></div>
</div>
<i>Table length=22</i>
<table id="table5594993216-572158" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>6.675472e+00</td><td>6.675472e+00</td><td>2.084490e+01</td><td>--</td><td>1.033091e+01</td><td>2.000000e+00</td><td>1.000000e+02</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>1.581028e+04</td><td>1.581028e+04</td><td>1.907208e+04</td><td>--</td><td>1.311585e+04</td><td>1.000000e+04</td><td>1.000000e+05</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>5.485583e+02</td><td>5.485583e+02</td><td>4.158130e+03</td><td>--</td><td>8.405479e+02</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>1.894755e+02</td><td>1.894755e+02</td><td>3.075634e+02</td><td>--</td><td>2.279937e+02</td><td>1.000000e+02</td><td>5.000000e+02</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>1.588509e+00</td><td>1.588509e+00</td><td>2.908949e+00</td><td>--</td><td>2.309926e+00</td><td>1.000000e+00</td><td>2.500000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>3.466529e+00</td><td>3.466529e+00</td><td>3.550985e-01</td><td>--</td><td>3.500000e+00</td><td>3.000000e+00</td><td>4.000000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>T_DT</td><td>4.502140e+02</td><td>4.502140e+02</td><td>3.219246e+03</td><td>--</td><td>1.000000e+02</td><td>1.000000e+02</td><td>1.000000e+03</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R_DT(D,L_Disk)</td><td>1.305539e+19</td><td>--</td><td>--</td><td>--</td><td>1.305539e+19</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_DT</td><td>1.000000e-01</td><td>--</td><td>--</td><td>--</td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_BLR</td><td>1.000000e-01</td><td>--</td><td>--</td><td>--</td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_in(D,L_Disk)</td><td>1.958309e+17</td><td>--</td><td>--</td><td>--</td><td>1.958309e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_out(D,R_BLR_in)</td><td>2.154140e+17</td><td>--</td><td>--</td><td>--</td><td>2.154140e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>L_Disk(M)</td><td>4.261082e+45</td><td>--</td><td>--</td><td>--</td><td>4.261082e+45</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>T_Disk</td><td>2.991580e+04</td><td>2.991580e+04</td><td>1.307071e+04</td><td>--</td><td>3.018434e+04</td><td>1.000000e+04</td><td>1.000000e+05</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R(D,theta_open)</td><td>9.134742e+16</td><td>--</td><td>--</td><td>--</td><td>7.607512e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>R_H(M)</td><td>8.694991e+17</td><td>8.694991e+17</td><td>6.630953e+16</td><td>--</td><td>8.695426e+17</td><td>8.000000e+17</td><td>5.000000e+19</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>9.141046e-02</td><td>9.141046e-02</td><td>2.996898e-02</td><td>--</td><td>1.500000e-01</td><td>1.000000e-02</td><td>1.000000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>1.000000e+00</td><td>--</td><td>--</td><td>--</td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta</td><td>2.000000e+00</td><td>--</td><td>--</td><td>--</td><td>2.000000e+00</td><td>0.000000e+00</td><td>9.000000e+01</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>BulkFactor</td><td>1.842049e+01</td><td>1.842049e+01</td><td>3.696853e+01</td><td>--</td><td>2.000000e+01</td><td>1.000000e+01</td><td>3.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>5.930000e-01</td><td>--</td><td>--</td><td>--</td><td>5.930000e-01</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta_open(M)</td><td>5.997353e+00</td><td>5.997353e+00</td><td>5.466490e+00</td><td>--</td><td>5.000000e+00</td><td>4.000000e+00</td><td>6.000000e+00</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5594993216-572158').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5594993216-572158').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-------------------------------------------------------------------------</span>

<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">model_minimizer_lsb</span><span class="o">.</span><span class="n">plot_corr_matrix</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_34_0.png" src="../../../../_images/Jet_example_model_fit_EC_34_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fit_model</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p2</span><span class="o">=</span><span class="n">fit_model</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">y_max</span><span class="o">=</span><span class="mf">1E-9</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_35_0.png" src="../../../../_images/Jet_example_model_fit_EC_35_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">ModelMinimizer</span>
<span class="n">model_minimizer_minuit</span><span class="o">=</span><span class="n">ModelMinimizer</span><span class="p">(</span><span class="s1">&#39;minuit&#39;</span><span class="p">)</span>
<span class="c1">#fit_model.freeze(&#39;jet_leptonic&#39;,&#39;theta_open&#39;)</span>
<span class="n">best_fit_minuit</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_model</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="mf">3E10</span><span class="p">,</span><span class="mf">1E29</span><span class="p">,</span><span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;EC-best-fit-minuit&#39;</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">filtering data in fit range = [3.000000e+10,1.000000e+29]
data length 24
================================================================================

<strong>* start fit process *</strong>
-----
fit run: 0</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====&gt;</span> <span class="n">simplex</span>
<span class="o">====&gt;</span> <span class="n">migrad</span>
<span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">3.21399e+01</span>

<span class="n">fit</span> <span class="n">run</span><span class="p">:</span> <span class="mi">1</span>
<span class="o">-</span> <span class="n">old</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">3.21399e+01</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====&gt;</span> <span class="n">simplex</span>
<span class="o">====&gt;</span> <span class="n">migrad</span>
<span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">3.16610e+01</span>

<span class="o">-------------------------------------------------------------------------</span>
<span class="n">Fit</span> <span class="n">report</span>

<span class="n">Model</span><span class="p">:</span> <span class="n">EC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">minuit</span>
</pre></div>
</div>
<i>Table length=22</i>
<table id="table5551469904-337574" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>3.893234e+00</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>8.993352e+04</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>9.909851e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>1.734853e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>LE_spectral_slope</td><td></td><td>1.274681e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.503112e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>T_DT</td><td>DT</td><td>K</td><td>5.893807e+02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R_DT(D,L_Disk)</td><td>DT</td><td>cm</td><td>1.305539e+19</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_DT</td><td>DT</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_BLR</td><td>BLR</td><td></td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_in(D,L_Disk)</td><td>BLR</td><td>cm</td><td>1.958309e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_out(D,R_BLR_in)</td><td>BLR</td><td>cm</td><td>2.154140e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>L_Disk(M)</td><td>Disk</td><td>erg / s</td><td>4.261082e+45</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>T_Disk</td><td>Disk</td><td>K</td><td>2.778004e+04</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R(D,theta_open)</td><td>region_size</td><td>cm</td><td>3.603492e+17</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>R_H(M)</td><td>region_position</td><td>cm</td><td>3.509696e+18</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>5.312839e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta</td><td>jet-viewing-angle</td><td>deg</td><td>2.000000e+00</td><td>0.000000e+00</td><td>9.000000e+01</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>BulkFactor</td><td>jet-bulk-factor</td><td>lorentz-factor*</td><td>1.000000e+01</td><td>1.000000e+00</td><td>1.000000e+05</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>5.930000e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta_open(M)</td><td>user_defined</td><td>deg</td><td>5.862158e+00</td><td>1.000000e+00</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5551469904-337574').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5551469904-337574').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="o">=</span><span class="kc">True</span>
<span class="n">calls</span><span class="o">=</span><span class="mi">1021</span>
<span class="n">mesg</span><span class="o">=</span>
</pre></div>
</div>
<table>
    <tr>
        <th colspan="5" style="text-align:center" title="Minimizer"> Migrad </th>
    </tr>
    <tr>
        <td colspan="2" style="text-align:left" title="Minimum value of function"> FCN = 31.66 </td>
        <td colspan="3" style="text-align:center" title="Total number of function and (optional) gradient evaluations"> Nfcn = 1021 </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:left" title="Estimated distance to minimum and goal"> EDM = 0.00019 (Goal: 0.0002) </td>
        <td colspan="3" style="text-align:center" title="Total run time of algorithms"> time = 31.7 sec </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:center;background-color:#92CCA6;color:black"> Valid Minimum </td>
        <td colspan="3" style="text-align:center;background-color:#FFF79A;color:black"> SOME Parameters at limit </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:center;background-color:#92CCA6;color:black"> Below EDM threshold (goal x 10) </td>
        <td colspan="3" style="text-align:center;background-color:#92CCA6;color:black"> Below call limit </td>
    </tr>
    <tr>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Covariance </td>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Hesse ok </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Is covariance matrix accurate?"> Accurate </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Is covariance matrix positive definite?"> Pos. def. </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Was positive definiteness enforced by Minuit?"> Not forced </td>
    </tr>
</table><table>
    <tr>
        <td></td>
        <th title="Variable name"> Name </th>
        <th title="Value of parameter"> Value </th>
        <th title="Hesse error"> Hesse Error </th>
        <th title="Minos lower error"> Minos Error- </th>
        <th title="Minos upper error"> Minos Error+ </th>
        <th title="Lower limit of the parameter"> Limit- </th>
        <th title="Upper limit of the parameter"> Limit+ </th>
        <th title="Is the parameter fixed in the fit"> Fixed </th>
    </tr>
    <tr>
        <th> 0 </th>
        <td> par_0 </td>
        <td> 3.89323 </td>
        <td> 0.00023 </td>
        <td>  </td>
        <td>  </td>
        <td> 2 </td>
        <td> 100 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 1 </th>
        <td> par_1 </td>
        <td> 89.93352e3 </td>
        <td> 0.00028e3 </td>
        <td>  </td>
        <td>  </td>
        <td> 1E+04 </td>
        <td> 1E+05 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 2 </th>
        <td> par_2 </td>
        <td> 99.0985 </td>
        <td> 0.0014 </td>
        <td>  </td>
        <td>  </td>
        <td> 0 </td>
        <td>  </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 3 </th>
        <td> par_3 </td>
        <td> 173.4853 </td>
        <td> 0.0017 </td>
        <td>  </td>
        <td>  </td>
        <td> 100 </td>
        <td> 500 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 4 </th>
        <td> par_4 </td>
        <td> 1.274681 </td>
        <td> 0.000007 </td>
        <td>  </td>
        <td>  </td>
        <td> 1 </td>
        <td> 2.5 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 5 </th>
        <td> par_5 </td>
        <td> 3.50311218 </td>
        <td> 0.00000004 </td>
        <td>  </td>
        <td>  </td>
        <td> 3 </td>
        <td> 4 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 6 </th>
        <td> par_6 </td>
        <td> 589 </td>
        <td> 14 </td>
        <td>  </td>
        <td>  </td>
        <td> 100 </td>
        <td> 1E+03 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 7 </th>
        <td> par_7 </td>
        <td> 27.8e3 </td>
        <td> 2.4e3 </td>
        <td>  </td>
        <td>  </td>
        <td> 1E+04 </td>
        <td> 1E+05 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 8 </th>
        <td> par_8 </td>
        <td> 3.50970e18 </td>
        <td> 0.00014e18 </td>
        <td>  </td>
        <td>  </td>
        <td> 8E+17 </td>
        <td> 5E+19 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 9 </th>
        <td> par_9 </td>
        <td> 53.1284e-3 </td>
        <td> 0.0027e-3 </td>
        <td>  </td>
        <td>  </td>
        <td> 0.01 </td>
        <td> 1 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 10 </th>
        <td> par_10 </td>
        <td> 10.0 </td>
        <td> 0.4 </td>
        <td>  </td>
        <td>  </td>
        <td> 10 </td>
        <td> 30 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 11 </th>
        <td> par_11 </td>
        <td> 5.862158 </td>
        <td> 0.000008 </td>
        <td>  </td>
        <td>  </td>
        <td> 4 </td>
        <td> 6 </td>
        <td>  </td>
    </tr>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">12</span>
<span class="n">chisq</span><span class="o">=</span><span class="mf">31.661039</span><span class="p">,</span> <span class="n">chisq</span><span class="o">/</span><span class="n">red</span><span class="o">=</span><span class="mf">2.638420</span> <span class="n">null</span> <span class="n">hypothesis</span> <span class="n">sig</span><span class="o">=</span><span class="mf">0.001561</span>

<span class="n">best</span> <span class="n">fit</span> <span class="n">pars</span>
</pre></div>
</div>
<i>Table length=22</i>
<table id="table5594999360-794602" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>3.893234e+00</td><td>3.893234e+00</td><td>2.336607e-04</td><td>--</td><td>6.675472e+00</td><td>2.000000e+00</td><td>1.000000e+02</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>8.993352e+04</td><td>8.993352e+04</td><td>2.756248e-01</td><td>--</td><td>1.581028e+04</td><td>1.000000e+04</td><td>1.000000e+05</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>9.909851e+01</td><td>9.909851e+01</td><td>1.397515e-03</td><td>--</td><td>5.485583e+02</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>1.734853e+02</td><td>1.734853e+02</td><td>1.658699e-03</td><td>--</td><td>1.894755e+02</td><td>1.000000e+02</td><td>5.000000e+02</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>1.274681e+00</td><td>1.274681e+00</td><td>6.788564e-06</td><td>--</td><td>1.588509e+00</td><td>1.000000e+00</td><td>2.500000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>3.503112e+00</td><td>3.503112e+00</td><td>3.994333e-08</td><td>--</td><td>3.466529e+00</td><td>3.000000e+00</td><td>4.000000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>T_DT</td><td>5.893807e+02</td><td>5.893807e+02</td><td>1.422676e+01</td><td>--</td><td>4.502140e+02</td><td>1.000000e+02</td><td>1.000000e+03</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R_DT(D,L_Disk)</td><td>1.305539e+19</td><td>--</td><td>--</td><td>--</td><td>1.305539e+19</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_DT</td><td>1.000000e-01</td><td>--</td><td>--</td><td>--</td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>tau_BLR</td><td>1.000000e-01</td><td>--</td><td>--</td><td>--</td><td>1.000000e-01</td><td>0.000000e+00</td><td>1.000000e+00</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_in(D,L_Disk)</td><td>1.958309e+17</td><td>--</td><td>--</td><td>--</td><td>1.958309e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>*R_BLR_out(D,R_BLR_in)</td><td>2.154140e+17</td><td>--</td><td>--</td><td>--</td><td>2.154140e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>L_Disk(M)</td><td>4.261082e+45</td><td>--</td><td>--</td><td>--</td><td>4.261082e+45</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>T_Disk</td><td>2.778004e+04</td><td>2.778004e+04</td><td>2.427427e+03</td><td>--</td><td>2.991580e+04</td><td>1.000000e+04</td><td>1.000000e+05</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>*R(D,theta_open)</td><td>3.603492e+17</td><td>--</td><td>--</td><td>--</td><td>9.134742e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>R_H(M)</td><td>3.509696e+18</td><td>3.509696e+18</td><td>1.379374e+14</td><td>--</td><td>8.694991e+17</td><td>8.000000e+17</td><td>5.000000e+19</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>5.312839e-02</td><td>5.312839e-02</td><td>2.726890e-06</td><td>--</td><td>9.141046e-02</td><td>1.000000e-02</td><td>1.000000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>1.000000e+00</td><td>--</td><td>--</td><td>--</td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta</td><td>2.000000e+00</td><td>--</td><td>--</td><td>--</td><td>2.000000e+00</td><td>0.000000e+00</td><td>9.000000e+01</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>BulkFactor</td><td>1.000000e+01</td><td>1.000000e+01</td><td>3.890289e-01</td><td>--</td><td>1.842049e+01</td><td>1.000000e+01</td><td>3.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>5.930000e-01</td><td>--</td><td>--</td><td>--</td><td>5.930000e-01</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>theta_open(M)</td><td>5.862158e+00</td><td>5.862158e+00</td><td>8.085871e-06</td><td>--</td><td>5.997353e+00</td><td>4.000000e+00</td><td>6.000000e+00</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5594999360-794602').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5594999360-794602').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-------------------------------------------------------------------------</span>

<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">plot_corr_matrix</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_37_0.png" src="../../../../_images/Jet_example_model_fit_EC_37_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fit_model</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p2</span><span class="o">=</span><span class="n">fit_model</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">y_max</span><span class="o">=</span><span class="mf">1E-9</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_38_0.png" src="../../../../_images/Jet_example_model_fit_EC_38_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jet</span><span class="o">.</span><span class="n">energetic_report</span><span class="p">()</span>
</pre></div>
</div>
<i>Table length=39</i>
<table id="table5595844896-295890" class="table-striped table-bordered table-condensed">
<thead><tr><th>name</th><th>type</th><th>units</th><th>val</th></tr></thead>
<tr><td>BulkLorentzFactor</td><td>jet-bulk-factor</td><td></td><td>1.000000e+01</td></tr>
<tr><td>U_e</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>3.869527e-03</td></tr>
<tr><td>U_p_cold</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>1.489725e-01</td></tr>
<tr><td>U_B</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>1.123087e-04</td></tr>
<tr><td>U_Synch</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>9.582487e-06</td></tr>
<tr><td>U_Synch_DRF</td><td>Energy dens. disk rest. frame</td><td>erg / cm3</td><td>9.614802e-01</td></tr>
<tr><td>U_Disk</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>2.827817e-06</td></tr>
<tr><td>U_BLR</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>2.188308e-07</td></tr>
<tr><td>U_DT</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>1.331679e-03</td></tr>
<tr><td>U_CMB</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>0.000000e+00</td></tr>
<tr><td>U_Star</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>0.000000e+00</td></tr>
<tr><td>U_Disk_DRF</td><td>Energy dens. disk rest. frame</td><td>erg / cm3</td><td>9.199862e-04</td></tr>
<tr><td>U_BLR_DRF</td><td>Energy dens. disk rest. frame</td><td>erg / cm3</td><td>5.115778e-05</td></tr>
<tr><td>U_DT_DRF</td><td>Energy dens. disk rest. frame</td><td>erg / cm3</td><td>6.675126e-06</td></tr>
<tr><td>U_CMB_DRF</td><td>Energy dens. disk rest. frame</td><td>erg / cm3</td><td>0.000000e+00</td></tr>
<tr><td>U_Star_DRF</td><td>Energy dens. disk rest. frame</td><td>erg / cm3</td><td>0.000000e+00</td></tr>
<tr><td>U_seed_tot</td><td>Energy dens. blob rest. frame</td><td>erg / cm3</td><td>1.344308e-03</td></tr>
<tr><td>L_Sync_rf</td><td>Lum. blob rest. frame.</td><td>erg / s</td><td>4.687658e+41</td></tr>
<tr><td>L_SSC_rf</td><td>Lum. blob rest. frame.</td><td>erg / s</td><td>1.279464e+41</td></tr>
<tr><td>L_EC_Disk_rf</td><td>Lum. blob rest. frame.</td><td>erg / s</td><td>0.000000e+00</td></tr>
<tr><td>L_EC_BLR_rf</td><td>Lum. blob rest. frame.</td><td>erg / s</td><td>1.203063e+39</td></tr>
<tr><td>L_EC_DT_rf</td><td>Lum. blob rest. frame.</td><td>erg / s</td><td>6.871948e+42</td></tr>
<tr><td>L_EC_CMB_rf</td><td>Lum. blob rest. frame.</td><td>erg / s</td><td>0.000000e+00</td></tr>
<tr><td>L_EC_Star_rf</td><td>Lum. blob rest. frame.</td><td>erg / s</td><td>0.000000e+00</td></tr>
<tr><td>jet_L_Sync</td><td>jet Lum.</td><td>erg / s</td><td>1.166040e+43</td></tr>
<tr><td>jet_L_SSC</td><td>jet Lum.</td><td>erg / s</td><td>3.182626e+42</td></tr>
<tr><td>jet_L_EC_Disk</td><td>jet Lum.</td><td>erg / s</td><td>0.000000e+00</td></tr>
<tr><td>jet_L_EC_BLR</td><td>jet Lum.</td><td>erg / s</td><td>2.992582e+40</td></tr>
<tr><td>jet_L_EC_Star</td><td>jet Lum.</td><td>erg / s</td><td>0.000000e+00</td></tr>
<tr><td>jet_L_EC_DT</td><td>jet Lum.</td><td>erg / s</td><td>1.709376e+44</td></tr>
<tr><td>jet_L_EC_CMB</td><td>jet Lum.</td><td>erg / s</td><td>0.000000e+00</td></tr>
<tr><td>jet_L_pp_gamma</td><td>jet Lum.</td><td>erg / s</td><td>0.000000e+00</td></tr>
<tr><td>jet_L_rad</td><td>jet Lum.</td><td>erg / s</td><td>1.858105e+44</td></tr>
<tr><td>jet_L_kin</td><td>jet Lum.</td><td>erg / s</td><td>1.859850e+47</td></tr>
<tr><td>jet_L_tot</td><td>jet Lum.</td><td>erg / s</td><td>1.863075e+47</td></tr>
<tr><td>jet_L_e</td><td>jet Lum.</td><td>erg / s</td><td>4.708616e+45</td></tr>
<tr><td>jet_L_B</td><td>jet Lum.</td><td>erg / s</td><td>1.366623e+44</td></tr>
<tr><td>jet_L_p_cold</td><td>jet Lum.</td><td>erg / s</td><td>1.812764e+47</td></tr>
<tr><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5595844896-295890').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5595844896-295890').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [3], type: "optionalnum"}]
    });
});
</script><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_fit_minuit</span><span class="o">.</span><span class="n">save_report</span><span class="p">(</span><span class="s1">&#39;EC-best-fit-minuit.pkl&#39;</span><span class="p">)</span>
<span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;EC_model_minimizer_minuit.pkl&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;EC_fit_model_minuit.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="mcmc">
<h2>MCMC<a class="headerlink" href="#mcmc" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please, read the introduction and the caveat <a class="reference internal" href="../../../model_fitting_intro.html#bayesian-model-fitting"><span class="std std-ref">for the Bayesian model fitting</span></a> to understand the MCMC sampler workflow.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.mcmc</span> <span class="kn">import</span> <span class="n">McmcSampler</span>
<span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">ModelMinimizer</span>
<span class="n">model_minimizer_minuit</span> <span class="o">=</span> <span class="n">ModelMinimizer</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;EC_model_minimizer_minuit.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_DT</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_DT</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_DT</span> <span class="o">=</span>
<span class="mf">2E19</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_BLR_in</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_in</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_in</span> <span class="o">=</span>
<span class="mf">3E17</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_BLR_in</span> <span class="n">to</span>  <span class="n">R_BLR_out</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_out</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_BLR_in&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_out</span> <span class="o">=</span>
<span class="n">R_BLR_in</span><span class="o">*</span><span class="mf">1.1</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_H</span> <span class="n">to</span>  <span class="n">R</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">theta_open</span> <span class="n">to</span>  <span class="n">R</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span> <span class="s1">&#39;theta_open&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span>
<span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_open</span><span class="p">))</span><span class="o">*</span><span class="n">R_H</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">=</span><span class="n">McmcSampler</span><span class="p">(</span><span class="n">model_minimizer_minuit</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;BulkFactor&#39;</span><span class="p">,</span><span class="s1">&#39;p_1&#39;</span><span class="p">,</span><span class="s1">&#39;gamma_break&#39;</span><span class="p">]</span>
<span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;jet_leptonic&#39;</span>
<span class="n">use_labels_dict</span><span class="o">=</span><span class="p">{</span><span class="n">model_name</span><span class="p">:</span><span class="n">labels</span><span class="p">}</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_labels</span><span class="p">(</span><span class="n">use_labels_dict</span><span class="o">=</span><span class="n">use_labels_dict</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">bound_rel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par</span><span class="p">:</span> <span class="n">N</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">109.64687686370732</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">657.881261182244</span><span class="p">]</span>
<span class="n">par</span><span class="p">:</span> <span class="n">B</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">0.05025286584056864</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.30151719504341185</span><span class="p">]</span>
<span class="n">par</span><span class="p">:</span> <span class="n">BulkFactor</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">10.000000488240653</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="n">par</span><span class="p">:</span> <span class="n">p_1</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">3.5156351521693128</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">par</span><span class="p">:</span> <span class="n">gamma_break</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">139.69119783722982</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">run_sampler</span><span class="p">(</span><span class="n">nwalkers</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">steps</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">progress</span><span class="o">=</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_DT</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_DT</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_DT</span> <span class="o">=</span>
<span class="mf">2E19</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_BLR_in</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_in</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_in</span> <span class="o">=</span>
<span class="mf">3E17</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_BLR_in</span> <span class="n">to</span>  <span class="n">R_BLR_out</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_out</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_BLR_in&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_out</span> <span class="o">=</span>
<span class="n">R_BLR_in</span><span class="o">*</span><span class="mf">1.1</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_H</span> <span class="n">to</span>  <span class="n">R</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">theta_open</span> <span class="n">to</span>  <span class="n">R</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span> <span class="s1">&#39;theta_open&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span>
<span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_open</span><span class="p">))</span><span class="o">*</span><span class="n">R_H</span>
<span class="n">mcmc</span> <span class="n">run</span> <span class="n">starting</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0%|          | 0/500 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span> <span class="n">run</span> <span class="n">done</span><span class="p">,</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">threads</span> <span class="n">took</span> <span class="mf">393.33</span> <span class="n">seconds</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mcmc</span><span class="o">.</span><span class="n">acceptance_fraction</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.5046</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="n">p</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">3E10</span><span class="p">,</span> <span class="mf">1E27</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-13</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_49_0.png" src="../../../../_images/Jet_example_model_fit_EC_49_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">3E10</span><span class="p">,</span> <span class="mf">1E27</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-13</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_50_0.png" src="../../../../_images/Jet_example_model_fit_EC_50_0.png" />
<p>To have a better rendering on the scatter plot, we redefine the plot
labels</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">labels</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;BulkFactor&#39;</span><span class="p">,</span> <span class="s1">&#39;p_1&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma_break&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$N$&#39;</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$B$&#39;</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;BulkFactor&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\Gamma$&#39;</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;p_1&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$p_1$&#39;</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;gamma_break&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\gamma_{\rm break}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>the code below lets you tuning the output</p>
<ol class="arabic simple">
<li><p>mpl.rcParams[‘figure.dpi’] if you increase it you get a better
definition</p></li>
<li><p>title_fmt=“.2E” this is the format for python, 2 significant digits,
scientific notation</p></li>
<li><p>title_kwargs=dict(fontsize=12) you can change the fontsize</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">corner_plot</span><span class="p">(</span><span class="n">quantiles</span><span class="o">=</span><span class="p">(</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">),</span><span class="n">title_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span><span class="n">title_fmt</span><span class="o">=</span><span class="s2">&quot;.2E&quot;</span><span class="p">,</span><span class="n">use_math_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_55_0.png" src="../../../../_images/Jet_example_model_fit_EC_55_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_chain</span><span class="p">(</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_56_0.png" src="../../../../_images/Jet_example_model_fit_EC_56_0.png" />
</section>
<section id="save-and-reuse-mcmc">
<h2>Save and reuse MCMC<a class="headerlink" href="#save-and-reuse-mcmc" title="Link to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;mcmc_sampler.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.mcmc</span> <span class="kn">import</span> <span class="n">McmcSampler</span>
<span class="kn">from</span> <span class="nn">jetset.data_loader</span> <span class="kn">import</span> <span class="n">ObsData</span>
<span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="kn">import</span> <span class="n">PlotSED</span>
<span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="kn">import</span>  <span class="n">test_SEDs</span>

<span class="n">sed_data</span><span class="o">=</span><span class="n">ObsData</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;3C454_data.pkl&#39;</span><span class="p">)</span>

<span class="n">ms</span><span class="o">=</span><span class="n">McmcSampler</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;mcmc_sampler.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_DT</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_DT</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_DT</span> <span class="o">=</span>
<span class="mf">2E19</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_BLR_in</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_in</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_in</span> <span class="o">=</span>
<span class="mf">3E17</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_BLR_in</span> <span class="n">to</span>  <span class="n">R_BLR_out</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_out</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_BLR_in&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_out</span> <span class="o">=</span>
<span class="n">R_BLR_in</span><span class="o">*</span><span class="mf">1.1</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_H</span> <span class="n">to</span>  <span class="n">R</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">theta_open</span> <span class="n">to</span>  <span class="n">R</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span> <span class="s1">&#39;theta_open&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span>
<span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_open</span><span class="p">))</span><span class="o">*</span><span class="n">R_H</span>
<span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_DT</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_DT</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_DT</span> <span class="o">=</span>
<span class="mf">2E19</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">L_Disk</span> <span class="n">to</span>  <span class="n">R_BLR_in</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_in</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;L_Disk&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_in</span> <span class="o">=</span>
<span class="mf">3E17</span><span class="o">*</span><span class="p">(</span><span class="n">L_Disk</span><span class="o">/</span><span class="mf">1E46</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_BLR_in</span> <span class="n">to</span>  <span class="n">R_BLR_out</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R_BLR_out</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_BLR_in&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R_BLR_out</span> <span class="o">=</span>
<span class="n">R_BLR_in</span><span class="o">*</span><span class="mf">1.1</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">R_H</span> <span class="n">to</span>  <span class="n">R</span>
<span class="n">adding</span> <span class="n">par</span><span class="p">:</span> <span class="n">theta_open</span> <span class="n">to</span>  <span class="n">R</span>
<span class="o">==&gt;</span> <span class="n">par</span> <span class="n">R</span> <span class="ow">is</span> <span class="n">depending</span> <span class="n">on</span> <span class="p">[</span><span class="s1">&#39;R_H&#39;</span><span class="p">,</span> <span class="s1">&#39;theta_open&#39;</span><span class="p">]</span> <span class="n">according</span> <span class="n">to</span> <span class="n">expr</span><span class="p">:</span>   <span class="n">R</span> <span class="o">=</span>
<span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_open</span><span class="p">))</span><span class="o">*</span><span class="n">R_H</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ms</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="n">p</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">3E10</span><span class="p">,</span> <span class="mf">1E27</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-13</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_60_0.png" src="../../../../_images/Jet_example_model_fit_EC_60_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">3E10</span><span class="p">,</span> <span class="mf">1E27</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-13</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_61_0.png" src="../../../../_images/Jet_example_model_fit_EC_61_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_par</span><span class="p">(</span><span class="s1">&#39;p_1&#39;</span><span class="p">,</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/Jet_example_model_fit_EC_62_0.png" src="../../../../_images/Jet_example_model_fit_EC_62_0.png" />
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../model_fit_2/Jet_example_model_fit_wiht_gal_template.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Model fitting 2: SSC + galaxy template</p>
      </div>
    </a>
    <a class="right-next"
       href="../model_fit_4/Jet_example_only_synchrotron.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Model fitting 4: Only Synchrotron</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-data">Loading data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phenomenological-model-constraining">Phenomenological model constraining</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ec-model-fit">EC model fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcmc">MCMC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-reuse-mcmc">Save and reuse MCMC</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2019, andrea tramacere.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>