<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Model fitting 1: Only SSC &#8212; jetset  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/my_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Model fitting 2: SSC + galaxy template" href="../model_fit_2/Jet_example_model_fit_wiht_gal_template.html" />
    <link rel="prev" title="model fitting" href="../../model_fitting.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js "></script>

  </head><body>
  
  <a href=" https://github.com/andreatramacere/jetset"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><span><img src="../../../_static/logo_small_color_neg_transparent.png"></span>
          JetSeT doc</a>
        <span class="navbar-text navbar-version pull-left"><b>1.2.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">JetSeT <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#windows-10-prerequisites">Windows 10 prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-jetset-from-anaconda">Install  JetSeT from Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-jetset-from-pip">Install  JetSeT from pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-the-jetset-from-source">Install the JetSeT from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#introduction-of-depending-pars">Introduction of depending pars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#temporal-evolution">Temporal Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#hadronic-pp-emission">Hadronic pp emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#theoretical-background-for-ssc-model">Theoretical background for SSC model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#emitters-distributions">Emitters distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#ebl-absorption">EBL absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#plugins">Plugins</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user_guide.html">user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../model_basic.html">model basic features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_advanced.html">model advanced features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../model_fitting.html">model fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html">plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/analytical_model.html">analytical_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/base_model.html">base_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/convert_qdp.html">convert_qdp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/cosmo_tools.html">cosmo_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/data_loader.html">data_loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/frame_converter.html">frame_converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/gammapy_plugin.html">gammapy_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters.html">jet_emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters_factory.html">jet_emitters_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_model.html">jet_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_paramters.html">jet_paramters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_spectral_components.html">jet_spectral_components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_timedep.html">jet_timedep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_tools.html">jet_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jetkernel_models_dic.html">jetkernel_models_dic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/loglog_poly_model.html">loglog_poly_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mathkernel_helper.html">mathkernel_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mcmc.html">mcmc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/minimizer.html">minimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mock.html">mock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_manager.html">model_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_parameters.html">model_parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/obs_constrain.html">obs_constrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/output.html">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/plot_sedfit.html">plot_sedfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit.html">poly_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit_tools.html">poly_fit_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sed_shaper.html">sed_shaper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sherpa_plugin.html">sherpa_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/spectral_shapes.html">spectral_shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_2Dmodel.html">template_2Dmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_model.html">template_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/test_data_helper.html">test_data_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-linked-paramters-for-ebl">Example: linked paramters for EBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-pars-for-bkn-power-law-emitters">Example: depending pars for bkn power-law emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-building-a-jet-model-with-b-function-of-r-h-and-r-0">Example depending par: Building a Jet model with B function of R_H and R_0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-fitting-with-a-jet-model-with-depending-pars">Example depending par: fitting with a Jet model with depending pars</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#combine-a-jet-model-with-the-ebl-model-multiplicative-case">Combine a Jet model with the EBL model (Multiplicative case)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#setting-parameters">Setting parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#sum-of-two-jets-steady-and-flaring-and-application-of-the-ebl-absorption-to-both-multiplicative-and-additive">Sum of two jets (steady and flaring) and application of the EBL absorption to both (Multiplicative and additive)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#passing-the-custom-distribution-to-the-jet-class">Passing the custom distribution to the Jet class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#building-a-distribution-from-an-external-array">Building a distribution from an external array</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#basic-setup">Basic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-parameters">Setting the parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#investigating-the-electron-distribution">Investigating the electron distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#evaluate-and-plot-the-model">Evaluate and plot the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#comparing-models-on-the-same-plot">Comparing models on the same plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-a-plot">Saving a plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-and-loading-a-model">Saving and loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switching-on-off-the-particle-distribution-normalization">Switching on/off the particle distribution normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-particle-density-from-observed-fluxes-or-luminosities">Setting the particle density from observed Fluxes or Luminosities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-beaming-factor-and-expression">Setting the beaming factor and expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switch-on-off-synchrotron-sefl-absorption-and-ic-emission">Switch ON/OFF Synchrotron sefl-absorption and IC emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#accessing-individual-spectral-components">Accessing individual spectral components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#energetic-report">Energetic report</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Hadronic pp jet model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html#jet-pp-consistency-with-kelner-2006">Jet pp Consistency with Kelner 2006</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html">Temporal evolution, one zone, only cooling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html#cooling-only-the-newly-injecting-electrons">Cooling only the newly injecting electrons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling.html">Temporal evolution, two zones, cooling+acc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html">Temporal evolution, two zones, cooling+acc+adb exp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html#expanding-the-radiative-region">Expanding the radiative region</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#synchrotron-trends-full-computation-and-delta-approx-comparison">Synchrotron trends: full computation and <span class="math notranslate nohighlight">\(\delta\)</span>-approx comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#trends-for-the-inverse-compton-and-synchrotron-emission">Trends for the inverse Compton and synchrotron emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the Sherpa plugin with the sherpa interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#model-fitting-with-using-a-sherpa-model">Model fitting with using a Sherpa model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the Sherpa minimizer plugin with a JeSeT model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#model-fitting-with-sherpa">Model fitting with Sherpa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html">Example to use the Gamma-py plugin with the JeSeT interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html#importing-a-jetset-model-into-gammapy">Importing a jetset model into gammapy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html#model-fitting-with-gammapy">Model fitting with gammapy</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Model fitting 1: Only SSC</a><ul>
<li><a class="reference internal" href="#loading-data">Loading data</a></li>
<li><a class="reference internal" href="#phenomenological-model-constraining">phenomenological model constraining</a><ul>
<li><a class="reference internal" href="#spectral-indices">spectral indices</a></li>
<li><a class="reference internal" href="#sed-shaper">sed shaper</a></li>
<li><a class="reference internal" href="#model-constraining">Model constraining</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-fitting-procedure">Model fitting procedure</a><ul>
<li><a class="reference internal" href="#model-fitting-with-lsb">Model fitting with LSB</a></li>
<li><a class="reference internal" href="#freezeing-parameters-and-setting-fit-range-intervals">Freezeing parameters and setting fit_range intervals</a></li>
<li><a class="reference internal" href="#building-the-modelminimizer-object">Building the ModelMinimizer object</a></li>
</ul>
</li>
<li><a class="reference internal" href="#saving-fit-model-model-minimizer">saving fit model, model minimizer</a></li>
<li><a class="reference internal" href="#model-fitting-with-minuit">Model fitting with Minuit</a></li>
<li><a class="reference internal" href="#mcmc-sampling">MCMC sampling</a></li>
<li><a class="reference internal" href="#save-and-reuse-mcmc">Save and reuse MCMC</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../../model_fitting.html" title="Previous Chapter: model fitting"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; model fitting</span>
    </a>
  </li>
  <li>
    <a href="../model_fit_2/Jet_example_model_fit_wiht_gal_template.html" title="Next Chapter: Model fitting 2: SSC + galaxy template"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Model fitting... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../../_sources/user_guide/documentation_notebooks/model_fit_1/Jet_example_model_fit.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><!--
<ul class="globaltoc"
><p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#windows-10-prerequisites">Windows 10 prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-jetset-from-anaconda">Install  JetSeT from Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-jetset-from-pip">Install  JetSeT from pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install.html#install-the-jetset-from-source">Install the JetSeT from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#introduction-of-depending-pars">Introduction of depending pars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#temporal-evolution">Temporal Evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#hadronic-pp-emission">Hadronic pp emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#theoretical-background-for-ssc-model">Theoretical background for SSC model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#emitters-distributions">Emitters distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#ebl-absorption">EBL absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../new_release.html#plugins">Plugins</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user_guide.html">user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../model_basic.html">model basic features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_advanced.html">model advanced features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../model_fitting.html">model fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html">plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/analytical_model.html">analytical_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/base_model.html">base_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/convert_qdp.html">convert_qdp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/cosmo_tools.html">cosmo_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/data_loader.html">data_loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/frame_converter.html">frame_converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/gammapy_plugin.html">gammapy_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters.html">jet_emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_emitters_factory.html">jet_emitters_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_model.html">jet_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_paramters.html">jet_paramters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_spectral_components.html">jet_spectral_components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_timedep.html">jet_timedep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jet_tools.html">jet_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jetkernel_models_dic.html">jetkernel_models_dic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/loglog_poly_model.html">loglog_poly_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mathkernel_helper.html">mathkernel_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mcmc.html">mcmc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/minimizer.html">minimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mock.html">mock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_manager.html">model_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/model_parameters.html">model_parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/obs_constrain.html">obs_constrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/output.html">output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/plot_sedfit.html">plot_sedfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit.html">poly_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/poly_fit_tools.html">poly_fit_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sed_shaper.html">sed_shaper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/sherpa_plugin.html">sherpa_plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/spectral_shapes.html">spectral_shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_2Dmodel.html">template_2Dmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/template_model.html">template_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/test_data_helper.html">test_data_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-linked-paramters-for-ebl">Example: linked paramters for EBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-pars-for-bkn-power-law-emitters">Example: depending pars for bkn power-law emitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-building-a-jet-model-with-b-function-of-r-h-and-r-0">Example depending par: Building a Jet model with B function of R_H and R_0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../depending_pars/depending_pars.html#example-depending-par-fitting-with-a-jet-model-with-depending-pars">Example depending par: fitting with a Jet model with depending pars</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#combine-a-jet-model-with-the-ebl-model-multiplicative-case">Combine a Jet model with the EBL model (Multiplicative case)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#setting-parameters">Setting parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../composite_model/Composite_model.html#sum-of-two-jets-steady-and-flaring-and-application-of-the-ebl-absorption-to-both-multiplicative-and-additive">Sum of two jets (steady and flaring) and application of the EBL absorption to both (Multiplicative and additive)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#passing-the-custom-distribution-to-the-jet-class">Passing the custom distribution to the Jet class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html#building-a-distribution-from-an-external-array">Building a distribution from an external array</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#basic-setup">Basic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-parameters">Setting the parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#investigating-the-electron-distribution">Investigating the electron distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#evaluate-and-plot-the-model">Evaluate and plot the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#comparing-models-on-the-same-plot">Comparing models on the same plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-a-plot">Saving a plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#saving-and-loading-a-model">Saving and loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switching-on-off-the-particle-distribution-normalization">Switching on/off the particle distribution normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-particle-density-from-observed-fluxes-or-luminosities">Setting the particle density from observed Fluxes or Luminosities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#setting-the-beaming-factor-and-expression">Setting the beaming factor and expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#switch-on-off-synchrotron-sefl-absorption-and-ic-emission">Switch ON/OFF Synchrotron sefl-absorption and IC emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#accessing-individual-spectral-components">Accessing individual spectral components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html#energetic-report">Energetic report</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Hadronic pp jet model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html#jet-pp-consistency-with-kelner-2006">Jet pp Consistency with Kelner 2006</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html">Temporal evolution, one zone, only cooling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html#cooling-only-the-newly-injecting-electrons">Cooling only the newly injecting electrons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling.html">Temporal evolution, two zones, cooling+acc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html">Temporal evolution, two zones, cooling+acc+adb exp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html#expanding-the-radiative-region">Expanding the radiative region</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#synchrotron-trends-full-computation-and-delta-approx-comparison">Synchrotron trends: full computation and <span class="math notranslate nohighlight">\(\delta\)</span>-approx comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#trends-for-the-inverse-compton-and-synchrotron-emission">Trends for the inverse Compton and synchrotron emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the Sherpa plugin with the sherpa interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html#model-fitting-with-using-a-sherpa-model">Model fitting with using a Sherpa model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the Sherpa minimizer plugin with a JeSeT model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#loading-data">Loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#phenomenological-model-constraining">phenomenological model constraining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html#model-fitting-with-sherpa">Model fitting with Sherpa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html">Example to use the Gamma-py plugin with the JeSeT interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html#importing-a-jetset-model-into-gammapy">Importing a jetset model into gammapy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html#model-fitting-with-gammapy">Model fitting with gammapy</a></li>
</ul>
</li>
</ul>
</ul>
//-->


<html style="height:100%">
    <body style="height:100%">
      <div class="sidebar-block">
        <div class="sidebar-wrapper">
          <h2></h2>
        </div>
        <div class="sidebar-toc">

          
          
            <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">what's new in jetset 1.2.0</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user_guide.html">user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../model_basic.html">model basic features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_advanced.html">model advanced features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../model_fitting.html">model fitting</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#"> model fitting  1: SSC model fit, minuit contours, and MCMC for Mrk 421</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_fit_2/Jet_example_model_fit_wiht_gal_template.html"> model fitting  2: SSC (jet+galaxy template) model fit and MCMC for Mrk 501</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_fit_3/Jet_example_model_fit_EC.html"> model fitting  3: SSC and EC fit for 3C 454.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_fit_4/Jet_example_only_synchrotron.html"> model fitting  4: Only Synchroton for Mrk 421 fit, minuit contours, and MCMC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html"> model fitting  5: Mrk 521 SSC+EBL with Sherpa plugin and jetset interface  *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html"> model fitting  6: Mrk 521 SSC+EBL with Sherpa plugin and Sherpa interface  *New (v1.2.0)*</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html">plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">New/updated in v1.2.0:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadornic.html">Hadronic pp jet model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html">Temporal evolution, one zone, only cooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling.html">Temporal evolution, two zones, cooling+acc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html">Temporal evolution, two zones, cooling+acc+adb exp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the Sherpa plugin with the sherpa interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the Sherpa minimizer plugin with a JeSeT model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html">Example to use the Gamma-py plugin with the JeSeT interface</a></li>
</ul>

          

        </div>

      </div>
    </body>
</html>
<div id="sourcelink">
  <a href="../../../_sources/user_guide/documentation_notebooks/model_fit_1/Jet_example_model_fit.rst.txt"
     rel="nofollow">Source</a>
</div>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <section id="model-fitting-1-only-ssc">
<span id="model-fitting-1"></span><h1>Model fitting 1: Only SSC<a class="headerlink" href="#model-fitting-1-only-ssc" title="Permalink to this headline">¶</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">jetset</span>
<span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="kn">import</span>  <span class="n">test_SEDs</span>
<span class="kn">from</span> <span class="nn">jetset.data_loader</span> <span class="kn">import</span> <span class="n">ObsData</span><span class="p">,</span><span class="n">Data</span>
<span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="kn">import</span> <span class="n">PlotSED</span>
<span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="kn">import</span>  <span class="n">test_SEDs</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">jetset</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.2.0</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_SEDs</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;/Users/orion/anaconda3/envs/jetset/lib/python3.8/site-packages/jetset/test_data/SEDs_data/SED_3C345.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/anaconda3/envs/jetset/lib/python3.8/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk421_EBL_DEABS.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/anaconda3/envs/jetset/lib/python3.8/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk501_EBL_ABS.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/anaconda3/envs/jetset/lib/python3.8/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk501_EBL_DEABS.ecsv&#39;</span><span class="p">]</span>
</pre></div>
</div>
<section id="loading-data">
<h2>Loading data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h2>
<p>see the <span class="xref std std-ref">data_format</span> user guide for further information about loading data</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">test_SEDs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">test_SEDs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">orion</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">jetset</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">jetset</span><span class="o">/</span><span class="n">test_data</span><span class="o">/</span><span class="n">SEDs_data</span><span class="o">/</span><span class="n">SED_MW_Mrk421_EBL_DEABS</span><span class="o">.</span><span class="n">ecsv</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">sed_data</span><span class="o">=</span><span class="n">ObsData</span><span class="p">(</span><span class="n">data_table</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">sed_data</span><span class="o">.</span><span class="n">group_data</span><span class="p">(</span><span class="n">bin_width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">sed_data</span><span class="o">.</span><span class="n">add_systematics</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,[</span><span class="mf">10.</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mf">10.</span><span class="o">**</span><span class="mi">29</span><span class="p">])</span>
<span class="n">p</span><span class="o">=</span><span class="n">sed_data</span><span class="o">.</span><span class="n">plot_sed</span><span class="p">()</span>
<span class="c1">#p.setlim(y_min=1E-15,x_min=1E7,x_max=1E29)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>*  binning data  *</strong>
---&gt; N bins= 89
---&gt; bin_widht= 0.2
================================================================================</pre>
<img alt="../../../_images/Jet_example_model_fit_8_1.png" src="../../../_images/Jet_example_model_fit_8_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sed_data</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;Mrk_401.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="phenomenological-model-constraining">
<h2>phenomenological model constraining<a class="headerlink" href="#phenomenological-model-constraining" title="Permalink to this headline">¶</a></h2>
<p>see the <a class="reference internal" href="../phen_constr/Jet_example_phenom_constr.html#phenom-constr"><span class="std std-ref">Phenomenological model constraining: application</span></a> user guide for further information about phenomenological constraining</p>
<section id="spectral-indices">
<h3>spectral indices<a class="headerlink" href="#spectral-indices" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.sed_shaper</span> <span class="kn">import</span>  <span class="n">SEDShape</span>
<span class="n">my_shape</span><span class="o">=</span><span class="n">SEDShape</span><span class="p">(</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">my_shape</span><span class="o">.</span><span class="n">eval_indices</span><span class="p">(</span><span class="n">minimizer</span><span class="o">=</span><span class="s1">&#39;lsb&#39;</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">plot_indices</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">,</span><span class="n">y_max</span><span class="o">=</span><span class="mf">5E-8</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* evaluating spectral indices for data *</strong>
================================================================================</pre>
<img alt="../../../_images/Jet_example_model_fit_13_1.png" src="../../../_images/Jet_example_model_fit_13_1.png" />
</section>
<section id="sed-shaper">
<h3>sed shaper<a class="headerlink" href="#sed-shaper" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mm</span><span class="p">,</span><span class="n">best_fit</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">sync_fit</span><span class="p">(</span><span class="n">check_host_gal_template</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">Ep_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">minimizer</span><span class="o">=</span><span class="s1">&#39;lsb&#39;</span><span class="p">,</span>
                  <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">10.</span><span class="p">,</span><span class="mf">21.</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* Log-Polynomial fitting of the synchrotron component *</strong>
---&gt; first blind fit run,  fit range: [10.0, 21.0]
---&gt; class:  HSP</pre>
<i>Table length=4</i>
<table id="table140451270153648-512299" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>LogCubic</td><td>b</td><td>-1.545300e-01</td><td>-1.545300e-01</td><td>9.534795e-03</td><td>--</td><td>-1.000000e+00</td><td>-1.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
<tr><td>LogCubic</td><td>c</td><td>-1.023245e-02</td><td>-1.023245e-02</td><td>1.433073e-03</td><td>--</td><td>-1.000000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Ep</td><td>1.672267e+01</td><td>1.672267e+01</td><td>4.139942e-02</td><td>--</td><td>1.667039e+01</td><td>0.000000e+00</td><td>3.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Sp</td><td>-9.491659e+00</td><td>-9.491659e+00</td><td>2.515285e-02</td><td>--</td><td>-1.000000e+01</td><td>-3.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451270153648-512299').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451270153648-512299').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---&gt;</span> <span class="n">sync</span>       <span class="n">nu_p</span><span class="o">=+</span><span class="mf">1.672267e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">4.139942e-02</span><span class="p">)</span>  <span class="n">nuFnu_p</span><span class="o">=-</span><span class="mf">9.491659e+00</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">2.515285e-02</span><span class="p">)</span> <span class="n">curv</span><span class="o">.=-</span><span class="mf">1.545300e-01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">9.534795e-03</span><span class="p">)</span>
<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_shape</span><span class="o">.</span><span class="n">IC_fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">23.</span><span class="p">,</span><span class="mf">29.</span><span class="p">],</span><span class="n">minimizer</span><span class="o">=</span><span class="s1">&#39;minuit&#39;</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">plot_shape_fit</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">,</span><span class="n">y_max</span><span class="o">=</span><span class="mf">5E-8</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* Log-Polynomial fitting of the IC component *</strong>
---&gt; fit range: [23.0, 29.0]
---&gt; LogCubic fit</pre>
<i>Table length=4</i>
<table id="table140451270589456-986985" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>LogCubic</td><td>b</td><td>-2.098186e-01</td><td>-2.098186e-01</td><td>3.133032e-02</td><td>--</td><td>-1.000000e+00</td><td>-1.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
<tr><td>LogCubic</td><td>c</td><td>-4.661868e-02</td><td>-4.661868e-02</td><td>2.178352e-02</td><td>--</td><td>-1.000000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Ep</td><td>2.524926e+01</td><td>2.524926e+01</td><td>1.147759e-01</td><td>--</td><td>2.529412e+01</td><td>0.000000e+00</td><td>3.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Sp</td><td>-1.011085e+01</td><td>-1.011085e+01</td><td>3.498963e-02</td><td>--</td><td>-1.000000e+01</td><td>-3.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451270589456-986985').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451270589456-986985').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---&gt;</span> <span class="n">IC</span>         <span class="n">nu_p</span><span class="o">=+</span><span class="mf">2.524926e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">1.147759e-01</span><span class="p">)</span>  <span class="n">nuFnu_p</span><span class="o">=-</span><span class="mf">1.011085e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">3.498963e-02</span><span class="p">)</span> <span class="n">curv</span><span class="o">.=-</span><span class="mf">2.098186e-01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">3.133032e-02</span><span class="p">)</span>
<span class="o">================================================================================</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_16_3.png" src="../../../_images/Jet_example_model_fit_16_3.png" />
</section>
<section id="model-constraining">
<h3>Model constraining<a class="headerlink" href="#model-constraining" title="Permalink to this headline">¶</a></h3>
<p>In this step we are not fitting the model, we are just obtaining the
phenomenological <code class="docutils literal notranslate"><span class="pre">pre_fit</span></code> model, that will be fitted in using minuit
ore least-square bound, as shown below</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.obs_constrain</span> <span class="kn">import</span> <span class="n">ObsConstrain</span>
<span class="kn">from</span> <span class="nn">jetset.model_manager</span> <span class="kn">import</span>  <span class="n">FitModel</span>
<span class="n">sed_obspar</span><span class="o">=</span><span class="n">ObsConstrain</span><span class="p">(</span><span class="n">beaming</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                        <span class="n">B_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
                        <span class="n">distr_e</span><span class="o">=</span><span class="s1">&#39;lppl&#39;</span><span class="p">,</span>
                        <span class="n">t_var_sec</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mi">86400</span><span class="p">,</span>
                        <span class="n">nu_cut_IR</span><span class="o">=</span><span class="mf">1E12</span><span class="p">,</span>
                        <span class="n">SEDShape</span><span class="o">=</span><span class="n">my_shape</span><span class="p">)</span>


<span class="n">prefit_jet</span><span class="o">=</span><span class="n">sed_obspar</span><span class="o">.</span><span class="n">constrain_SSC_model</span><span class="p">(</span><span class="n">electron_distribution_log_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">prefit_jet</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>*  constrains parameters from observable *</strong></pre>
<i>Table length=11</i>
<table id="table140451207059632-497397" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>3.112712e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>5.050000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td>lorentz-factor*</td><td>2.500000e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.080000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>4.697542e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>1.373160e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>9.060842e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>3.188500e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.181578e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>7.726502e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451207059632-497397').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451207059632-497397').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">pl</span><span class="o">=</span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">add_residual_plot</span><span class="p">(</span><span class="n">prefit_jet</span><span class="p">,</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E7</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">1E29</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_20_0.png" src="../../../_images/Jet_example_model_fit_20_0.png" />
</section>
</section>
<section id="model-fitting-procedure">
<h2>Model fitting procedure<a class="headerlink" href="#model-fitting-procedure" title="Permalink to this headline">¶</a></h2>
<p>We remind that we can use different <code class="docutils literal notranslate"><span class="pre">minimizers</span></code> for the model fitting. In the following we will use the <code class="docutils literal notranslate"><span class="pre">minuit</span></code> minimizer and the <code class="docutils literal notranslate"><span class="pre">lsb</span></code> (least square bound scipy minimizer). Using <code class="docutils literal notranslate"><span class="pre">minuit</span></code> we notice that sometimes the fit will converge, but the quality  will not be enough (<code class="docutils literal notranslate"><span class="pre">valid==false</span></code>) to run <code class="docutils literal notranslate"><span class="pre">minos</span></code>. Anyhow, as shown in the <a class="reference internal" href="../model_fit_4/Jet_example_only_synchrotron.html#mcmc-sampling"><span class="std std-ref">MCMC sampling</span></a>, it still possible to estimate asymmetric errors by means of MCMC sampling</p>
<p>We freeze some parameters, and we also set some <cite>fit_range</cite> values. Setting fit_range can speed-up the fit convergence but should be judged by the user each time according to the physics of the particular source.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">minuit</span></code> the best strategy is to set the <cite>fit_range</cite> for most of the free parameters</p>
<p>A good strategy is to run first a <cite>lsb</cite> fit and then, using the same <cite>fit_model</cite>, run a fit with <cite>minuit</cite></p>
<section id="model-fitting-with-lsb">
<h3>Model fitting with LSB<a class="headerlink" href="#model-fitting-with-lsb" title="Permalink to this headline">¶</a></h3>
<p>see the <a class="reference internal" href="../composite_model/Composite_model.html#composite-models"><span class="std std-ref">Composite Models and depending pars</span></a> user guide for further information about the new implementation of <cite>FitModel</cite>, in particular for parameter setting</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">fit_SED</span><span class="p">,</span><span class="n">ModelMinimizer</span>

<span class="kn">from</span> <span class="nn">jetset.model_manager</span> <span class="kn">import</span>  <span class="n">FitModel</span>
<span class="kn">from</span> <span class="nn">jetset.jet_model</span> <span class="kn">import</span> <span class="n">Jet</span>
</pre></div>
</div>
<p>if you want to fit the <code class="docutils literal notranslate"><span class="pre">prefit_model</span></code> you can load the saved one (this
allows you to save time) ad pass it to the <code class="docutils literal notranslate"><span class="pre">FitModel</span></code> class</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefit_jet</span><span class="o">=</span><span class="n">Jet</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet.pkl&#39;</span><span class="p">)</span>
<span class="n">fit_model_lsb</span><span class="o">=</span><span class="n">FitModel</span><span class="p">(</span> <span class="n">jet</span><span class="o">=</span><span class="n">prefit_jet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-lsb&#39;</span><span class="p">,</span><span class="n">template</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<i>Table length=11</i>
<table id="table140451265095136-88247" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>4.697542e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>1.373160e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>9.060842e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>3.188500e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.181578e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>7.726502e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>3.112712e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>5.050000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td>lorentz-factor*</td><td>2.500000e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.080000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451265095136-88247').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451265095136-88247').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><p>OR use the one generated above</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model_lsb</span><span class="o">=</span><span class="n">FitModel</span><span class="p">(</span> <span class="n">jet</span><span class="o">=</span><span class="n">prefit_jet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-lsb&#39;</span><span class="p">,</span><span class="n">template</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">show_model_components</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="n">Composite</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">lsb</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">composite_model</span>
<span class="n">components</span> <span class="n">models</span><span class="p">:</span>
 <span class="o">-</span><span class="n">model</span> <span class="n">name</span><span class="p">:</span> <span class="n">jet_leptonic</span> <span class="n">model</span> <span class="nb">type</span><span class="p">:</span> <span class="n">jet</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<p>There is only one component, whit name <code class="docutils literal notranslate"><span class="pre">jet_leptonic</span></code>, that refers to
the <code class="docutils literal notranslate"><span class="pre">prefit_jet</span></code> model component</p>
<p>We now set the gamma grid size to 200, ad we set <code class="docutils literal notranslate"><span class="pre">composite_expr</span></code>,
anyhow, since we have only one component this step could be skipped</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">set_gamma_grid_size</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">composite_expr</span><span class="o">=</span><span class="s1">&#39;jet_leptonic&#39;</span>
</pre></div>
</div>
</section>
<section id="freezeing-parameters-and-setting-fit-range-intervals">
<h3>Freezeing parameters and setting fit_range intervals<a class="headerlink" href="#freezeing-parameters-and-setting-fit-range-intervals" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the new implementation of composite model  (<cite>FitModel</cite> class) to set parameters you have to specify the model component, this is different from versions&lt;1.1.2,
and this holds also for the <cite>freeze</cite> method and for setting  <cite>fit_range</cite> intervals, and for the methods relate to parameters setting in general.
See the <a class="reference internal" href="../composite_model/Composite_model.html#composite-models"><span class="std std-ref">Composite Models and depending pars</span></a> user guide for further information about the new implementation of <cite>FitModel</cite>, in particular for parameter setting</p>
</div>
<p>These methods are alternative and equivalent ways to access a model
component for setting parameters state and values</p>
<ol class="loweralpha simple">
<li><p>passing as first argument, of the method, the model component
<code class="docutils literal notranslate"><span class="pre">name</span></code></p></li>
<li><p>passing as first argument, of the method, the model component
<code class="docutils literal notranslate"><span class="pre">object</span></code></p></li>
<li><p>accessing the model component member of the composite model class</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#a</span>
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">)</span>
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;R_H&#39;</span><span class="p">)</span>
<span class="c1">#b</span>
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="n">prefit_jet</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="c1">#c</span>
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="o">**</span><span class="mf">15.5</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mf">17.5</span><span class="p">]</span>
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">beam_obj</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="building-the-modelminimizer-object">
<h3>Building the ModelMinimizer object<a class="headerlink" href="#building-the-modelminimizer-object" title="Permalink to this headline">¶</a></h3>
<p>Now we build a <code class="docutils literal notranslate"><span class="pre">lsb</span></code> model minimizer and run the fit method</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>starting from version 1.1.2 the <cite>fit</cite> method allows to repeat the fit process, setting the parameter <cite>repeat</cite>. This will provide a better fit convergence.
Setting <cite>repeat=3</cite> the fit process will be repeated 3 times</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_minimizer_lsb</span><span class="o">=</span><span class="n">ModelMinimizer</span><span class="p">(</span><span class="s1">&#39;lsb&#39;</span><span class="p">)</span>
<span class="n">best_fit_lsb</span><span class="o">=</span><span class="n">model_minimizer_lsb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_model_lsb</span><span class="p">,</span>
                                     <span class="n">sed_data</span><span class="p">,</span>
                                     <span class="mf">1E11</span><span class="p">,</span>
                                     <span class="mf">1E29</span><span class="p">,</span>
                                     <span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-minuit&#39;</span><span class="p">,</span>
                                     <span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">filtering data in fit range = [1.000000e+11,1.000000e+29]
data length 35
================================================================================

<strong>* start fit process *</strong>
-----
fit run: 0</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">5.32182e+01</span>

<span class="n">fit</span> <span class="n">run</span><span class="p">:</span> <span class="mi">1</span>
<span class="o">-</span> <span class="n">old</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">5.32182e+01</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">5.22603e+01</span>

<span class="n">fit</span> <span class="n">run</span><span class="p">:</span> <span class="mi">2</span>
<span class="o">-</span> <span class="n">old</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">5.22603e+01</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">5.09003e+01</span>

<span class="o">-------------------------------------------------------------------------</span>
<span class="n">Fit</span> <span class="n">report</span>

<span class="n">Model</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">minuit</span>
</pre></div>
</div>
<i>Table length=11</i>
<table id="table140451271109936-94784" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>4.778915e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>9.191687e+05</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>9.085652e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>4.337114e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.184444e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>7.644091e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>3.112712e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>5.027056e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td>lorentz-factor*</td><td>2.334793e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.080000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451271109936-94784').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451271109936-94784').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="o">=</span><span class="kc">True</span>
<span class="n">calls</span><span class="o">=</span><span class="mi">63</span>
<span class="n">mesg</span><span class="o">=</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;The relative error between two consecutive iterates is at most 0.000000&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">27</span>
<span class="n">chisq</span><span class="o">=</span><span class="mf">50.900346</span><span class="p">,</span> <span class="n">chisq</span><span class="o">/</span><span class="n">red</span><span class="o">=</span><span class="mf">1.885198</span> <span class="n">null</span> <span class="n">hypothesis</span> <span class="n">sig</span><span class="o">=</span><span class="mf">0.003576</span>

<span class="n">best</span> <span class="n">fit</span> <span class="n">pars</span>
</pre></div>
</div>
<i>Table length=11</i>
<table id="table140451271178992-573281" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>4.778915e+02</td><td>4.778915e+02</td><td>2.699848e+02</td><td>--</td><td>4.697542e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>9.191687e+05</td><td>9.191687e+05</td><td>1.495007e+05</td><td>--</td><td>1.373160e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>9.085652e-01</td><td>9.085652e-01</td><td>3.950026e-01</td><td>--</td><td>9.060842e-01</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>4.337114e+04</td><td>4.337114e+04</td><td>2.937759e+04</td><td>--</td><td>3.188500e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>2.184444e+00</td><td>2.184444e+00</td><td>1.390250e-01</td><td>--</td><td>2.181578e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>7.644091e-01</td><td>7.644091e-01</td><td>2.758032e-01</td><td>--</td><td>7.726502e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>3.112712e+16</td><td>--</td><td>--</td><td>--</td><td>3.112712e+16</td><td>3.162278e+15</td><td>3.162278e+17</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>1.000000e+17</td><td>--</td><td>--</td><td>--</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>5.027056e-02</td><td>5.027056e-02</td><td>1.208011e-02</td><td>--</td><td>5.050000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>2.334793e+01</td><td>2.334793e+01</td><td>3.239464e+00</td><td>--</td><td>2.500000e+01</td><td>5.000000e+00</td><td>5.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>3.080000e-02</td><td>--</td><td>--</td><td>--</td><td>3.080000e-02</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451271178992-573281').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451271178992-573281').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-------------------------------------------------------------------------</span>

<span class="o">================================================================================</span>
</pre></div>
</div>
<p>we can obtain the best fit astropy table</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_fit_lsb</span><span class="o">.</span><span class="n">bestfit_table</span>
</pre></div>
</div>
<i>Table length=11</i>
<table id="table140451270230992" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<thead><tr><th>str12</th><th>str16</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>bool</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>4.778915e+02</td><td>4.778915e+02</td><td>2.699848e+02</td><td>--</td><td>4.697542e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>9.191687e+05</td><td>9.191687e+05</td><td>1.495007e+05</td><td>--</td><td>1.373160e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>9.085652e-01</td><td>9.085652e-01</td><td>3.950026e-01</td><td>--</td><td>9.060842e-01</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>4.337114e+04</td><td>4.337114e+04</td><td>2.937759e+04</td><td>--</td><td>3.188500e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>2.184444e+00</td><td>2.184444e+00</td><td>1.390250e-01</td><td>--</td><td>2.181578e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>7.644091e-01</td><td>7.644091e-01</td><td>2.758032e-01</td><td>--</td><td>7.726502e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>3.112712e+16</td><td>--</td><td>--</td><td>--</td><td>3.112712e+16</td><td>3.162278e+15</td><td>3.162278e+17</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>1.000000e+17</td><td>--</td><td>--</td><td>--</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>5.027056e-02</td><td>5.027056e-02</td><td>1.208011e-02</td><td>--</td><td>5.050000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>2.334793e+01</td><td>2.334793e+01</td><td>3.239464e+00</td><td>--</td><td>2.500000e+01</td><td>5.000000e+00</td><td>5.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>3.080000e-02</td><td>--</td><td>--</td><td>--</td><td>3.080000e-02</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
</table></section>
</section>
<section id="saving-fit-model-model-minimizer">
<h2>saving fit model, model minimizer<a class="headerlink" href="#saving-fit-model-model-minimizer" title="Permalink to this headline">¶</a></h2>
<p>We can save all the fit products to be used later.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_fit_lsb</span><span class="o">.</span><span class="n">mesg</span><span class="o">=</span><span class="kc">None</span>
<span class="n">best_fit_lsb</span><span class="o">.</span><span class="n">save_report</span><span class="p">(</span><span class="s1">&#39;SSC-best-fit-lsb.pkl&#39;</span><span class="p">)</span>
<span class="n">model_minimizer_lsb</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;model_minimizer_lsb.pkl&#39;</span><span class="p">)</span>
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;fit_model_lsb.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p2</span><span class="o">=</span><span class="n">fit_model_lsb</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_48_0.png" src="../../../_images/Jet_example_model_fit_48_0.png" />
</section>
<section id="model-fitting-with-minuit">
<h2>Model fitting with Minuit<a class="headerlink" href="#model-fitting-with-minuit" title="Permalink to this headline">¶</a></h2>
<p>To run the <code class="docutils literal notranslate"><span class="pre">minuit</span></code> minimizer we will use the best-fit results from
<code class="docutils literal notranslate"><span class="pre">lsb</span></code> to set the boundaries for our parameters.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">fit_SED</span><span class="p">,</span><span class="n">ModelMinimizer</span>
<span class="kn">from</span> <span class="nn">jetset.model_manager</span> <span class="kn">import</span>  <span class="n">FitModel</span>
<span class="kn">from</span> <span class="nn">jetset.jet_model</span> <span class="kn">import</span> <span class="n">Jet</span>

<span class="n">jet_minuit</span><span class="o">=</span><span class="n">Jet</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet.pkl&#39;</span><span class="p">)</span>
<span class="n">jet_minuit</span><span class="o">.</span><span class="n">set_gamma_grid_size</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="c1">#fit_model_minuit=fit_model_lsb</span>
<span class="n">fit_model_minuit</span><span class="o">=</span><span class="n">FitModel</span><span class="p">(</span> <span class="n">jet</span><span class="o">=</span><span class="n">jet_minuit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-minuit&#39;</span><span class="p">,</span><span class="n">template</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<i>Table length=11</i>
<table id="table140451202276944-188910" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>4.697542e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>1.373160e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>9.060842e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>3.188500e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.181578e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>7.726502e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>3.112712e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>5.050000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td>lorentz-factor*</td><td>2.500000e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.080000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451202276944-188910').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451202276944-188910').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">show_model_components</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="n">Composite</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">minuit</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">composite_model</span>
<span class="n">components</span> <span class="n">models</span><span class="p">:</span>
 <span class="o">-</span><span class="n">model</span> <span class="n">name</span><span class="p">:</span> <span class="n">jet_leptonic</span> <span class="n">model</span> <span class="nb">type</span><span class="p">:</span> <span class="n">jet</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">)</span>
<span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;R_H&#39;</span><span class="p">)</span>
<span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">5E15</span><span class="p">,</span><span class="mf">1E17</span><span class="p">]</span>
<span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmin</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
<span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmax</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">5E5</span><span class="p">,</span><span class="mf">1E7</span><span class="p">]</span>
<span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gamma0_log_parab</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E3</span><span class="p">,</span><span class="mf">1E5</span><span class="p">]</span>

<span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">beam_obj</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_minimizer_minuit</span><span class="o">=</span><span class="n">ModelMinimizer</span><span class="p">(</span><span class="s1">&#39;minuit&#39;</span><span class="p">)</span>
<span class="n">best_fit_minuit</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_model_minuit</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mf">11.</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mf">29.0</span><span class="p">,</span><span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-minuit&#39;</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">filtering data in fit range = [1.000000e+11,1.000000e+29]
data length 35
================================================================================

<strong>* start fit process *</strong>
-----
fit run: 0</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">4.33705e+01</span>

<span class="n">fit</span> <span class="n">run</span><span class="p">:</span> <span class="mi">1</span>
<span class="o">-</span> <span class="n">old</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">4.33705e+01</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">3.11482e+01</span>

<span class="o">-------------------------------------------------------------------------</span>
<span class="n">Fit</span> <span class="n">report</span>

<span class="n">Model</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">minuit</span>
</pre></div>
</div>
<i>Table length=11</i>
<table id="table140451265612960-987176" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>4.688283e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>9.028968e+05</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>7.917986e-01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>3.238465e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.090996e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>6.854517e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>3.046194e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>5.214133e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td>lorentz-factor*</td><td>2.249661e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.080000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451265612960-987176').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451265612960-987176').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="o">=</span><span class="kc">True</span>
<span class="n">calls</span><span class="o">=</span><span class="mi">2284</span>
<span class="n">mesg</span><span class="o">=</span>
</pre></div>
</div>
<table>
    <tr>
        <td colspan="2" style="text-align:left" title="Minimum value of function"> FCN = 31.15 </td>
        <td colspan="3" style="text-align:center" title="No. of function evaluations in last call and total number"> Nfcn = 2284 </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:left" title="Estimated distance to minimum and goal"> EDM = 3.17e+06 (Goal: 0.0002) </td>
        <td colspan="3" style="text-align:center" title="No. of gradient evaluations in last call and total number">  </td>
    </tr>
    <tr>
        <td style="text-align:center;background-color:#c15ef7;color:black"> INVALID Minimum </td>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Valid Parameters </td>
        <td colspan="3" style="text-align:center;background-color:#FFF79A;color:black"> SOME Parameters at limit </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:center;background-color:#c15ef7;color:black"> ABOVE EDM threshold (goal x 10) </td>
        <td colspan="3" style="text-align:center;background-color:#92CCA6;color:black"> Below call limit </td>
    </tr>
    <tr>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Covariance </td>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Hesse ok </td>
        <td style="text-align:center;background-color:#FFF79A;color:black" title="Is covariance matrix accurate?"> APPROXIMATE </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Is covariance matrix positive definite?"> Pos. def. </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Was positive definiteness enforced by Minuit?"> Not forced </td>
    </tr>
</table><table>
    <tr>
        <td></td>
        <th title="Variable name"> Name </th>
        <th title="Value of parameter"> Value </th>
        <th title="Hesse error"> Hesse Error </th>
        <th title="Minos lower error"> Minos Error- </th>
        <th title="Minos upper error"> Minos Error+ </th>
        <th title="Lower limit of the parameter"> Limit- </th>
        <th title="Upper limit of the parameter"> Limit+ </th>
        <th title="Is the parameter fixed in the fit"> Fixed </th>
    </tr>
    <tr>
        <th> 0 </th>
        <td> par_0 </td>
        <td> 0.47e3 </td>
        <td> 0.29e3 </td>
        <td>  </td>
        <td>  </td>
        <td> 10 </td>
        <td> 1E+03 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 1 </th>
        <td> par_1 </td>
        <td> 0.9e6 </td>
        <td> 2.0e6 </td>
        <td>  </td>
        <td>  </td>
        <td> 5E+05 </td>
        <td> 1E+07 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 2 </th>
        <td> par_2 </td>
        <td> 0.8 </td>
        <td> 0.8 </td>
        <td>  </td>
        <td>  </td>
        <td> 0 </td>
        <td>  </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 3 </th>
        <td> par_3 </td>
        <td> 0.03e6 </td>
        <td> 0.04e6 </td>
        <td>  </td>
        <td>  </td>
        <td> 1E+03 </td>
        <td> 1E+05 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 4 </th>
        <td> par_4 </td>
        <td> 2 </td>
        <td> 8 </td>
        <td>  </td>
        <td>  </td>
        <td> -10 </td>
        <td> 10 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 5 </th>
        <td> par_5 </td>
        <td> 1 </td>
        <td> 12 </td>
        <td>  </td>
        <td>  </td>
        <td> -15 </td>
        <td> 15 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 6 </th>
        <td> par_6 </td>
        <td> 0.030e18 </td>
        <td> 0.035e18 </td>
        <td>  </td>
        <td>  </td>
        <td> 5E+15 </td>
        <td> 1E+17 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 7 </th>
        <td> par_7 </td>
        <td> 0.1 </td>
        <td> 0.4 </td>
        <td>  </td>
        <td>  </td>
        <td> 0 </td>
        <td>  </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 8 </th>
        <td> par_8 </td>
        <td> 22 </td>
        <td> 18 </td>
        <td>  </td>
        <td>  </td>
        <td> 5 </td>
        <td> 50 </td>
        <td>  </td>
    </tr>
</table><table>
    <tr>
        <td></td>
        <th> par_0 </th>
        <th> par_1 </th>
        <th> par_2 </th>
        <th> par_3 </th>
        <th> par_4 </th>
        <th> par_5 </th>
        <th> par_6 </th>
        <th> par_7 </th>
        <th> par_8 </th>
    </tr>
    <tr>
        <th> par_0 </th>
        <td> 9.3e+04 </td>
        <td style="background-color:rgb(250,226,226);color:black"> 9.24e+07 <strong>(0.160)</strong> </td>
        <td style="background-color:rgb(239,239,250);color:black"> -21 <strong>(-0.083)</strong> </td>
        <td style="background-color:rgb(213,213,250);color:black"> -3.93e+06 <strong>(-0.287)</strong> </td>
        <td style="background-color:rgb(250,151,151);color:black"> 1.75e+03 <strong>(0.661)</strong> </td>
        <td style="background-color:rgb(250,220,220);color:black"> 906 <strong>(0.201)</strong> </td>
        <td style="background-color:rgb(250,229,229);color:black"> 1.8e+18 <strong>(0.141)</strong> </td>
        <td style="background-color:rgb(250,200,200);color:black"> 30.6 <strong>(0.333)</strong> </td>
        <td style="background-color:rgb(246,246,250);color:black"> -220 <strong>(-0.033)</strong> </td>
    </tr>
    <tr>
        <th> par_1 </th>
        <td style="background-color:rgb(250,226,226);color:black"> 9.24e+07 <strong>(0.160)</strong> </td>
        <td> 3.61e+12 </td>
        <td style="background-color:rgb(250,249,249);color:black"> 1.29e+04 <strong>(0.008)</strong> </td>
        <td style="background-color:rgb(250,246,246);color:black"> 2.41e+09 <strong>(0.028)</strong> </td>
        <td style="background-color:rgb(242,242,250);color:black"> -1.07e+06 <strong>(-0.065)</strong> </td>
        <td style="background-color:rgb(247,247,250);color:black"> -5.55e+05 <strong>(-0.020)</strong> </td>
        <td style="background-color:rgb(248,248,250);color:black"> -1.1e+21 <strong>(-0.014)</strong> </td>
        <td style="background-color:rgb(246,246,250);color:black"> -1.87e+04 <strong>(-0.033)</strong> </td>
        <td style="background-color:rgb(250,250,250);color:black"> 1.35e+05 <strong>(0.003)</strong> </td>
    </tr>
    <tr>
        <th> par_2 </th>
        <td style="background-color:rgb(239,239,250);color:black"> -21 <strong>(-0.083)</strong> </td>
        <td style="background-color:rgb(250,249,249);color:black"> 1.29e+04 <strong>(0.008)</strong> </td>
        <td> 0.686 </td>
        <td style="background-color:rgb(248,248,250);color:black"> -548 <strong>(-0.015)</strong> </td>
        <td style="background-color:rgb(250,245,245);color:black"> 0.244 <strong>(0.034)</strong> </td>
        <td style="background-color:rgb(250,248,248);color:black"> 0.126 <strong>(0.010)</strong> </td>
        <td style="background-color:rgb(250,249,249);color:black"> 2.5e+14 <strong>(0.007)</strong> </td>
        <td style="background-color:rgb(250,247,247);color:black"> 0.00426 <strong>(0.017)</strong> </td>
        <td style="background-color:rgb(250,250,250);color:black"> -0.0307 <strong>(-0.002)</strong> </td>
    </tr>
    <tr>
        <th> par_3 </th>
        <td style="background-color:rgb(213,213,250);color:black"> -3.93e+06 <strong>(-0.287)</strong> </td>
        <td style="background-color:rgb(250,246,246);color:black"> 2.41e+09 <strong>(0.028)</strong> </td>
        <td style="background-color:rgb(248,248,250);color:black"> -548 <strong>(-0.015)</strong> </td>
        <td> 2.02e+09 </td>
        <td style="background-color:rgb(250,232,232);color:black"> 4.56e+04 <strong>(0.117)</strong> </td>
        <td style="background-color:rgb(250,245,245);color:black"> 2.36e+04 <strong>(0.036)</strong> </td>
        <td style="background-color:rgb(250,246,246);color:black"> 4.69e+19 <strong>(0.025)</strong> </td>
        <td style="background-color:rgb(250,241,241);color:black"> 797 <strong>(0.059)</strong> </td>
        <td style="background-color:rgb(249,249,250);color:black"> -5.75e+03 <strong>(-0.006)</strong> </td>
    </tr>
    <tr>
        <th> par_4 </th>
        <td style="background-color:rgb(250,151,151);color:black"> 1.75e+03 <strong>(0.661)</strong> </td>
        <td style="background-color:rgb(242,242,250);color:black"> -1.07e+06 <strong>(-0.065)</strong> </td>
        <td style="background-color:rgb(250,245,245);color:black"> 0.244 <strong>(0.034)</strong> </td>
        <td style="background-color:rgb(250,232,232);color:black"> 4.56e+04 <strong>(0.117)</strong> </td>
        <td> 75.3 </td>
        <td style="background-color:rgb(239,239,250);color:black"> -10.5 <strong>(-0.082)</strong> </td>
        <td style="background-color:rgb(243,243,250);color:black"> -2.09e+16 <strong>(-0.058)</strong> </td>
        <td style="background-color:rgb(232,232,250);color:black"> -0.355 <strong>(-0.136)</strong> </td>
        <td style="background-color:rgb(250,248,248);color:black"> 2.56 <strong>(0.013)</strong> </td>
    </tr>
    <tr>
        <th> par_5 </th>
        <td style="background-color:rgb(250,220,220);color:black"> 906 <strong>(0.201)</strong> </td>
        <td style="background-color:rgb(247,247,250);color:black"> -5.55e+05 <strong>(-0.020)</strong> </td>
        <td style="background-color:rgb(250,248,248);color:black"> 0.126 <strong>(0.010)</strong> </td>
        <td style="background-color:rgb(250,245,245);color:black"> 2.36e+04 <strong>(0.036)</strong> </td>
        <td style="background-color:rgb(239,239,250);color:black"> -10.5 <strong>(-0.082)</strong> </td>
        <td> 219 </td>
        <td style="background-color:rgb(248,248,250);color:black"> -1.08e+16 <strong>(-0.017)</strong> </td>
        <td style="background-color:rgb(245,245,250);color:black"> -0.184 <strong>(-0.041)</strong> </td>
        <td style="background-color:rgb(250,249,249);color:black"> 1.32 <strong>(0.004)</strong> </td>
    </tr>
    <tr>
        <th> par_6 </th>
        <td style="background-color:rgb(250,229,229);color:black"> 1.8e+18 <strong>(0.141)</strong> </td>
        <td style="background-color:rgb(248,248,250);color:black"> -1.1e+21 <strong>(-0.014)</strong> </td>
        <td style="background-color:rgb(250,249,249);color:black"> 2.5e+14 <strong>(0.007)</strong> </td>
        <td style="background-color:rgb(250,246,246);color:black"> 4.69e+19 <strong>(0.025)</strong> </td>
        <td style="background-color:rgb(243,243,250);color:black"> -2.09e+16 <strong>(-0.058)</strong> </td>
        <td style="background-color:rgb(248,248,250);color:black"> -1.08e+16 <strong>(-0.017)</strong> </td>
        <td> 1.75e+33 </td>
        <td style="background-color:rgb(246,246,250);color:black"> -3.65e+14 <strong>(-0.029)</strong> </td>
        <td style="background-color:rgb(250,250,250);color:black"> 2.63e+15 <strong>(0.003)</strong> </td>
    </tr>
    <tr>
        <th> par_7 </th>
        <td style="background-color:rgb(250,200,200);color:black"> 30.6 <strong>(0.333)</strong> </td>
        <td style="background-color:rgb(246,246,250);color:black"> -1.87e+04 <strong>(-0.033)</strong> </td>
        <td style="background-color:rgb(250,247,247);color:black"> 0.00426 <strong>(0.017)</strong> </td>
        <td style="background-color:rgb(250,241,241);color:black"> 797 <strong>(0.059)</strong> </td>
        <td style="background-color:rgb(232,232,250);color:black"> -0.355 <strong>(-0.136)</strong> </td>
        <td style="background-color:rgb(245,245,250);color:black"> -0.184 <strong>(-0.041)</strong> </td>
        <td style="background-color:rgb(246,246,250);color:black"> -3.65e+14 <strong>(-0.029)</strong> </td>
        <td> 0.0905 </td>
        <td style="background-color:rgb(250,249,249);color:black"> 0.0447 <strong>(0.007)</strong> </td>
    </tr>
    <tr>
        <th> par_8 </th>
        <td style="background-color:rgb(246,246,250);color:black"> -220 <strong>(-0.033)</strong> </td>
        <td style="background-color:rgb(250,250,250);color:black"> 1.35e+05 <strong>(0.003)</strong> </td>
        <td style="background-color:rgb(250,250,250);color:black"> -0.0307 <strong>(-0.002)</strong> </td>
        <td style="background-color:rgb(249,249,250);color:black"> -5.75e+03 <strong>(-0.006)</strong> </td>
        <td style="background-color:rgb(250,248,248);color:black"> 2.56 <strong>(0.013)</strong> </td>
        <td style="background-color:rgb(250,249,249);color:black"> 1.32 <strong>(0.004)</strong> </td>
        <td style="background-color:rgb(250,250,250);color:black"> 2.63e+15 <strong>(0.003)</strong> </td>
        <td style="background-color:rgb(250,249,249);color:black"> 0.0447 <strong>(0.007)</strong> </td>
        <td> 481 </td>
    </tr>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">26</span>
<span class="n">chisq</span><span class="o">=</span><span class="mf">31.148172</span><span class="p">,</span> <span class="n">chisq</span><span class="o">/</span><span class="n">red</span><span class="o">=</span><span class="mf">1.198007</span> <span class="n">null</span> <span class="n">hypothesis</span> <span class="n">sig</span><span class="o">=</span><span class="mf">0.222797</span>

<span class="n">best</span> <span class="n">fit</span> <span class="n">pars</span>
</pre></div>
</div>
<i>Table length=11</i>
<table id="table140451207061312-950644" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>4.688283e+02</td><td>4.688283e+02</td><td>2.858882e+02</td><td>--</td><td>4.697542e+02</td><td>1.000000e+01</td><td>1.000000e+03</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>9.028968e+05</td><td>9.028968e+05</td><td>1.970066e+06</td><td>--</td><td>1.373160e+06</td><td>5.000000e+05</td><td>1.000000e+07</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>7.917986e-01</td><td>7.917986e-01</td><td>7.826153e-01</td><td>--</td><td>9.060842e-01</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>3.238465e+04</td><td>3.238465e+04</td><td>3.814239e+04</td><td>--</td><td>3.188500e+04</td><td>1.000000e+03</td><td>1.000000e+05</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>2.090996e+00</td><td>2.090996e+00</td><td>7.583699e+00</td><td>--</td><td>2.181578e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>6.854517e-01</td><td>6.854517e-01</td><td>1.250924e+01</td><td>--</td><td>7.726502e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>3.046194e+16</td><td>3.046194e+16</td><td>3.526875e+16</td><td>--</td><td>3.112712e+16</td><td>5.000000e+15</td><td>1.000000e+17</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>1.000000e+17</td><td>--</td><td>--</td><td>--</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>5.214133e-02</td><td>5.214133e-02</td><td>3.594802e-01</td><td>--</td><td>5.050000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>2.249661e+01</td><td>2.249661e+01</td><td>1.845509e+01</td><td>--</td><td>2.500000e+01</td><td>5.000000e+00</td><td>5.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>3.080000e-02</td><td>--</td><td>--</td><td>--</td><td>3.080000e-02</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table140451207061312-950644').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table140451207061312-950644').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-------------------------------------------------------------------------</span>

<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p2</span><span class="o">=</span><span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-13</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_55_0.png" src="../../../_images/Jet_example_model_fit_55_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_fit_minuit</span><span class="o">.</span><span class="n">save_report</span><span class="p">(</span><span class="s1">&#39;SSC-best-fit-minuit.pkl&#39;</span><span class="p">)</span>
<span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;model_minimizer_minuit.pkl&#39;</span><span class="p">)</span>
<span class="n">fit_model_minuit</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;fit_model_minuit.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can obtain profile and contours, but this is typically time
consuming. In any case, better results can be achieved using the MCMC
approach (discussed in next section) For further information regardin
minuit please refer to <a class="reference external" href="https://iminuit.readthedocs.io">https://iminuit.readthedocs.io</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#migrad profile</span>

<span class="c1">#access the data</span>
<span class="n">profile_migrad</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">mnprofile</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="c1">#make the plot(no need to run the previous command)</span>
<span class="n">profile_plot_migrad</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">draw_mnprofile</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#migrad contour</span>
<span class="c1">#access the data</span>
<span class="n">contour_migrad</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>

<span class="c1">#make the plot(no need to run the previous command)</span>
<span class="n">contour_plot_migrad</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">draw_contour</span><span class="p">(</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>you can use also minos contour and profile, in this case the
computational time is even longer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">profile_migrad</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">mnprofile</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">profile_plot_migrad</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">draw_mnprofile</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="n">contour_migrad</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">mncontour</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">contour_plot_migrad</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">draw_mncontour</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="mcmc-sampling">
<h2>MCMC sampling<a class="headerlink" href="#mcmc-sampling" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.mcmc</span> <span class="kn">import</span> <span class="n">McmcSampler</span>
<span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">ModelMinimizer</span>
</pre></div>
</div>
<p>We used a flat prior centered on the best fit value. Setting
<code class="docutils literal notranslate"><span class="pre">bound=5.0</span></code> and <code class="docutils literal notranslate"><span class="pre">bound_rel=True</span></code> means that:</p>
<ol class="arabic simple">
<li><p>the prior interval will be defined as [best_fit_val - delta_m ,
best_fit_val + delta_p]</p></li>
<li><p>with delta_p=delta_m=best_fit_val*bound</p></li>
</ol>
<p>If we set <code class="docutils literal notranslate"><span class="pre">bound_rel=False</span></code> then delta_p = delta_m =
best_fit_err*bound</p>
<p>It is possible to define asymmetric boundaries e.g. <code class="docutils literal notranslate"><span class="pre">bound=[2.0,5.0]</span></code>
meaning that</p>
<ol class="arabic">
<li><p>for <code class="docutils literal notranslate"><span class="pre">bound_rel=True</span></code></p>
<p>delta_p = best_fit_val*bound[1]</p>
<p>delta_m =b est_fit_val*bound[0]</p>
</li>
<li><p>for <code class="docutils literal notranslate"><span class="pre">bound_rel=False</span></code></p>
<p>delta_p = best_fit_err*bound[1]</p>
<p>delta_m = best_fit_err*bound[0]</p>
</li>
</ol>
<p>In the next release a more flexible prior interface will be added,
including different type of priors</p>
<p>Given the large parameter space, we select a sub sample of parameters
using the <code class="docutils literal notranslate"><span class="pre">use_labels_dict</span></code>. If we do not pass the ‘use_labels_dict’
the full set of free parameters will be used</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm.auto</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">model_minimizer_minuit</span> <span class="o">=</span> <span class="n">ModelMinimizer</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;model_minimizer_minuit.pkl&#39;</span><span class="p">)</span>

<span class="n">mcmc</span><span class="o">=</span><span class="n">McmcSampler</span><span class="p">(</span><span class="n">model_minimizer_minuit</span><span class="p">)</span>

<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;gamma0_log_parab&#39;</span><span class="p">]</span>
<span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;jet_leptonic&#39;</span>
<span class="n">use_labels_dict</span><span class="o">=</span><span class="p">{</span><span class="n">model_name</span><span class="p">:</span><span class="n">labels</span><span class="p">}</span>

<span class="n">mcmc</span><span class="o">.</span><span class="n">run_sampler</span><span class="p">(</span><span class="n">nwalkers</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span><span class="n">burnin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">bound</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">bound_rel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">threads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">walker_start_bound</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span><span class="n">use_labels_dict</span><span class="o">=</span><span class="n">use_labels_dict</span><span class="p">,</span><span class="n">progress</span><span class="o">=</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span> <span class="n">run</span> <span class="n">starting</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0%|          | 0/50 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span> <span class="n">run</span> <span class="n">done</span><span class="p">,</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">threads</span> <span class="n">took</span> <span class="mf">281.79</span> <span class="n">seconds</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mcmc</span><span class="o">.</span><span class="n">acceptance_fraction</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.566875</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E11</span><span class="p">,</span><span class="mf">2E28</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_67_0.png" src="../../../_images/Jet_example_model_fit_67_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_chain</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_68_0.png" src="../../../_images/Jet_example_model_fit_68_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">corner_plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_69_0.png" src="../../../_images/Jet_example_model_fit_69_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">get_par</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mf">0.77375715</span><span class="p">,</span> <span class="mf">0.78568073</span><span class="p">,</span> <span class="mf">0.76712143</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.78488955</span><span class="p">,</span> <span class="mf">0.80836757</span><span class="p">,</span>
        <span class="mf">0.79053866</span><span class="p">]),</span>
 <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_par</span><span class="p">(</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_71_0.png" src="../../../_images/Jet_example_model_fit_71_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_par</span><span class="p">(</span><span class="s1">&#39;gamma0_log_parab&#39;</span><span class="p">,</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_72_0.png" src="../../../_images/Jet_example_model_fit_72_0.png" />
</section>
<section id="save-and-reuse-mcmc">
<h2>Save and reuse MCMC<a class="headerlink" href="#save-and-reuse-mcmc" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;mcmc_sampler.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.mcmc</span> <span class="kn">import</span> <span class="n">McmcSampler</span>
<span class="kn">from</span> <span class="nn">jetset.data_loader</span> <span class="kn">import</span> <span class="n">ObsData</span>
<span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="kn">import</span> <span class="n">PlotSED</span>
<span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="kn">import</span>  <span class="n">test_SEDs</span>

<span class="n">sed_data</span><span class="o">=</span><span class="n">ObsData</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;Mrk_401.pkl&#39;</span><span class="p">)</span>

<span class="n">ms</span><span class="o">=</span><span class="n">McmcSampler</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;mcmc_sampler.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ms</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;SSC-best-fit-minuit&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E11</span><span class="p">,</span> <span class="mf">2E27</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_77_0.png" src="../../../_images/Jet_example_model_fit_77_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_par</span><span class="p">(</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_78_0.png" src="../../../_images/Jet_example_model_fit_78_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_par</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_79_0.png" src="../../../_images/Jet_example_model_fit_79_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_chain</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_80_0.png" src="../../../_images/Jet_example_model_fit_80_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">corner_plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_81_0.png" src="../../../_images/Jet_example_model_fit_81_0.png" />
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, andrea tramacere.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>