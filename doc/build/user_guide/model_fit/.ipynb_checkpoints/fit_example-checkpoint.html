<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Fit User guide &#8212; jetset 1.0.a documentation</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><span><img src="../../../_static/logo_small_transp.png"></span>
          JetSeT</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">JetSeT <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide.html">user guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide.html#content">Content</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Fit User guide</a><ul>
<li><a class="reference internal" href="#data-format">data format</a></li>
<li><a class="reference internal" href="#Loading-SEDs">Loading SEDs</a></li>
<li><a class="reference internal" href="#Plotting-data">Plotting data</a></li>
<li><a class="reference internal" href="#grouping-data">grouping data</a></li>
<li><a class="reference internal" href="#handling-errors-and-systematics">handling errors and systematics</a></li>
<li><a class="reference internal" href="#SEDShape:-Spectral-indices">SEDShape: Spectral indices</a></li>
<li><a class="reference internal" href="#SEDShape:-Log-Log-Polynomila-fit">SEDShape: Log-Log Polynomila fit</a></li>
<li><a class="reference internal" href="#Constraining-SSC/EC-model">Constraining SSC/EC model</a></li>
<li><a class="reference internal" href="#SSC/EC-fitting">SSC/EC fitting</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../../_sources/user_guide/model_fit/.ipynb_checkpoints/fit_example-checkpoint.ipynb.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Fit User guide</a><ul>
<li><a class="reference internal" href="#data-format">data format</a></li>
<li><a class="reference internal" href="#Loading-SEDs">Loading SEDs</a></li>
<li><a class="reference internal" href="#Plotting-data">Plotting data</a></li>
<li><a class="reference internal" href="#grouping-data">grouping data</a></li>
<li><a class="reference internal" href="#handling-errors-and-systematics">handling errors and systematics</a></li>
<li><a class="reference internal" href="#SEDShape:-Spectral-indices">SEDShape: Spectral indices</a></li>
<li><a class="reference internal" href="#SEDShape:-Log-Log-Polynomila-fit">SEDShape: Log-Log Polynomila fit</a></li>
<li><a class="reference internal" href="#Constraining-SSC/EC-model">Constraining SSC/EC model</a></li>
<li><a class="reference internal" href="#SSC/EC-fitting">SSC/EC fitting</a></li>
</ul>
</li>
</ul>

<form action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
.. toctree::<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="section" id="Fit-User-guide">
<h1>Fit User guide<a class="headerlink" href="#Fit-User-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="data-format">
<h2>data format<a class="headerlink" href="#data-format" title="Permalink to this headline">¶</a></h2>
<p>The SED data can be stored in ASCII file in a quite flexible way, but
some requirements are needed:</p>
<ul class="simple">
<li>you must provide at least two columns for frequencies and fluxes</li>
<li>frequencies are in <em>Hz</em></li>
<li>fluxes are in <em>cgs</em>, …..</li>
</ul>
<p>The header of the file can contain some meta-data that are sourced when
the data are loaded. The meta-data available are :</p>
<ul class="simple">
<li>z : redhsift</li>
<li>resframe: restframe of the data <code class="docutils literal"><span class="pre">src</span></code> or <code class="docutils literal"><span class="pre">obs</span></code></li>
<li>data_scale: scale of the data <code class="docutils literal"><span class="pre">lin-lin</span></code> or <code class="docutils literal"><span class="pre">log-log</span></code></li>
<li>dataType: structure of the comumns with the SED data</li>
</ul>
the meaning of these meta-data is explained in detail in :class:`jetset.data_loader.ObsData` class
documentation. The meta-data can be included in the header with  line like:<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># metadata</span>
<span class="c1"># md z  0.0308</span>
<span class="c1"># md restframe  obs</span>
<span class="c1"># md data_scale  lin-lin</span>
<span class="c1"># md col_types x,y,dy,data_set</span>
<span class="c1"># md obj_name     J1104+3812,Mrk421</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
<p>A typical structure of SED data file, including meta-data declaration is
the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># metadata</span>
<span class="c1"># md z  0.0308</span>
<span class="c1"># md restframe  obs</span>
<span class="c1"># md data_scale  lin-lin</span>
<span class="c1"># md col_types x,y,dy,data_set</span>
<span class="c1"># md obj_name     J1104+3812,Mrk421</span>
<span class="c1">#</span>
<span class="c1"># Frequency [Hz]  EnergyFlux [erg/cm2/s]</span>
<span class="c1">#  Xval           Yval       YvalError    data_set-flag</span>
<span class="mf">2.299540e+09</span> <span class="mf">1.340900e-14</span> <span class="mf">3.910000e-16</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">2.639697e+09</span> <span class="mf">1.793088e-14</span> <span class="mf">3.231099e-26</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">4.799040e+09</span> <span class="mf">2.313600e-14</span> <span class="mf">2.400000e-16</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">4.805039e+09</span> <span class="mf">1.773414e-14</span> <span class="mf">1.773414e-15</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">4.843552e+09</span> <span class="mf">2.776140e-14</span> <span class="mf">2.615339e-26</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">7.698460e+09</span> <span class="mf">3.696000e-14</span> <span class="mf">4.620000e-16</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">8.267346e+09</span> <span class="mf">2.836267e-14</span> <span class="mf">2.836267e-15</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">8.331867e+09</span> <span class="mf">3.989630e-14</span> <span class="mf">3.627671e-26</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">8.388659e+09</span> <span class="mf">3.163450e-14</span> <span class="mf">1.931495e-15</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">8.399994e+09</span> <span class="mf">4.000500e-14</span> <span class="mf">5.041094e-15</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">1.044892e+10</span> <span class="mf">4.626737e-14</span> <span class="mf">3.297726e-26</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">1.109778e+10</span> <span class="mf">4.617600e-14</span> <span class="mf">6.660000e-16</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
<span class="mf">1.456571e+10</span> <span class="mf">5.628417e-14</span> <span class="mf">4.453463e-26</span>    <span class="n">campaing</span><span class="o">-</span><span class="mi">2009</span>
</pre></div>
</div>
</div>
<div class="section" id="Loading-SEDs">
<h2>Loading SEDs<a class="headerlink" href="#Loading-SEDs" title="Permalink to this headline">¶</a></h2>
The most effective way to import the SED data is to create an object
instance of :class:`jetset.data_loader.ObsData` class
(see the documentation for the :doc:`data_loader <../../modules_doc/data_loader>` module)
The package provides some test SEDs, accessible as follows:<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="k">import</span>  <span class="n">test_SEDs</span>
<span class="n">test_SEDs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>[&#39;/Users/orion/anaconda2/envs/py36/lib/python3.6/site-packages/jetset-1.2.0-py3.6-macosx-10.7-x86_64.egg/jetset/test_data/SEDs_data/SED_3C345.dat&#39;,
 &#39;/Users/orion/anaconda2/envs/py36/lib/python3.6/site-packages/jetset-1.2.0-py3.6-macosx-10.7-x86_64.egg/jetset/test_data/SEDs_data/SED_MW_Mrk421.dat&#39;,
 &#39;/Users/orion/anaconda2/envs/py36/lib/python3.6/site-packages/jetset-1.2.0-py3.6-macosx-10.7-x86_64.egg/jetset/test_data/SEDs_data/SED_MW_Mrk501.dat&#39;]
</pre></div>
</div>
</div>
<p>to load the SED of Mrk 421, the first one in the list:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">mySED</span><span class="o">=</span><span class="n">test_SEDs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">jetset.data_loader</span> <span class="k">import</span> <span class="n">ObsData</span>
<span class="n">sed_data</span><span class="o">=</span><span class="n">ObsData</span><span class="p">(</span><span class="n">data_file</span><span class="o">=</span><span class="n">mySED</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=============================================================================================

*** getting meta-data from file header
col_types None
set md z  to 0.0308
set md restframe  to obs
set md data_scale  to lin-lin
set md col_types  to x,y,dy,data_set
set md obj_name  to J1104+3812,Mrk421
ciccio x,y,dy,data_set
col_types x,y,dy,data_set
=============================================================================================

col_types a x,y,dy,data_set
col_types c x,y,dy,data_set
col_types b [&#39;x&#39;, &#39;y&#39;, &#39;dy&#39;, &#39;data_set&#39;]
ciccio [(&#39;nu_data&#39;, &#39;f8&#39;), (&#39;dnu_data&#39;, &#39;f8&#39;), (&#39;nuFnu_data&#39;, &#39;f8&#39;), (&#39;dnuFnu_data&#39;, &#39;f8&#39;), (&#39;nu_data_log&#39;, &#39;f8&#39;), (&#39;dnu_data_log&#39;, &#39;f8&#39;), (&#39;nuFnu_data_log&#39;, &#39;f8&#39;), (&#39;dnuFnu_data_log&#39;, &#39;f8&#39;), (&#39;dnuFnu_facke&#39;, &#39;f8&#39;), (&#39;dnuFnu_facke_log&#39;, &#39;f8&#39;), (&#39;UL&#39;, &#39;bool&#39;), (&#39;zero_error&#39;, &#39;bool&#39;), (&#39;T_start&#39;, &#39;f8&#39;), (&#39;T_stop&#39;, &#39;f8&#39;), (&#39;data_set&#39;, &#39;S16&#39;)]
=============================================================================================

*** loading data ***
---&gt; loading data for file=/Users/orion/anaconda2/envs/py36/lib/python3.6/site-packages/jetset-1.2.0-py3.6-macosx-10.7-x86_64.egg/jetset/test_data/SEDs_data/SED_MW_Mrk421.dat
---&gt; found these col ID=range(0, 4) and names=[&#39;x&#39;, &#39;y&#39;, &#39;dy&#39;, &#39;data_set&#39;]:
---&gt; z=3.080000e-02
---&gt; restframe=obs
---&gt; obj_name=J1104+3812,Mrk421
---&gt; data_scale=lin-lin
col_types [&#39;x&#39;, &#39;y&#39;, &#39;dy&#39;, &#39;data_set&#39;]
[&#39;x&#39;, &#39;y&#39;, &#39;dy&#39;, &#39;data_set&#39;] range(0, 4)
nu_data x
nuFnu_data y
dnuFnu_data dy
data_set data_set
---&gt; data len=112
---&gt; Settin  UL for val 0
---&gt; Settin  UL for val 0.2
=============================================================================================

</pre></div></div>
</div>
<p>As you can see the all the meta-data have been properly sourced from the
SED file header. You also get information on the lenght of the data,
before and after elimination of duplicated entries, and upper limits
These meta-data are parameters needed by the</p>
:class:`jetset.data_loader.ObsData` constructor.</div>
<div class="section" id="Plotting-data">
<h2>Plotting data<a class="headerlink" href="#Plotting-data" title="Permalink to this headline">¶</a></h2>
We can now plot our SED using the :class:`BlazarSEDFit.plot_sedfit.Plot` class
(see the documentation for the :doc:`plot_sedfit <../../modules_doc/plot_sedfit>` module)<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="k">import</span> <span class="n">Plot</span>
<span class="n">myPlot</span><span class="o">=</span><span class="n">Plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">myPlot</span><span class="o">.</span><span class="n">add_data_plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
running PyLab in interactive mode
directory ./ already existing
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_17_1.png" src="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_17_1.png" />
</div>
</div>
</div>
<div class="section" id="grouping-data">
<h2>grouping data<a class="headerlink" href="#grouping-data" title="Permalink to this headline">¶</a></h2>
<p>As you can see, due to the overlapping of different instruments and to
different time snapshots, some points have multiple values. Although
this is not a problem for the fit process, you might want to rebin your
data. This can be obtained with the following command:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sed_data</span><span class="o">.</span><span class="n">group_data</span><span class="p">(</span><span class="n">bin_width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=============================================================================================

***  binning data  ***
---&gt; N bins= 89
---&gt; bin_widht= 0.2
=============================================================================================

</pre></div></div>
</div>
</div>
<div class="section" id="handling-errors-and-systematics">
<h2>handling errors and systematics<a class="headerlink" href="#handling-errors-and-systematics" title="Permalink to this headline">¶</a></h2>
<p>Another important issues when dealing with fitting of data, is the
proper handling of errors. Typically one might need to add systematics
for different reasons:</p>
<ul class="simple">
<li>data are not really simultaneous, and you want to add systematics to
take this into account</li>
<li>data (typically IR up to UV), might have very small errors compared
to those at higher energies. This might bias the minimizer to
accomodate the parameters in order to fit ‘better’ the low
frequencies branch.</li>
</ul>
<p>For these reasons the package offer the possibility to add systematics</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sed_data</span><span class="o">.</span><span class="n">add_systematics</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,[</span><span class="mf">10.</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mf">10.</span><span class="o">**</span><span class="mi">29</span><span class="p">])</span>
<span class="n">myPlot</span><span class="o">=</span><span class="n">Plot</span><span class="p">(</span><span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">add_data_plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;grouped+syst&#39;</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
running PyLab in interactive mode
directory ./ already existing
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_21_1.png" src="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_21_1.png" />
</div>
</div>
with this command we add 20% systematics for data between :math:`10^{6}<\nu<10^{29}` Hz</div>
<div class="section" id="SEDShape:-Spectral-indices">
<h2>SEDShape: Spectral indices<a class="headerlink" href="#SEDShape:-Spectral-indices" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">jetset.sed_shaper</span> <span class="k">import</span>  <span class="n">SEDShape</span>
<span class="n">my_shape</span><span class="o">=</span><span class="n">SEDShape</span><span class="p">(</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">my_shape</span><span class="o">.</span><span class="n">eval_indices</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=============================================================================================

*** evaluating spectral indices for data ***
---&gt; range for indexradio updated to [6.000000,10.000000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=80, res=0.040981, chisq=0.36841**********************************************************************
---------------------------------------------------------------------------------------
fval = 0.36841838886162864 | total call = 87 | ncalls = 87
edm = 1.8023341884611675e-07 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 =  0.5973  |  0.2061  |          |          | -10      |  10      |          |
|    1 | par_1 = -19.36   |  1.992   |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (0.5973317132652589, -19.35835367872672)
res check 0.0380162913807775 0.3684200285851512
---&gt; 1000000.0 10000000000.0 100
---&gt; name = radio            range=[6.000 ,10.000] log(Hz)  photon.val=-1.402671e+00, err=2.061105e-01

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | +5.973286e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -1.935838e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=88
mesg=
dof=1
chisq=0.368420, chisq/red=0.368420 null hypothesis sig=0.543867

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | +5.973286e-01 | +2.061105e-01 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -1.935838e+01 | +1.991979e+00 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



---&gt; range for indexradio_mm updated to [10.000000,11.000000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=120, res=-0.000271, chisq=0.01395**********************************************************************
---------------------------------------------------------------------------------------
fval = 0.013955396221108125 | total call = 124 | ncalls = 124
edm = 9.167821380589557e-06 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 =  0.7106  |  0.3008  |          |          | -10      |  10      |          |
|    1 | par_1 = -20.49   |  3.102   |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (0.710563240761811, -20.48609688874422)
res check -0.0018041570213917016 0.013956525602712383
---&gt; 10000000000.0 100000000000.0 100
---&gt; name = radio_mm         range=[10.000,11.000] log(Hz)  photon.val=-1.289439e+00, err=3.008381e-01

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | +7.105609e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -2.048612e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=125
mesg=
dof=1
chisq=0.013957, chisq/red=0.013957 null hypothesis sig=0.905959

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | +7.105609e-01 | +3.008381e-01 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -2.048612e+01 | +3.101753e+00 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



---&gt; range for indexmm_IR updated to [10.300000,13.700000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=100, res=0.002166, chisq=0.16989**********************************************************************
---------------------------------------------------------------------------------------
fval = 0.1698919441697112 | total call = 108 | ncalls = 108
edm = 2.4889897383547027e-06 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 =  0.8903  |  0.1269  |          |          | -10      |  10      |          |
|    1 | par_1 = -22.37   |  1.363   |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (0.8902738412904547, -22.367394988333345)
res check 0.0012528014355625283 0.16989620992207333
---&gt; 19952623149.68891 50118723362726.945 100
---&gt; name = mm_IR            range=[10.300,13.700] log(Hz)  photon.val=-1.109729e+00, err=1.268819e-01

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | +8.902713e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -2.236742e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=109
mesg=
dof=1
chisq=0.169896, chisq/red=0.169896 null hypothesis sig=0.680204

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | +8.902713e-01 | +1.268819e-01 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -2.236742e+01 | +1.363095e+00 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



---&gt; range for indexIR_Opt updated to [12.500000,14.500000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=150, res=-0.063099, chisq=0.03255**********************************************************************
---------------------------------------------------------------------------------------
fval = 0.03255413239842313 | total call = 155 | ncalls = 155
edm = 5.5388584543726864e-05 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 =  0.2179  |  0.4602  |          |          | -10      |  10      |          |
|    1 | par_1 = -13.33   |  6.362   |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (0.21786160571751623, -13.328291691141612)
res check -0.0656184764763343 0.032552626185190045
---&gt; 3162277660168.392 316227766016836.6 100
---&gt; name = IR_Opt           range=[12.500,14.500] log(Hz)  photon.val=-1.782141e+00, err=4.602299e-01

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | +2.178594e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -1.332832e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=156
mesg=
dof=1
chisq=0.032553, chisq/red=0.032553 null hypothesis sig=0.856820

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | +2.178594e-01 | +4.602299e-01 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -1.332832e+01 | +6.361702e+00 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



---&gt; range for indexOpt_UV updated to [14.000000,16.000000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=110, res=-0.044237, chisq=1.17052**********************************************************************
---------------------------------------------------------------------------------------
fval = 1.1705275574077267 | total call = 119 | ncalls = 119
edm = 7.233067985143407e-09 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 =  0.3788  |  0.09841 |          |          | -10      |  10      |          |
|    1 | par_1 = -15.64   |  1.449   |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (0.37882181023299566, -15.636958496747097)
minim function calls=120, res=-0.047985, chisq=1.17052res check -0.047984938876328154 1.170529382549224
---&gt; 100000000000000.0 1e+16 100
---&gt; name = Opt_UV           range=[14.000,16.000] log(Hz)  photon.val=-1.621180e+00, err=9.841047e-02

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | +3.788199e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -1.563699e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=120
mesg=
dof=5
chisq=1.170529, chisq/red=0.234106 null hypothesis sig=0.947673

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | +3.788199e-01 | +9.841047e-02 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -1.563699e+01 | +1.449001e+00 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



---&gt; range for indexBBB updated to [14.800000,16.200000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=200, res=0.023204, chisq=0.16084**********************************************************************
---------------------------------------------------------------------------------------
fval = 0.16083664912879314 | total call = 200 | ncalls = 200
edm = 1.3739884290102432e-05 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 =  0.7254  |  0.3847  |          |          | -10      |  10      |          |
|    1 | par_1 = -20.86   |  5.63    |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (0.7253961177267225, -20.86309161951963)
res check 0.023203710060429455 0.16084095856515768
---&gt; 630957344480194.2 1.5848931924611238e+16 100
---&gt; name = BBB              range=[14.800,16.200] log(Hz)  photon.val=-1.274606e+00, err=3.846946e-01

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | +7.253943e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -2.086312e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=201
mesg=
dof=1
chisq=0.160841, chisq/red=0.160841 null hypothesis sig=0.688383

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | +7.253943e-01 | +3.846946e-01 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -2.086312e+01 | +5.629936e+00 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



---&gt; range for indexUV_X updated to [15.000000,17.500000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=90, res=-0.013896, chisq=1.13058**********************************************************************
---------------------------------------------------------------------------------------
fval = 1.1305823072504297 | total call = 91 | ncalls = 91
edm = 7.65798990257511e-06 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 =  0.1541  |  0.03713 |          |          | -10      |  10      |          |
|    1 | par_1 = -12.19   |  0.6164  |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (0.15408070210057012, -12.187409638022114)
res check -0.017728961580666613 1.1305788936641659
---&gt; 1000000000000000.0 3.1622776601683795e+17 100
---&gt; name = UV_X             range=[15.000,17.500] log(Hz)  photon.val=-1.845921e+00, err=3.712945e-02

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | +1.540792e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -1.218744e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=92
mesg=
dof=4
chisq=1.130579, chisq/red=0.282645 null hypothesis sig=0.889391

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | +1.540792e-01 | +3.712945e-02 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -1.218744e+01 | +6.163737e-01 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



---&gt; range for indexX updated to [16.000000,19.000000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=110, res=-1.103361, chisq=21.93071**********************************************************************
---------------------------------------------------------------------------------------
fval = 21.93070382034992 | total call = 117 | ncalls = 117
edm = 6.068854602007761e-05 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 = -0.4578  |  0.04767 |          |          | -10      |  10      |          |
|    1 | par_1 = -1.606   |  0.8467  |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (-0.45779697386609364, -1.606322923127852)
res check -1.126465635005074 21.930709522488655
---&gt; 1e+16 1e+19 100
---&gt; name = X                range=[16.000,19.000] log(Hz)  photon.val=-2.457801e+00, err=4.767152e-02

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | -4.578008e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -1.606391e+00 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=118
mesg=
dof=9
chisq=21.930710, chisq/red=2.436746 null hypothesis sig=0.009101

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | -4.578008e-01 | +4.767152e-02 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -1.606391e+00 | +8.467033e-01 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



---&gt; range for indexFermi updated to [22.380000,25.380000]
directory ./ already existing
directory .//spectral-indices-best-fit/ already existing
removing existing dir
the directory .//spectral-indices-best-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10.0, 10.0), &#39;par_1&#39;: -10.0, &#39;limit_par_1&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=110, res=-0.149538, chisq=1.21422**********************************************************************
---------------------------------------------------------------------------------------
fval = 1.2142224037471625 | total call = 115 | ncalls = 115
edm = 2.013143960876923e-06 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 =  0.2044  |  0.04438 |          |          | -10      |  10      |          |
|    1 | par_1 = -15.27   |  1.056   |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (0.20438294397813905, -15.272890189690562)
res check -0.1556421183794186 1.214224314105566
---&gt; 2.3988329190194848e+22 2.398832919019485e+25 100
---&gt; name = Fermi            range=[22.380,25.380] log(Hz)  photon.val=-1.795618e+00, err=4.437842e-02

**************************************************************************************************
Fit report

Model: spectral-indices-best-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 alpha            | spectral-slope           |                  | +2.043818e-01 | [-1.000000e+01,+1.000000e+01]
 K                | flux-const               | erg cm^-2 s^-1   | -1.527292e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=116
mesg=
dof=6
chisq=1.214224, chisq/red=0.202371 null hypothesis sig=0.976176

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 alpha            | +2.043818e-01 | +4.437842e-02 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 K                | -1.527292e+01 | +1.055578e+00 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************



=============================================================================================

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">myPlot</span><span class="o">=</span><span class="n">Plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">my_shape</span><span class="o">.</span><span class="n">index_models</span><span class="p">:</span>
    <span class="n">myPlot</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">line_style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">myPlot</span><span class="o">.</span><span class="n">add_data_plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mi">14</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mi">8</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
running PyLab in interactive mode
directory ./ already existing
label radio
label radio_mm
label mm_IR
label IR_Opt
label Opt_UV
label BBB
label UV_X
label X
label Fermi
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_25_1.png" src="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_25_1.png" />
</div>
</div>
</div>
<div class="section" id="SEDShape:-Log-Log-Polynomila-fit">
<h2>SEDShape: Log-Log Polynomila fit<a class="headerlink" href="#SEDShape:-Log-Log-Polynomila-fit" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">myPlot</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;SED_indices_rebinned.png&#39;</span><span class="p">)</span>


<span class="n">my_shape</span><span class="o">.</span><span class="n">sync_fit</span><span class="p">(</span><span class="n">check_host_gal_template</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=============================================================================================

*** Log-Polynomial fitting of the synchrotron component ***
---&gt; first blind fit run, log-cubic fit range: [9, 19]
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 b                | curvature                |                  | -1.000000e+00 | [-1.000000e+01,+0.000000e+00]
 c                | third-degree             |                  | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 Ep               | peak freq                | Hz               | +1.400000e+01 | [+0.000000e+00,+3.000000e+01]
 Sp               | peak flux                | erg cm^-2 s^-1   | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------
directory ./ already existing
directory .//sync-shape-fit/ already existing
removing existing dir
the directory .//sync-shape-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10, 0), &#39;par_1&#39;: -1.0, &#39;limit_par_1&#39;: (-10.0, 10.0), &#39;par_2&#39;: 14.0, &#39;limit_par_2&#39;: (0.0, 30.0), &#39;par_3&#39;: -10.0, &#39;limit_par_3&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=10, res=5010.813021, chisq=8183474.32449

minim function calls=20, res=5244.173411, chisq=9883150.69264

minim function calls=30, res=-1609.755520, chisq=118649.62981

minim function calls=40, res=-1600.440229, chisq=113704.64758

minim function calls=50, res=-664.147530, chisq=51931.20082

minim function calls=60, res=28.033818, chisq=26521.27856

minim function calls=70, res=28.425580, chisq=26522.60738

minim function calls=80, res=-149.836125, chisq=20176.34736

minim function calls=90, res=205.141760, chisq=10370.53132

minim function calls=100, res=16.260219, chisq=2105.58819

minim function calls=110, res=13.789485, chisq=924.81443

minim function calls=120, res=4.875500, chisq=668.60623

minim function calls=130, res=-10.050120, chisq=657.76860

minim function calls=140, res=-6.826159, chisq=654.96236

minim function calls=150, res=-7.264082, chisq=654.89219

minim function calls=160, res=-7.349855, chisq=654.75902

minim function calls=170, res=-9.572991, chisq=653.73461

minim function calls=180, res=-18.408543, chisq=501.48035

minim function calls=190, res=-39.189655, chisq=309.05768

minim function calls=200, res=-25.704903, chisq=291.82392

minim function calls=210, res=-1.210604, chisq=251.70436

minim function calls=220, res=-21.535538, chisq=252.17612

minim function calls=230, res=-10.101371, chisq=232.39618

minim function calls=240, res=-18.492666, chisq=198.13939

minim function calls=250, res=-8.130621, chisq=185.82174

minim function calls=260, res=0.100692, chisq=179.36791

minim function calls=270, res=0.133183, chisq=179.38129

minim function calls=280, res=-2.940722, chisq=176.57872

minim function calls=290, res=-4.421275, chisq=176.05977

minim function calls=300, res=-4.727919, chisq=176.04940

minim function calls=310, res=-4.769615, chisq=176.04959

minim function calls=320, res=-4.742332, chisq=176.04944

minim function calls=330, res=3.522155, chisq=182.82060

minim function calls=340, res=-4.636395, chisq=176.04834

minim function calls=350, res=-4.637926, chisq=176.04640

minim function calls=360, res=-4.576686, chisq=176.04525

minim function calls=370, res=-4.576724, chisq=176.04274

minim function calls=380, res=-4.511596, chisq=176.04252

minim function calls=390, res=-4.570794, chisq=176.03145

minim function calls=400, res=-4.502130, chisq=176.02961

minim function calls=410, res=-4.635000, chisq=176.02091

minim function calls=420, res=-4.840587, chisq=176.01124

minim function calls=430, res=-4.142350, chisq=175.98280

minim function calls=440, res=-3.869542, chisq=175.94832

minim function calls=450, res=-3.479245, chisq=175.91442

minim function calls=460, res=-3.206320, chisq=175.89035

minim function calls=470, res=-3.715625, chisq=175.79043

minim function calls=480, res=-3.795185, chisq=175.77680

minim function calls=490, res=-4.491089, chisq=175.73167

minim function calls=500, res=-3.666832, chisq=175.31701

minim function calls=510, res=-3.328245, chisq=175.28530

minim function calls=520, res=-2.906181, chisq=175.02571

minim function calls=530, res=-6.469050, chisq=173.58824

minim function calls=540, res=-6.748316, chisq=172.94353

minim function calls=550, res=-6.895485, chisq=172.85673

minim function calls=560, res=-9.543914, chisq=172.54360

minim function calls=570, res=-10.113677, chisq=170.58836

minim function calls=580, res=-4.174017, chisq=166.92855

minim function calls=590, res=-6.446171, chisq=164.79666

minim function calls=600, res=-6.771065, chisq=164.01960

minim function calls=610, res=-7.628457, chisq=163.11069

minim function calls=620, res=-4.572613, chisq=157.58913

minim function calls=630, res=-1.764592, chisq=156.13885

minim function calls=640, res=9.612307, chisq=145.07103

minim function calls=650, res=1.720724, chisq=135.38609

minim function calls=660, res=6.036586, chisq=100.18485

minim function calls=670, res=25.069924, chisq=142.47398

minim function calls=680, res=4.825190, chisq=87.50992

minim function calls=690, res=-4.626058, chisq=78.33299

minim function calls=700, res=0.539099, chisq=63.14330

minim function calls=710, res=6.631330, chisq=53.06551

minim function calls=720, res=1.403024, chisq=30.16972

minim function calls=730, res=4.739431, chisq=21.39531

minim function calls=740, res=5.152020, chisq=17.33603

minim function calls=750, res=-1.624592, chisq=14.13243

minim function calls=760, res=-0.485511, chisq=13.76771

minim function calls=770, res=-0.620754, chisq=13.73570

minim function calls=780, res=-0.651890, chisq=13.73314

minim function calls=790, res=-0.661557, chisq=13.73315

minim function calls=800, res=-0.657228, chisq=13.73314

**********************************************************************
---------------------------------------------------------------------------------------
fval = 13.73314818997152 | total call = 808 | ncalls = 808
edm = 5.038846082587436e-05 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 = -0.1595  |  0.009421 |          |          | -10      |  0       |          |
|    1 | par_1 = -0.0109  |  0.001313 |          |          | -10      |  10      |          |
|    2 | par_2 =  16.7    |  0.04841 |          |          |  0       |  30      |          |
|    3 | par_3 = -9.485   |  0.03388 |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (-0.15952729965761314, -0.010904800855310981, 16.695980883689245, -9.48449545453073)
res check -0.6634820658680649 13.733155030005754
---&gt; 1000000000.0 1e+19 100
directory ./ already existing
directory .//sync-shape-fit/ already existing
removing existing dir
the directory .//sync-shape-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10, 0), &#39;par_1&#39;: -1.0, &#39;limit_par_1&#39;: (-10.0, 10.0), &#39;par_2&#39;: 14.0, &#39;limit_par_2&#39;: (0.0, 30.0), &#39;par_3&#39;: -10.0, &#39;limit_par_3&#39;: (-30.0, 0.0), &#39;par_4&#39;: -9.484531267217534, &#39;limit_par_4&#39;: (-11.484531267217534, -7.484531267217534), &#39;par_5&#39;: 0, &#39;limit_par_5&#39;: (-0.5, 0.5)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=10, res=-2064.683241, chisq=1964186.73113

minim function calls=20, res=-2408.098578, chisq=2366935.17808

minim function calls=30, res=-2399.950492, chisq=2360940.75616

minim function calls=40, res=1866.171618, chisq=184418.84923

minim function calls=50, res=1866.357918, chisq=184454.87916

minim function calls=60, res=1866.411325, chisq=184448.13256

minim function calls=70, res=1865.559584, chisq=184302.10315

minim function calls=80, res=1608.223778, chisq=171485.21059

minim function calls=90, res=1611.487506, chisq=171462.94614

minim function calls=100, res=1612.093201, chisq=171500.13917

minim function calls=110, res=1611.716062, chisq=171502.30386

minim function calls=120, res=1238.473248, chisq=161083.69069

minim function calls=130, res=1238.088295, chisq=161066.28555

minim function calls=140, res=1239.080305, chisq=161076.97400

minim function calls=150, res=1189.923053, chisq=156633.69003

minim function calls=160, res=993.434276, chisq=154168.16274

minim function calls=170, res=994.013013, chisq=154161.80358

minim function calls=180, res=1081.449642, chisq=144707.05860

minim function calls=190, res=1081.166784, chisq=144711.55887

minim function calls=200, res=1150.892091, chisq=142003.32987

minim function calls=210, res=1150.430080, chisq=141996.75192

minim function calls=220, res=1119.392548, chisq=133270.16750

minim function calls=230, res=1119.019002, chisq=133259.03367

minim function calls=240, res=1121.542084, chisq=130164.65390

minim function calls=250, res=1121.710323, chisq=130166.55852

minim function calls=260, res=1235.220367, chisq=129169.90922

minim function calls=270, res=1209.212792, chisq=129137.38685

minim function calls=280, res=1203.910926, chisq=128291.04527

minim function calls=290, res=1202.558275, chisq=128215.87535

minim function calls=300, res=1102.337433, chisq=127293.82984

minim function calls=310, res=1102.366612, chisq=127293.62124

minim function calls=320, res=-599.108233, chisq=89446.26537

minim function calls=330, res=150.723437, chisq=7641.23653

minim function calls=340, res=150.704824, chisq=7640.84067

minim function calls=350, res=223.437943, chisq=7040.71881

minim function calls=360, res=223.257003, chisq=7038.18158

minim function calls=370, res=-0.286197, chisq=3551.15297

minim function calls=380, res=5.655293, chisq=2365.85335

minim function calls=390, res=5.773967, chisq=2366.03409

minim function calls=400, res=-7.276134, chisq=2310.36869

minim function calls=410, res=-7.297771, chisq=2310.38262

minim function calls=420, res=-47.319600, chisq=2173.80638

minim function calls=430, res=-47.125567, chisq=2174.15167

minim function calls=440, res=-12.340194, chisq=2071.33571

minim function calls=450, res=-12.309436, chisq=2071.16684

minim function calls=460, res=-11.362934, chisq=1921.54566

minim function calls=470, res=-11.401888, chisq=1921.35068

minim function calls=480, res=-20.121113, chisq=1774.65038

minim function calls=490, res=-20.178410, chisq=1775.00013

minim function calls=500, res=-65.666667, chisq=1461.50689

minim function calls=510, res=-65.724074, chisq=1461.99382

minim function calls=520, res=15.203522, chisq=933.32256

minim function calls=530, res=-18.795079, chisq=954.29338

minim function calls=540, res=0.601462, chisq=762.61370

minim function calls=550, res=-37.084092, chisq=636.07150

minim function calls=560, res=-37.113701, chisq=636.18773

minim function calls=570, res=-45.681654, chisq=564.17482

minim function calls=580, res=-6.110447, chisq=406.56669

minim function calls=590, res=-1.611384, chisq=403.05650

minim function calls=600, res=2.703462, chisq=322.65217

minim function calls=610, res=2.701023, chisq=322.66441

minim function calls=620, res=-21.627566, chisq=265.41323

minim function calls=630, res=-21.604153, chisq=265.37576

minim function calls=640, res=-28.100183, chisq=248.00345

minim function calls=650, res=-28.078371, chisq=247.93471

minim function calls=660, res=-2.833435, chisq=205.84084

minim function calls=670, res=-2.812904, chisq=205.84484

minim function calls=680, res=-8.606028, chisq=183.78086

minim function calls=690, res=-8.588471, chisq=183.75145

minim function calls=700, res=-14.723934, chisq=172.85358

minim function calls=710, res=-14.755222, chisq=172.87948

minim function calls=720, res=-9.594249, chisq=167.27795

minim function calls=730, res=-6.183526, chisq=163.36603

minim function calls=740, res=-6.201884, chisq=163.39073

minim function calls=750, res=-6.404002, chisq=162.93055

minim function calls=760, res=-6.421150, chisq=162.92988

minim function calls=770, res=-8.904462, chisq=162.03336

minim function calls=780, res=-8.886212, chisq=162.02775

minim function calls=790, res=-1.920382, chisq=151.95040

minim function calls=800, res=-1.903775, chisq=151.96459

minim function calls=810, res=-5.757794, chisq=148.35861

minim function calls=820, res=-5.781603, chisq=148.36510

minim function calls=830, res=-6.235965, chisq=116.97529

minim function calls=840, res=-6.210074, chisq=116.97151

minim function calls=850, res=-6.235163, chisq=116.97350

minim function calls=860, res=-6.543152, chisq=116.21584

minim function calls=870, res=-6.519981, chisq=116.21837

minim function calls=880, res=-5.021791, chisq=115.74088

minim function calls=890, res=-2.252952, chisq=114.57027

minim function calls=900, res=-2.244731, chisq=114.55442

minim function calls=910, res=-2.487195, chisq=107.73252

minim function calls=920, res=-2.836558, chisq=107.64823

minim function calls=930, res=-3.625808, chisq=106.89068

minim function calls=940, res=-3.482748, chisq=106.83507

minim function calls=950, res=-6.412697, chisq=106.05417

minim function calls=960, res=-6.425945, chisq=106.05033

minim function calls=970, res=-5.145524, chisq=105.61311

minim function calls=980, res=-5.130927, chisq=105.62395

minim function calls=990, res=-2.892119, chisq=105.18124

minim function calls=1000, res=-2.876961, chisq=105.19134

minim function calls=1010, res=-1.063898, chisq=101.19626

minim function calls=1020, res=-1.049551, chisq=101.19832

minim function calls=1030, res=-1.396678, chisq=100.74747

minim function calls=1040, res=-1.383153, chisq=100.74736

minim function calls=1050, res=-4.207697, chisq=95.39974

minim function calls=1060, res=-4.220578, chisq=95.39344

minim function calls=1070, res=7.867066, chisq=65.46878

minim function calls=1080, res=7.856118, chisq=65.43592

minim function calls=1090, res=4.609639, chisq=52.96289

minim function calls=1100, res=6.705583, chisq=38.16018

minim function calls=1110, res=7.158520, chisq=38.08150

minim function calls=1120, res=3.526514, chisq=31.15925

minim function calls=1130, res=-1.130849, chisq=27.79429

minim function calls=1140, res=0.985981, chisq=17.78182

minim function calls=1150, res=0.986142, chisq=17.78174

minim function calls=1160, res=-0.363525, chisq=14.33338

minim function calls=1170, res=-0.362201, chisq=14.33380

minim function calls=1180, res=0.367051, chisq=13.55693

minim function calls=1190, res=0.361189, chisq=13.55573

minim function calls=1200, res=-0.633269, chisq=13.45816

minim function calls=1210, res=-0.628620, chisq=13.45819

minim function calls=1220, res=-0.666568, chisq=13.44992

minim function calls=1230, res=-0.664242, chisq=13.44993

minim function calls=1240, res=-0.630766, chisq=13.44932

minim function calls=1250, res=-0.644713, chisq=13.44536

minim function calls=1260, res=-1.492407, chisq=13.34711

minim function calls=1270, res=-1.491517, chisq=13.34786

minim function calls=1280, res=-1.148480, chisq=13.32343

minim function calls=1290, res=-0.849667, chisq=13.29610

minim function calls=1300, res=-0.686979, chisq=13.29127

minim function calls=1310, res=-0.760521, chisq=13.29082

minim function calls=1320, res=-0.767513, chisq=13.29184

minim function calls=1330, res=-0.769481, chisq=13.29082

minim function calls=1340, res=-0.767778, chisq=13.29082

minim function calls=1350, res=-0.769830, chisq=13.28981

minim function calls=1360, res=-0.767922, chisq=13.28981

minim function calls=1370, res=-0.783675, chisq=13.28611

minim function calls=1380, res=-0.767153, chisq=13.28540

minim function calls=1390, res=-0.763881, chisq=13.28540

minim function calls=1400, res=-0.766411, chisq=13.28537

minim function calls=1410, res=-0.761958, chisq=13.28537

minim function calls=1420, res=-0.766750, chisq=13.28538

minim function calls=1430, res=-0.755313, chisq=13.28539

minim function calls=1440, res=-0.757477, chisq=13.28537

minim function calls=1450, res=-0.761730, chisq=13.28537

minim function calls=1460, res=-0.767652, chisq=13.28537

minim function calls=1470, res=-0.757795, chisq=13.28537

minim function calls=1480, res=-0.763216, chisq=13.28537

**********************************************************************
---------------------------------------------------------------------------------------
fval = 13.285367168384496 | total call = 1488 | ncalls = 1480
edm = 0.009548166333585998 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|          False |           True |          False |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |           True |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 = -0.1604  |  2.1     |          |          | -10      |  0       |          |
|    1 | par_1 = -0.01109 |  0.1674  |          |          | -10      |  10      |          |
|    2 | par_2 =  16.71   |  9.703   |          |          |  0       |  30      |          |
|    3 | par_3 = -9.491   |  9.277   |          |          | -30      |  0       |          |
|    4 | par_4 = -11.07   |  2.097   |          |          | -11.48   | -7.485   |          |
|    5 | par_5 = -0.01811 |  0.08444 |          |          | -0.5     |  0.5     |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (-0.16036897465601996, -0.0110925794540222, 16.714910037550833, -9.490914998591467, -11.065221264625162, -0.018113910210059703)
res check -0.7632471345640286 13.285367169522232
---&gt; 1000000000.0 1e+19 100

**************************************************************************************************
Fit report

Model: sync-shape-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 b                | curvature                |                  | -1.603690e-01 | [-1.000000e+01,+0.000000e+00]
 c                | third-degree             |                  | -1.109258e-02 | [-1.000000e+01,+1.000000e+01]
 Ep               | peak freq                | Hz               | +1.671491e+01 | [+0.000000e+00,+3.000000e+01]
 Sp               | peak flux                | erg cm^-2 s^-1   | -9.490915e+00 | [-3.000000e+01,+0.000000e+00]
 nuFnu_p_host     | nuFnu-scale              | erg cm^-2 s^-1   | -1.106522e+01 | [-2.000000e+01,+2.000000e+01]
 nu_scale         | nu-scale                 | Hz               | -1.811391e-02 | [-2.000000e+00,+2.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=1489
mesg=
dof=19
chisq=13.285367, chisq/red=0.699230 null hypothesis sig=0.823647

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 b                | -1.603690e-01 | +2.100083e+00 | -1.000000e+00 | [-1.000000e+01,+0.000000e+00]
 c                | -1.109258e-02 | +1.674351e-01 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 Ep               | +1.671491e+01 | +9.702709e+00 | +1.400000e+01 | [+0.000000e+00,+3.000000e+01]
 Sp               | -9.490915e+00 | +9.277498e+00 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
 nuFnu_p_host     | -1.106522e+01 | +2.097009e+00 | -9.484531e+00 | [-1.148453e+01,-7.484531e+00]
 nu_scale         | -1.811391e-02 | +8.443645e-02 | +0.000000e+00 | [-5.000000e-01,+5.000000e-01]
---------------------------------------------------------------------------------------------------
**************************************************************************************************

---&gt; class:  HSP
---&gt; sync       nu_p=+1.671491e+01 (err=+9.702709e+00)  nuFnu_p=-9.490915e+00 (err=+9.277498e+00) curv.=-1.603690e-01 (err=+2.100083e+00)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">my_shape</span><span class="o">.</span><span class="n">IC_fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=============================================================================================

*** Log-Polynomial fitting of the IC component ***
---&gt; log-cubic fit range: [22, 28]
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 b                | curvature                |                  | -1.000000e+00 | [-1.000000e+01,+0.000000e+00]
 c                | third-degree             |                  | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 Ep               | peak freq                | Hz               | +2.525747e+01 | [+0.000000e+00,+3.000000e+01]
 Sp               | peak flux                | erg cm^-2 s^-1   | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------
directory ./ already existing
directory .//IC-shape-fit/ already existing
removing existing dir
the directory .//IC-shape-fit/ has been created
dict {&#39;par_0&#39;: -1.0, &#39;limit_par_0&#39;: (-10, 0), &#39;par_1&#39;: -1.0, &#39;limit_par_1&#39;: (-10.0, 10.0), &#39;par_2&#39;: 25.25746738962698, &#39;limit_par_2&#39;: (0.0, 30.0), &#39;par_3&#39;: -10.0, &#39;limit_par_3&#39;: (-30.0, 0.0)}
**************************************************
*                     MIGRAD                     *
**************************************************

minim function calls=10, res=-171.078454, chisq=30467.47515

minim function calls=20, res=205.495663, chisq=10226.15854

minim function calls=30, res=205.752099, chisq=10223.31302

minim function calls=40, res=66.268460, chisq=2409.38419

minim function calls=50, res=-27.079943, chisq=1421.68823

minim function calls=60, res=-6.791395, chisq=493.16130

minim function calls=70, res=21.367248, chisq=145.92520

minim function calls=80, res=-0.190596, chisq=25.73338

minim function calls=90, res=-1.578189, chisq=23.81413

minim function calls=100, res=-4.227807, chisq=15.53831

minim function calls=110, res=2.511932, chisq=10.53080

minim function calls=120, res=-0.521074, chisq=8.20879

minim function calls=130, res=-1.319385, chisq=8.00834

minim function calls=140, res=-0.954874, chisq=7.97424

minim function calls=150, res=-1.797892, chisq=7.91633

minim function calls=160, res=-0.772849, chisq=3.99965

minim function calls=170, res=-1.221251, chisq=3.49378

minim function calls=180, res=-0.851013, chisq=3.44289

minim function calls=190, res=-0.727091, chisq=3.43994

minim function calls=200, res=-0.729921, chisq=3.43995

minim function calls=210, res=-0.728174, chisq=3.43994

**********************************************************************
---------------------------------------------------------------------------------------
fval = 3.4399459548662534 | total call = 218 | ncalls = 218
edm = 3.283406576818471e-05 (Goal: 1e-05) | up = 1.0
---------------------------------------------------------------------------------------
|          Valid |    Valid Param | Accurate Covar |         Posdef |    Made Posdef |
---------------------------------------------------------------------------------------
|           True |           True |           True |           True |          False |
---------------------------------------------------------------------------------------
|     Hesse Fail |        Has Cov |      Above EDM |                |  Reach calllim |
---------------------------------------------------------------------------------------
|          False |           True |          False |             &#39;&#39; |          False |
---------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
|      | Name  |  Value   | Para Err |   Err-   |   Err+   |  Limit-  |  Limit+  |          |
----------------------------------------------------------------------------------------------
|    0 | par_0 = -0.2056  |  0.04002 |          |          | -10      |  0       |          |
|    1 | par_1 = -0.04991 |  0.01563 |          |          | -10      |  10      |          |
|    2 | par_2 =  25.26   |  0.1075  |          |          |  0       |  30      |          |
|    3 | par_3 = -10.12   |  0.04768 |          |          | -30      |  0       |          |
----------------------------------------------------------------------------------------------

**********************************************************************
p (-0.205604968378843, -0.04990591734117622, 25.25922273964055, -10.122349495222544)
res check -0.7341759774539718 3.439939831614986
---&gt; 1e+22 1e+28 100

**************************************************************************************************
Fit report

Model: IC-shape-fit
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 b                | curvature                |                  | -2.056050e-01 | [-1.000000e+01,+0.000000e+00]
 c                | third-degree             |                  | -4.990592e-02 | [-1.000000e+01,+1.000000e+01]
 Ep               | peak freq                | Hz               | +2.525916e+01 | [+0.000000e+00,+3.000000e+01]
 Sp               | peak flux                | erg cm^-2 s^-1   | -1.012238e+01 | [-3.000000e+01,+0.000000e+00]
--------------------------------------------------------------------------------------------------------------

converged=True
calls=219
mesg=
dof=12
chisq=3.439940, chisq/red=0.286662 null hypothesis sig=0.991560

best fit pars
---------------------------------------------------------------------------------------------------
best-fit parameters:
  Name            | best-fit value| best-fit err  | start value   | fit boundaries
---------------------------------------------------------------------------------------------------
 b                | -2.056050e-01 | +4.001839e-02 | -1.000000e+00 | [-1.000000e+01,+0.000000e+00]
 c                | -4.990592e-02 | +1.563202e-02 | -1.000000e+00 | [-1.000000e+01,+1.000000e+01]
 Ep               | +2.525916e+01 | +1.075364e-01 | +2.525747e+01 | [+0.000000e+00,+3.000000e+01]
 Sp               | -1.012238e+01 | +4.767663e-02 | -1.000000e+01 | [-3.000000e+01,+0.000000e+00]
---------------------------------------------------------------------------------------------------
**************************************************************************************************

---&gt; IC         nu_p=+2.525916e+01 (err=+1.075364e-01)  nuFnu_p=-1.012238e+01 (err=+4.767663e-02) curv.=-2.056050e-01 (err=+4.001839e-02)
=============================================================================================

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">myPlot</span><span class="o">=</span><span class="n">Plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">myPlot</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">my_shape</span><span class="o">.</span><span class="n">sync_fit</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sync, poly-fit&#39;</span><span class="p">)</span>

<span class="n">myPlot</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">my_shape</span><span class="o">.</span><span class="n">host_gal</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;host-gal&#39;</span><span class="p">)</span>

<span class="n">myPlot</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">my_shape</span><span class="o">.</span><span class="n">sync_fit_model</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sync+host, poly-fit&#39;</span><span class="p">)</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">my_shape</span><span class="o">.</span><span class="n">IC_fit_model</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;IC, poly-fit&#39;</span><span class="p">)</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">add_data_plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">myPlot</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mi">14</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mi">8</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
running PyLab in interactive mode
directory ./ already existing
&lt;bound method SEDShape.sync_fit of &lt;jetset.sed_shaper.SEDShape object at 0x1512f63b70&gt;&gt; !!! Error has no SED instance or something wrong in get_model_points()
label host-gal
label sync+host, poly-fit
label IC, poly-fit
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_29_1.png" src="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_29_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">my_shape</span><span class="o">.</span><span class="n">show_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=============================================================================================

*** SEDShape values ***
---&gt; spectral inidces values
---&gt; name = radio            range=[6.000 ,10.000] log(Hz)  photon.val=-1.402671e+00, err=2.061105e-01
---&gt; name = radio_mm         range=[10.000,11.000] log(Hz)  photon.val=-1.289439e+00, err=3.008381e-01
---&gt; name = mm_IR            range=[10.300,13.700] log(Hz)  photon.val=-1.109729e+00, err=1.268819e-01
---&gt; name = IR_Opt           range=[12.500,14.500] log(Hz)  photon.val=-1.782141e+00, err=4.602299e-01
---&gt; name = Opt_UV           range=[14.000,16.000] log(Hz)  photon.val=-1.621180e+00, err=9.841047e-02
---&gt; name = BBB              range=[14.800,16.200] log(Hz)  photon.val=-1.274606e+00, err=3.846946e-01
---&gt; name = UV_X             range=[15.000,17.500] log(Hz)  photon.val=-1.845921e+00, err=3.712945e-02
---&gt; name = X                range=[16.000,19.000] log(Hz)  photon.val=-2.457801e+00, err=4.767152e-02
---&gt; name = Fermi            range=[22.380,25.380] log(Hz)  photon.val=-1.795618e+00, err=4.437842e-02
---&gt; S/IC peak values
---&gt; sync       nu_p=+1.671491e+01 (err=+9.702709e+00)  nuFnu_p=-9.490915e+00 (err=+9.277498e+00) curv.=-1.603690e-01 (err=+2.100083e+00)

---&gt; IC         nu_p=+2.525916e+01 (err=+1.075364e-01)  nuFnu_p=-1.012238e+01 (err=+4.767663e-02) curv.=-2.056050e-01 (err=+4.001839e-02)


=============================================================================================

</pre></div></div>
</div>
</div>
<div class="section" id="Constraining-SSC/EC-model">
<h2>Constraining SSC/EC model<a class="headerlink" href="#Constraining-SSC/EC-model" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">jetset.obs_constrain</span> <span class="k">import</span> <span class="n">ObsConstrain</span>

<span class="n">sed_obspar</span><span class="o">=</span><span class="n">ObsConstrain</span><span class="p">(</span><span class="n">beaming</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">B_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span><span class="n">distr_e</span><span class="o">=</span><span class="s1">&#39;lppl&#39;</span><span class="p">,</span><span class="n">t_var_sec</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mi">86400</span><span class="p">,</span><span class="n">nu_cut_IR</span><span class="o">=</span><span class="mf">9.0E12</span><span class="p">,</span><span class="n">SEDShape</span><span class="o">=</span><span class="n">my_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
directory ./ already existing
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">jet_model</span><span class="o">=</span><span class="n">sed_obspar</span><span class="o">.</span><span class="n">constrain_SSC_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=============================================================================================

***  constrains parameters from observable ***
directory .//obs_constrain_lppl/ already existing
removing existing dir
the directory .//obs_constrain_lppl/ has been created
directory ./ already existing
directory .//lppl_jet_prod/ already existing
removing existing dir
the directory .//lppl_jet_prod/ has been created
directory .//obs_constrain_lppl/ already existing
removing existing dir
the directory .//obs_constrain_lppl/ has been created
-----------------------------------------------------------------------------------------
model parameters for jet model:
electron distribution type = lppl
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 N                | electron_density         | cm^-3            | +1.000000e+02 | [+0.000000e+00,No           ]
 gmin             | low-energy-cut-off       | Lorentz-factor   | +2.000000e+00 | [+1.000000e+00,No           ]
 gmax             | high-energy-cut-off      | Lorentz-factor   | +1.000000e+08 | [+1.000000e+00,No           ]
 s                | LE_spectral_slope        |                  | +2.000000e+00 | [-1.000000e+01,+1.000000e+01]
 r                | spectral_curvature       |                  | +4.000000e-01 | [-1.000000e+01,+1.000000e+01]
 gamma0_log_parab | turn-over-energy         | Lorentz-factor   | +1.000000e+04 | [+1.000000e+00,No           ]
 R                | region_size              | cm               | +3.000000e+15 | [+0.000000e+00,No           ]
 B                | magnetic_field           | G                | +1.000000e-01 | [+0.000000e+00,No           ]
 beam_obj         | beaming                  |                  | +1.000000e+01 | [+1.000000e+00,No           ]
 z_cosm           | redshift                 |                  | +1.000000e-01 | [+0.000000e+00,No           ]
--------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
---&gt; ***  emitting region parameters  ***
---&gt; name = beam_obj          type = beaming                   units =                   val = +2.500000e+01  phys-bounds = [+1.000000e+00,No           ]
---&gt; setting par type redshift, corresponding to par z_cosm
---&gt;  name = z_cosm            type = redshift                  units =                   val = +3.080000e-02  phys-bounds = [+0.000000e+00,No           ]
---&gt; setting par type magnetic_field, corresponding to par B
---&gt;  name = B                 type = magnetic_field            units = G                 val = +5.500000e-02  phys-bounds = [+0.000000e+00,No           ]
---&gt; setting par type region_size, corresponding to par R
---&gt;  name = R                 type = region_size               units = cm                val = +1.884609e+17  phys-bounds = [+0.000000e+00,No           ]
---&gt; *** electron distribution parameters ***
---&gt; distribution type:  lppl
---&gt; r elec. spec. curvature =8.018449e-01
---&gt; setting par type curvature, corresponding to par r
---&gt;  name = r                 type = spectral_curvature        units =                   val = +8.018449e-01  phys-bounds = [-1.000000e+01,+1.000000e+01]
---&gt; s_radio_mm -0.28943913107755925 1.5788782621551185
---&gt; s_X 3.9156016040466177
---&gt; s_Fermi 1.6729891337010345
---&gt; s_UV_X 2.691841699164094
---&gt; s_Opt_UV -0.6211800564392291 2.2423601128784583
---&gt; s from synch log-log fit -1.0
---&gt; s from (s_Fermi + s_UV)/2
---&gt; power-law index s, class obj=HSP s chosen is 2.182415
---&gt; setting par type LE_spectral_slope, corresponding to par s
---&gt;  name = s                 type = LE_spectral_slope         units =                   val = +2.182415e+00  phys-bounds = [-1.000000e+01,+1.000000e+01]
---&gt; gamma_3p_Sync= 1.025156e+05, assuming B=5.500000e-02
---&gt; gamma_max=1.315786e+06 from nu_max_Sync= 8.544779e+18, using B=5.500000e-02
---&gt; setting par type high-energy-cut-off, corresponding to par gmax
---&gt;  name = gmax              type = high-energy-cut-off       units = Lorentz-factor    val = +1.315786e+06  phys-bounds = [+1.000000e+00,No           ]

---&gt; setting par type low-energy-cut-off, corresponding to par gmin
---&gt;  name = gmin              type = low-energy-cut-off        units = Lorentz-factor    val = +1.350381e+03  phys-bounds = [+1.000000e+00,No           ]

---&gt; setting par type turn-over energy, corresponding to par gamma0_log_parab
---&gt; using gamma_3p_Sync= 102515.59879590549
---&gt;  name = gamma0_log_parab  type = turn-over-energy          units = Lorentz-factor    val = +3.169387e+04  phys-bounds = [+1.000000e+00,No           ]

nu_p_seed_blob 2138672667284302.8
COMP FACTOR 1.7744345131491372 24949.53232710054
---&gt; gamma_3p_SSCc= %e 161476.52800396679
---&gt; setting par type turn-over energy, corresponding to par gamma0_log_parab
---&gt; using gamma_3p_SSC= 161476.52800396679
---&gt;  name = gamma0_log_parab  type = turn-over-energy          units = Lorentz-factor    val = +4.992232e+04  phys-bounds = [+1.000000e+00,No           ]


---&gt; setting par type electron_density, corresponding to par N
---&gt; B from nu_p_S=2.216786e-02
---&gt; get B from best matching of nu_p_IC
---&gt; B=4.012546e-01, out of boundaries 1.000000e-02 1.000000e-01, rejected
     Best B not found, (temporary set to 1.000000e-01)
---&gt; setting par type magnetic_field, corresponding to par B
---&gt;  name = B                 type = magnetic_field            units = G                 val = +1.000000e-01  phys-bounds = [+0.000000e+00,No           ]

---&gt; constrain failed, B set to:  name = B                 type = magnetic_field            units = G                 val = +1.000000e-01  phys-bounds = [+0.000000e+00,No           ]


---&gt; update pars for new B
---&gt; setting par type low-energy-cut-off, corresponding to par gmin
---&gt;  name = gmin              type = low-energy-cut-off        units = Lorentz-factor    val = +1.001469e+03  phys-bounds = [+1.000000e+00,No           ]

---&gt; setting par type low-energy-cut-off, corresponding to par gamma0_log_parab
---&gt; using gamma_3p_Sync= 76027.60286939003
---&gt;  name = gamma0_log_parab  type = turn-over-energy          units = Lorentz-factor    val = +2.350480e+04  phys-bounds = [+1.000000e+00,No           ]
---&gt; gamma_max=9.758134e+05 from nu_max_Sync= 8.544779e+18, using B=1.000000e-01
---&gt; setting par type high-energy-cut-off, corresponding to par gmax
---&gt;  name = gmax              type = high-energy-cut-off       units = Lorentz-factor    val = +9.758134e+05  phys-bounds = [+1.000000e+00,No           ]

---&gt; setting par type electron_density, corresponding to par N
---&gt; get R from Compoton Dominance (CD)
     Best R=1.592619e+16
---&gt; setting par type region_size, corresponding to par R
---&gt;  name = R                 type = region_size               units = cm                val = +1.592619e+16  phys-bounds = [+0.000000e+00,No           ]

---&gt; setting par type electron_density, corresponding to par N
---&gt; t_var (days) 0.253519856130165

show pars
-----------------------------------------------------------------------------------------
model parameters for jet model:
electron distribution type = lppl
--------------------------------------------------------------------------------------------------------------
model parameters:
 Name             | Type                     | Units            | value         | phys. boundaries
--------------------------------------------------------------------------------------------------------------
 N                | electron_density         | cm^-3            | +8.480725e-01 | [+0.000000e+00,No           ]
 gmin             | low-energy-cut-off       | Lorentz-factor   | +1.001469e+03 | [+1.000000e+00,No           ]
 gmax             | high-energy-cut-off      | Lorentz-factor   | +9.758134e+05 | [+1.000000e+00,No           ]
 s                | LE_spectral_slope        |                  | +2.182415e+00 | [-1.000000e+01,+1.000000e+01]
 r                | spectral_curvature       |                  | +8.018449e-01 | [-1.000000e+01,+1.000000e+01]
 gamma0_log_parab | turn-over-energy         | Lorentz-factor   | +2.350480e+04 | [+1.000000e+00,No           ]
 R                | region_size              | cm               | +1.592619e+16 | [+0.000000e+00,No           ]
 B                | magnetic_field           | G                | +1.000000e-01 | [+0.000000e+00,No           ]
 beam_obj         | beaming                  |                  | +2.500000e+01 | [+1.000000e+00,No           ]
 z_cosm           | redshift                 |                  | +3.080000e-02 | [+0.000000e+00,No           ]
--------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
eval_model
directory .//lppl_jet_prod/ already existing
removing existing dir
the directory .//lppl_jet_prod/ has been created
=============================================================================================

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">constr_Plot</span><span class="o">=</span><span class="n">Plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">jet_model</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">plot_obj</span><span class="o">=</span><span class="n">constr_Plot</span><span class="p">)</span>

<span class="n">constr_Plot</span><span class="o">.</span><span class="n">add_data_plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">constr_Plot</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mi">14</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mi">8</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">constr_Plot</span><span class="o">.</span><span class="n">add_residual_plot</span><span class="p">(</span><span class="n">jet_model</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
directory ./ already existing
label Sum
label Sync
label SSC
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-16-83e00b4e009a&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> constr_Plot<span class="ansi-blue-fg">.</span>add_data_plot<span class="ansi-blue-fg">(</span>sed_data<span class="ansi-blue-fg">,</span>autoscale<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> constr_Plot<span class="ansi-blue-fg">.</span>rescale<span class="ansi-blue-fg">(</span>y_min<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">14</span><span class="ansi-blue-fg">,</span>y_max<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">8</span><span class="ansi-blue-fg">,</span>x_min<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">8</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 6</span><span class="ansi-red-fg"> </span>constr_Plot<span class="ansi-blue-fg">.</span>add_residual_plot<span class="ansi-blue-fg">(</span>jet_model<span class="ansi-blue-fg">,</span>autoscale<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: add_residual_plot() missing 1 required positional argument: &#39;data&#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_34_2.png" src="../../../_images/user_guide_model_fit_.ipynb_checkpoints_fit_example-checkpoint_34_2.png" />
</div>
</div>
</div>
<div class="section" id="SSC/EC-fitting">
<h2>SSC/EC fitting<a class="headerlink" href="#SSC/EC-fitting" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">jetset.model_manager</span> <span class="k">import</span> <span class="n">FitModel</span>
<span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="k">import</span>  <span class="n">fit_SED</span>

<span class="n">fit_model</span><span class="o">=</span><span class="n">FitModel</span><span class="p">(</span> <span class="n">jet</span><span class="o">=</span><span class="n">jet_model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit&#39;</span><span class="p">,</span>  <span class="n">template</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">host_gal</span><span class="p">)</span>

<span class="n">fit_model</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">,</span><span class="s1">&#39;frozen&#39;</span><span class="p">)</span>

<span class="n">fit_model</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span><span class="s1">&#39;frozen&#39;</span><span class="p">)</span>

<span class="n">fit_model</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;nuFnu_p_host&#39;</span><span class="p">,</span><span class="s1">&#39;frozen&#39;</span><span class="p">)</span>

<span class="c1">#SEDModel.set(&#39;L_host&#39;,fit_range=[-10.5,-9.5])</span>

<span class="n">fit_model</span><span class="o">.</span><span class="n">show_pars</span><span class="p">()</span>

<span class="n">best_fit</span><span class="o">=</span><span class="n">fit_SED</span><span class="p">(</span><span class="n">fit_model</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="mf">10.0</span><span class="o">**</span><span class="mi">11</span> <span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mf">28.0</span><span class="p">,</span><span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-lppl&#39;</span><span class="p">,</span><span class="n">minimizer</span><span class="o">=</span><span class="s1">&#39;leastsqbound&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">fit_Plot</span><span class="o">=</span><span class="n">Plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit_Plot</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">fit_model</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit&#39;</span><span class="p">)</span>
<span class="n">fit_Plot</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
<span class="n">fit_Plot</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">y_min</span><span class="o">=-</span><span class="mi">14</span><span class="p">,</span><span class="n">y_max</span><span class="o">=-</span><span class="mi">8</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">9.0</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">fit_Plot</span><span class="o">.</span><span class="n">x_min_res</span><span class="o">=</span><span class="mf">5.5</span>
<span class="n">fit_Plot</span><span class="o">.</span><span class="n">x_max_res</span><span class="o">=</span><span class="mi">30</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">fit_model</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spectral_components</span><span class="p">:</span>
    <span class="n">fit_Plot</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">SED</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">line_style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">fit_model</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
    <span class="n">fit_Plot</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">SED</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">line_style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">fit_Plot</span><span class="o">.</span><span class="n">add_data_plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">autoscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>


<span class="n">fit_Plot</span><span class="o">.</span><span class="n">add_residual_plot</span><span class="p">(</span><span class="n">jet_model</span><span class="p">,</span><span class="n">sed_data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, andrea tramacere.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>